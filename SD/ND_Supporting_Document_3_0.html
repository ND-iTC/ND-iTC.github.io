<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Evaluation Activities for Network Device cPP</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="book">
<div id="header">
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="data:image/png;base64,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" alt="image" width="688" height="212"></span></p>
</div>
</div>
</div>
<h1 id="_evaluation_activities_for_network_device_cpp" class="sect0">Evaluation Activities for Network Device cPP</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Version: 3.0</p>
</div>
<div class="paragraph">
<p>Date: 06-04-2023</p>
</div>
<div class="paragraph">
<p><strong>Foreword</strong></p>
</div>
<div class="paragraph">
<p>This is a Supporting Document (SD), intended to complement the Common Criteria version 3 and the associated Common Evaluation Methodology for Information Technology Security Evaluation.</p>
</div>
<div class="paragraph">
<p>Supporting documents may be “Guidance Documents”, that highlight specific approaches and application of the standard to areas where no mutual recognition of its application is required, and as such, are not of normative nature, or “Mandatory Technical Documents”, whose application is mandatory for evaluations whose scope is covered by that of the supporting document. The usage of the latter class is not only mandatory, but certificates issued as a result of their application are recognized under the CCRA. This SD shall be considered a Mandatory Technical Document.</p>
</div>
<div class="paragraph">
<p>This SD has been developed by the Network Device International Technical Community (ND iTC) and is designed to be used to support the evaluations of products against the cPPs identified in section 1.1.</p>
</div>
<div class="paragraph">
<p><strong>Technical Editor:</strong> Network Device International Technical Community (ND iTC)</p>
</div>
<div class="paragraph">
<p><strong>Document history:</strong></p>
</div>
<div class="paragraph">
<p>V3.0, 06 April 2023 (published version)</p>
</div>
<div class="paragraph">
<p>V2.2, 20 December 2019 (published version)</p>
</div>
<div class="paragraph">
<p>V2.1, 17 August 2018 (published version)</p>
</div>
<div class="paragraph">
<p>V2.0, 5 May 2017 (published version)</p>
</div>
<div class="paragraph">
<p>V1.1, 21 July 2016 (Updated draft published for public review)</p>
</div>
<div class="paragraph">
<p>V1.0, 27 February 2015 (published version)</p>
</div>
<div class="paragraph">
<p>V0.4, 26 January 2015 (incorporates changes due to comments received from CCDB review)</p>
</div>
<div class="paragraph">
<p>V0.3, 17 October 2014 (released version following public review, submitted for CCDB review)</p>
</div>
<div class="paragraph">
<p>V0.2, 13 October 2014 (internal draft in response to public review comments, for iTC review)</p>
</div>
<div class="paragraph">
<p>V0.1, 5 September 2014 (Initial release for public review)</p>
</div>
<div class="paragraph">
<p><strong>General Purpose:</strong> See section 1.1.</p>
</div>
<div class="paragraph">
<p><strong>Field of special use:</strong> This Supporting Document applies to the evaluation of TOEs claiming conformance with the collaborative Protection Profile for Network Devices [NDcPP].</p>
</div>
<div class="paragraph">
<p><strong>Acknowledgements:</strong></p>
</div>
<div class="paragraph">
<p>This Supporting Document was developed by the ND iTC with representatives from industry, Government agencies, Common Criteria Test Laboratories, and members of academia.</p>
</div>
<div class="paragraph">
<p><strong>Table of Contents</strong></p>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel0">
<li><a href="#_evaluation_activities_for_network_device_cpp">Evaluation Activities for Network Device cPP</a>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_technology_area_and_scope_of_supporting_document">1.1. Technology Area and Scope of Supporting Document</a></li>
<li><a href="#_structure_of_the_document">1.2. Structure of the Document</a></li>
<li><a href="#_application_of_this_supporting_document">1.3. Application of this Supporting Document</a></li>
<li><a href="#_terminology">1.4. Terminology</a>
<ul class="sectlevel3">
<li><a href="#_glossary">1.4.1. Glossary</a></li>
<li><a href="#_acronyms">1.4.2. Acronyms</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_evaluation_activities_for_sfrs">2. Evaluation Activities for SFRs</a>
<ul class="sectlevel2">
<li><a href="#_security_audit_fau">2.1. Security Audit (FAU)</a>
<ul class="sectlevel3">
<li><a href="#_fau_gen_1_audit_data_generation">2.1.1. FAU_GEN.1 Audit data generation</a></li>
<li><a href="#_fau_gen_2_user_identity_association">2.1.2. FAU_GEN.2 User identity association</a></li>
<li><a href="#_fau_stg_ext_1_protected_audit_event_storage">2.1.3. FAU_STG_EXT.1 Protected Audit Event Storage</a></li>
</ul>
</li>
<li><a href="#_cryptographic_support_fcs">2.2. Cryptographic Support (FCS)</a>
<ul class="sectlevel3">
<li><a href="#_fcs_ckm_1_cryptographic_key_generation">2.2.1. FCS_CKM.1 Cryptographic Key Generation</a></li>
<li><a href="#_fcs_ckm_2_cryptographic_key_establishment">2.2.2. FCS_CKM.2 Cryptographic Key Establishment</a></li>
<li><a href="#_fcs_ckm_4_cryptographic_key_destruction">2.2.3. FCS_CKM.4 Cryptographic Key Destruction</a></li>
<li><a href="#_fcs_cop_1dataencryption_cryptographic_operation_aes_data_encryptiondecryption">2.2.4. FCS_COP.1/DataEncryption Cryptographic Operation (AES Data Encryption/Decryption)</a></li>
<li><a href="#_fcs_cop_1siggen_cryptographic_operation_signature_generation_and_verification">2.2.5. FCS_COP.1/SigGen Cryptographic Operation (Signature Generation and Verification</a></li>
<li><a href="#_fcs_cop_1hash_cryptographic_operation_hash_algorithm">2.2.6. FCS_COP.1/Hash Cryptographic Operation (Hash Algorithm)</a></li>
<li><a href="#_fcs_cop_1keyedhash_cryptographic_operation_keyed_hash_algorithm">2.2.7. FCS_COP.1/KeyedHash Cryptographic Operation (Keyed Hash Algorithm)</a></li>
<li><a href="#_fcs_rbg_ext_1_extended_cryptographic_operation_random_bit_generation">2.2.8. FCS_RBG_EXT.1 Extended: Cryptographic Operation (Random Bit Generation)</a></li>
</ul>
</li>
<li><a href="#_identification_and_authentication_fia">2.3. Identification and Authentication (FIA)</a>
<ul class="sectlevel3">
<li><a href="#_fia_uia_ext_1_user_identification_and_authentication">2.3.1. FIA_UIA_EXT.1 User Identification and Authentication</a></li>
</ul>
</li>
<li><a href="#_security_management_fmt">2.4. Security management (FMT)</a>
<ul class="sectlevel3">
<li><a href="#_general_requirements_for_distributed_toes">2.4.1. General requirements for distributed TOEs</a></li>
<li><a href="#_fmt_mof_1manualupdate">2.4.2. FMT_MOF.1/ManualUpdate</a></li>
<li><a href="#_fmt_mtd_1coredata_management_of_tsf_data">2.4.3. FMT_MTD.1/CoreData Management of TSF Data</a></li>
<li><a href="#_fmt_smf_1_specification_of_management_functions">2.4.4. FMT_SMF.1 Specification of Management Functions</a></li>
<li><a href="#_fmt_smr_2_restrictions_on_security_roles">2.4.5. FMT_SMR.2 Restrictions on security roles</a></li>
</ul>
</li>
<li><a href="#_protection_of_the_tsf_fpt">2.5. Protection of the TSF (FPT)</a>
<ul class="sectlevel3">
<li><a href="#_fpt_skp_ext_1_protection_of_tsf_data_for_reading_of_all_pre_shared_symmetric_and_private_keys">2.5.1. FPT_SKP_EXT.1 Protection of TSF Data (for reading of all pre-shared, symmetric and private keys)</a></li>
<li><a href="#_fpt_tst_ext_1_tsf_testing">2.5.2. FPT_TST_EXT.1 TSF testing</a></li>
<li><a href="#_fpt_tud_ext_1_trusted_update">2.5.3. FPT_TUD_EXT.1 Trusted Update</a></li>
<li><a href="#_fpt_stm_ext_1_reliable_time_stamps">2.5.4. FPT_STM_EXT.1 Reliable Time Stamps</a></li>
</ul>
</li>
<li><a href="#_toe_access_fta">2.6. TOE Access (FTA)</a>
<ul class="sectlevel3">
<li><a href="#_fta_ssl_3_tsf_initiated_termination">2.6.1. FTA_SSL.3 TSF-initiated Termination</a></li>
<li><a href="#_fta_ssl_4_user_initiated_termination">2.6.2. FTA_SSL.4 User-initiated Termination</a></li>
<li><a href="#_fta_tab_1_default_toe_access_banners">2.6.3. FTA_TAB.1 Default TOE Access Banners</a></li>
</ul>
</li>
<li><a href="#_trusted_pathchannels_ftp">2.7. Trusted path/channels (FTP)</a>
<ul class="sectlevel3">
<li><a href="#_ftp_itc_1_inter_tsf_trusted_channel">2.7.1. FTP_ITC.1 Inter-TSF trusted channel</a></li>
<li><a href="#_ftp_trp_1admin_trusted_path">2.7.2. FTP_TRP.1/Admin Trusted Path</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_evaluation_activities_for_optional_requirements">3. Evaluation Activities for Optional Requirements</a>
<ul class="sectlevel2">
<li><a href="#_security_audit_fau_2">3.1. Security Audit (FAU)</a>
<ul class="sectlevel3">
<li><a href="#_fau_stg_1_protected_audit_trail_storage">3.1.1. FAU_STG.1 Protected audit trail storage</a></li>
<li><a href="#_fau_stg_ext_2_counting_lost_audit_data">3.1.2. FAU_STG_EXT.2 Counting lost audit data</a></li>
<li><a href="#_fau_stg_ext_3_action_in_case_of_possible_audit_data_loss">3.1.3. FAU_STG_EXT.3 Action in case of possible audit data loss</a></li>
</ul>
</li>
<li><a href="#_identification_and_authentication_fia_2">3.2. Identification and Authentication (FIA)</a>
<ul class="sectlevel3">
<li><a href="#_fia_x509_ext_1itt_x_509_certificate_validation">3.2.1. FIA_X509_EXT.1/ITT X.509 Certificate Validation</a></li>
</ul>
</li>
<li><a href="#_protection_of_the_tsf_fpt_2">3.3. Protection of the TSF (FPT)</a>
<ul class="sectlevel3">
<li><a href="#_fpt_itt_1_basic_internal_tsf_data_transfer_protection">3.3.1. FPT_ITT.1 Basic internal TSF data transfer protection</a></li>
</ul>
</li>
<li><a href="#_trusted_pathchannels_ftp_2">3.4. Trusted path/channels (FTP)</a>
<ul class="sectlevel3">
<li><a href="#_ftp_trp_1join_trusted_path">3.4.1. FTP_TRP.1/Join Trusted Path</a></li>
</ul>
</li>
<li><a href="#_communication_fco">3.5. Communication (FCO)</a>
<ul class="sectlevel3">
<li><a href="#_fco_cpc_ext_1_component_registration_channel_definition">3.5.1. FCO_CPC_EXT.1 Component Registration Channel Definition</a></li>
</ul>
</li>
<li><a href="#_cryptographic_support_fcs_2">3.6. Cryptographic Support (FCS)</a>
<ul class="sectlevel3">
<li><a href="#_fcs_dtlsc_ext_2_extended_dtls_client_support_for_mutual_authentication">3.6.1. FCS_DTLSC_EXT.2 Extended: DTLS Client support for mutual authentication</a></li>
<li><a href="#_fcs_dtlsc_ext_3_extended_dtls_client_support_for_secure_renegotiation_dtlsv1_2_only">3.6.2. FCS_DTLSC_EXT.3 Extended: DTLS Client support for secure renegotiation (DTLSv1.2 only)</a></li>
<li><a href="#_fcs_dtlss_ext_2_extended_dtls_server_support_for_mutual_authentication">3.6.3. FCS_DTLSS_EXT.2 Extended: DTLS Server support for mutual authentication</a></li>
<li><a href="#_fcs_dtlss_ext_3_extended_dtls_server_support_for_secure_renegotiation_dtlsv1_2_only">3.6.4. FCS_DTLSS_EXT.3 Extended: DTLS Server support for secure renegotiation (DTLSv1.2 only)</a></li>
<li><a href="#_fcs_tlsc_ext_2_extended_tls_client_support_for_mutual_authentication">3.6.5. FCS_TLSC_EXT.2 Extended: TLS Client support for mutual authentication</a></li>
<li><a href="#_fcs_tlsc_ext_3_extended_tls_client_support_for_secure_renegotiation_tlsv1_2_only">3.6.6. FCS_TLSC_EXT.3 Extended: TLS Client support for secure renegotiation (TLSv1.2 only)</a></li>
<li><a href="#_fcs_tlss_ext_2_extended_tls_server_support_for_mutual_authentication">3.6.7. FCS_TLSS_EXT.2 Extended: TLS Server support for mutual authentication</a></li>
<li><a href="#_fcs_tlss_ext_3_extended_tls_server_support_for_secure_renegotiation_tlsv1_2_only">3.6.8. FCS_TLSS_EXT.3 Extended: TLS Server support for secure renegotiation (TLSv1.2 only)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_evaluation_activities_for_selection_based_requirements">4. Evaluation Activities for Selection-Based Requirements</a>
<ul class="sectlevel2">
<li><a href="#_security_audit_fau_3">4.1. Security Audit (FAU)</a>
<ul class="sectlevel3">
<li><a href="#_fau_gen_ext_1_security_audit_data_generation_for_distributed_toe_components">4.1.1. FAU_GEN_EXT.1 Security Audit Data Generation for Distributed TOE Components</a></li>
<li><a href="#_fau_stg_ext_4_protected_local_audit_event_storage_for_distributed_toes_fau_stg_ext_5_protected_remote_audit_event_storage_for_distributed_toes">4.1.2. FAU_STG_EXT.4 Protected Local audit event storage for distributed TOEs &amp; FAU_STG_EXT.5 Protected Remote audit event storage for Distributed TOEs</a></li>
</ul>
</li>
<li><a href="#_cryptographic_support_fcs_3">4.2. Cryptographic Support (FCS)</a>
<ul class="sectlevel3">
<li><a href="#_fcs_dtlsc_ext_1_extended_dtls_client_protocol">4.2.1. FCS_DTLSC_EXT.1 Extended: DTLS Client Protocol</a></li>
<li><a href="#_fcs_dtlss_ext_1_extended_dtls_server_protocol">4.2.2. FCS_DTLSS_EXT.1 Extended: DTLS Server Protocol</a></li>
<li><a href="#_fcs_https_ext_1_https_protocol">4.2.3. FCS_HTTPS_EXT.1 HTTPS Protocol</a></li>
<li><a href="#_fcs_ipsec_ext_1_ipsec_protocol">4.2.4. FCS_IPSEC_EXT.1 IPsec Protocol</a></li>
<li><a href="#_fcs_ntp_ext_1_ntp_protocol">4.2.5. FCS_NTP_EXT.1 NTP Protocol</a></li>
<li><a href="#_fcs_tlsc_ext_1_extended_tls_client_protocol">4.2.6. FCS_TLSC_EXT.1 Extended: TLS Client Protocol</a></li>
<li><a href="#_fcs_tlss_ext_1_extended_tls_server_protocol">4.2.7. FCS_TLSS_EXT.1 Extended: TLS Server Protocol</a></li>
</ul>
</li>
<li><a href="#_identification_and_authentication_fia_3">4.3. Identification and Authentication (FIA)</a>
<ul class="sectlevel3">
<li><a href="#_fia_x509_ext_1rev_x_509_certificate_validation">4.3.1. FIA_X509_EXT.1/Rev X.509 Certificate Validation</a></li>
<li><a href="#_fia_x509_ext_2_x_509_certificate_authentication">4.3.2. FIA_X509_EXT.2 X.509 Certificate Authentication</a></li>
<li><a href="#_fia_x509_ext_3_extended_x509_certificate_requests">4.3.3. FIA_X509_EXT.3 Extended: X509 Certificate Requests</a></li>
<li><a href="#_fia_afl_1_authentication_failure_management">4.3.4. FIA_AFL.1 Authentication Failure Management</a></li>
<li><a href="#_fia_uau_7_protected_authentication_feedback">4.3.5. FIA_UAU.7 Protected Authentication Feedback</a></li>
<li><a href="#_fia_pmg_ext_1_password_management">4.3.6. FIA_PMG_EXT.1 Password Management</a></li>
</ul>
</li>
<li><a href="#_protection_of_the_tsf_fpt_3">4.4. Protection of the TSF (FPT)</a>
<ul class="sectlevel3">
<li><a href="#_fpt_apw_ext_1_protection_of_administrator_passwords">4.4.1. FPT_APW_EXT.1 Protection of Administrator Passwords</a></li>
<li><a href="#_fpt_tud_ext_2_trusted_update_based_on_certificates">4.4.2. FPT_TUD_EXT.2 Trusted Update based on certificates</a></li>
</ul>
</li>
<li><a href="#_security_management_fmt_2">4.5. Security management (FMT)</a>
<ul class="sectlevel3">
<li><a href="#_fmt_mof_1services_management_of_security_functions_behaviour">4.5.1. FMT_MOF.1/Services Management of security functions behaviour</a></li>
<li><a href="#_fmt_mof_1autoupdate_management_of_security_functions_behaviour">4.5.2. FMT_MOF.1/AutoUpdate Management of security functions behaviour</a></li>
<li><a href="#_fmt_mof_1functions_management_of_security_functions_behaviour">4.5.3. FMT_MOF.1/Functions Management of security functions behaviour</a></li>
<li><a href="#_fmt_mtd_1cryptokeys_management_of_tsf_data">4.5.4. FMT_MTD.1/CryptoKeys Management of TSF Data</a></li>
</ul>
</li>
<li><a href="#_toe_access_fta_2">4.6. TOE Access (FTA)</a>
<ul class="sectlevel3">
<li><a href="#_fta_ssl_ext_1_tsf_initiated_session_locking">4.6.1. FTA_SSL_EXT.1 TSF-initiated Session Locking</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_evaluation_activities_for_sars">5. Evaluation Activities for SARs</a>
<ul class="sectlevel2">
<li><a href="#_ase_security_target_evaluation">5.1. ASE: Security Target Evaluation</a>
<ul class="sectlevel3">
<li><a href="#_general_evaluation_activities_for_toe_summary_specification_ase_tss_1_for_all_toes">5.1.1. General evaluation activities for TOE summary specification (ASE_TSS.1) for all TOEs</a></li>
<li><a href="#_additional_evaluation_activities_for_toe_summary_specification_ase_tss_1_for_distributed_toes">5.1.2. Additional evaluation activities for TOE summary specification (ASE_TSS.1) for Distributed TOEs</a></li>
</ul>
</li>
<li><a href="#_adv_development">5.2. ADV: Development</a>
<ul class="sectlevel3">
<li><a href="#_basic_functional_specification_adv_fsp_1">5.2.1. Basic Functional Specification (ADV_FSP.1)</a></li>
</ul>
</li>
<li><a href="#_agd_guidance_documents">5.3. AGD: Guidance Documents</a>
<ul class="sectlevel3">
<li><a href="#_operational_user_guidance_agd_ope_1">5.3.1. Operational User Guidance (AGD_OPE.1)</a></li>
<li><a href="#_preparative_procedures_agd_pre_1">5.3.2. Preparative Procedures (AGD_PRE.1)</a></li>
</ul>
</li>
<li><a href="#_alc_life_cycle_support">5.4. ALC: Life-cycle Support</a>
<ul class="sectlevel3">
<li><a href="#_labelling_of_the_toe_alc_cmc_1">5.4.1. Labelling of the TOE (ALC_CMC.1)</a></li>
<li><a href="#_toe_cm_coverage_alc_cms_1">5.4.2. TOE CM coverage (ALC_CMS.1)</a></li>
<li><a href="#_basic_flaw_remediation_alc_flr_1_optional">5.4.3. Basic flaw remediation (ALC_FLR.1) (optional)</a></li>
<li><a href="#_flaw_reporting_procedures_alc_flr_2_optional">5.4.4. Flaw reporting procedures (ALC_FLR.2) (optional)</a></li>
<li><a href="#_systematic_flaw_remediation_alc_flr_3_optional">5.4.5. Systematic flaw remediation (ALC_FLR.3) (optional)</a></li>
</ul>
</li>
<li><a href="#_ate_tests">5.5. ATE: Tests</a>
<ul class="sectlevel3">
<li><a href="#_independent_testing_conformance_ate_ind_1">5.5.1. Independent Testing – Conformance (ATE_IND.1)</a></li>
</ul>
</li>
<li><a href="#_ava_vulnerability_assessment">5.6. AVA: Vulnerability Assessment</a>
<ul class="sectlevel3">
<li><a href="#_vulnerability_survey_ava_van_1">5.6.1. Vulnerability Survey (AVA_VAN.1)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_required_supplementary_information">6. Required Supplementary Information</a></li>
<li><a href="#_references">7. References</a></li>
<li><a href="#_vulnerability_analysis">Appendix A: Vulnerability Analysis</a>
<ul class="sectlevel2">
<li><a href="#_sources_of_vulnerability_information">A.1. Sources of vulnerability information</a>
<ul class="sectlevel3">
<li><a href="#_type_1_hypotheses_public_vulnerability_based">A.1.1. Type 1 Hypotheses – Public-Vulnerability-Based</a></li>
<li><a href="#_type_2_hypotheses_itc_sourced">A.1.2. Type 2 Hypotheses – iTC-Sourced</a></li>
<li><a href="#_type_3_hypotheses_evaluation_team_generated">A.1.3. Type 3 Hypotheses – Evaluation-Team-Generated</a></li>
<li><a href="#_type_4_hypotheses_tool_generated">A.1.4. Type 4 Hypotheses – Tool-Generated</a></li>
</ul>
</li>
<li><a href="#_process_for_evaluator_vulnerability_analysis">A.2. Process for Evaluator Vulnerability Analysis</a></li>
<li><a href="#_reporting">A.3. Reporting</a></li>
<li><a href="#_public_vulnerability_sources">A.4. Public Vulnerability Sources</a></li>
<li><a href="#_additional_flaw_hypotheses">A.5. Additional Flaw Hypotheses</a></li>
</ul>
</li>
<li><a href="#_network_device_equivalency_considerations">Appendix B: Network Device Equivalency Considerations</a>
<ul class="sectlevel2">
<li><a href="#_introduction_2">B.1. Introduction</a></li>
<li><a href="#_evaluator_guidance_for_determining_equivalence">B.2. Evaluator guidance for determining equivalence</a>
<ul class="sectlevel3">
<li><a href="#_strategy">B.2.1. Strategy</a></li>
<li><a href="#_guidance_for_network_devices">B.2.2. Guidance for Network Devices</a></li>
</ul>
</li>
<li><a href="#_test_presentationtruth_in_advertising">B.3. Test presentation/Truth in advertising</a></li>
<li><a href="#_evaluating_additional_components_for_a_distributed_toe">B.4. Evaluating additional components for a distributed TOE</a>
<ul class="sectlevel3">
<li><a href="#_evaluator_actions_for_assessing_the_st">B.4.1. Evaluator Actions for Assessing the ST</a></li>
<li><a href="#_evaluator_actions_for_assessing_the_guidance_documentation">B.4.2. Evaluator Actions for Assessing the Guidance Documentation</a></li>
<li><a href="#_evaluator_actions_for_testing_the_toe">B.4.3. Evaluator Actions for Testing the TOE</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>List of Tables</strong></p>
</div>
<div class="paragraph">
<p><a href="#_Toc473308377">Table 1: Mapping of ADV_FSP.1 CEM Work Units to Evaluation Activities</a></p>
</div>
<div class="paragraph">
<p><a href="#_Ref453153408">Table 2: Mapping of AVA_VAN.1 CEM Work Units to Evaluation Activities</a></p>
</div>
<div class="paragraph">
<p><a href="#_Toc412821715">Table 3: Evaluation Equivalency Analysis</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_technology_area_and_scope_of_supporting_document">1.1. Technology Area and Scope of Supporting Document</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This Supporting Document (SD) defines the Evaluation Activities associated with the collaborative Protection Profile for Network Devices [NDcPP].</p>
</li>
<li>
<p>The Network Device technical area has a number of specialised aspects, such as those relating to the secure implementation and use of protocols, and to the particular ways in which remote management facilities need to be assessed across a range of different physical and logical interfaces for different types of infrastructure devices. This degree of specialisation, and the associations between individual Security Functional Requirements (SFR) in the cPP, make it important for both efficiency and effectiveness that evaluation activities are given more specific interpretations than those found in the generic CEM activities.</p>
</li>
<li>
<p>This Supporting Document is mandatory for evaluations of products that claim conformance to any of the following cPP(s):</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>collaborative Protection Profile for Network Devices [NDcPP]</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Although Evaluation Activities (EA) are defined mainly for the evaluators to follow, the definitions in this Supporting Document aim to provide a common understanding for developers, evaluators and users of the product as to what aspects of the TOE are tested in an evaluation against the associated cPPs, and to what depth the testing is carried out. This common understanding in turn contributes to the goal of ensuring that evaluations against the cPP achieve comparable, transparent and repeatable results. In general, the definition of Evaluation Activities will also help Developers to prepare for evaluation by identifying specific requirements for their TOE. The specific requirements in Evaluation Activities may in some cases clarify the meaning of SFRs, and may identify particular requirements for the content of Security Targets (ST) (especially the TOE Summary Specification (TSS)), Administrator Guidance Documentation (AGD), and possibly supplementary information (e.g. for entropy analysis or cryptographic key management architecture – see section 6).</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_structure_of_the_document">1.2. Structure of the Document</h3>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Evaluation Activities can be defined for both Security Functional Requirements and Security Assurance Requirements (SAR). These are defined in separate sections of this Supporting Document.</p>
</li>
<li>
<p>If any Evaluation Activity cannot be successfully completed in an evaluation, then the overall verdict for the evaluation is a ‘fail’. In rare cases there may be acceptable reasons why an Evaluation Activity may be modified or deemed not applicable for a particular TOE, but this must be agreed with the Certification Body for the evaluation and documented in the evaluation report.</p>
</li>
<li>
<p>In general, if all Evaluation Activities (for both SFRs and SARs) are successfully completed in an evaluation then it would be expected that the overall verdict for the evaluation is a ‘pass’.</p>
</li>
<li>
<p>Similarly, at the more granular level of Assurance Components, if the Evaluation Activities for an Assurance Component and all of its related SFR Evaluation Activities are successfully completed in an evaluation then it would be expected that the verdict for the Assurance Component is a ‘pass’.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_application_of_this_supporting_document">1.3. Application of this Supporting Document</h3>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>This Supporting Document defines three types of Evaluation Activities TOE Summary Specification, Guidance Documentation, and Tests and is designed to be used in conjunction with cPPs. cPPs that rely on this SD will explicitly identify it as a source for their EAs<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>. Each security requirement (SFR or SAR) specified in the cPP could have multiple EAs associated with it. The security requirement naming convention is consistent between cPP and SD ensuring a clear one to one correspondence between security requirements and evaluation activities.</p>
</li>
<li>
<p>The cPP and SD are designed to be used in conjunction with each other, where the cPP lists SFRs and SARs and the SD catalogues EAs associated with each SFR and SAR. Some of the SFRs included in the cPP are optional or selection-based. Therefore, an ST claiming conformance to the cPP does not necessarily have to include all possible SFRs defined in the cPP.</p>
</li>
<li>
<p>In an ST conformant to the cPP, several operations need to be performed (mainly selections and assignments). Some EAs define separate actions for different selected or assigned values in SFRs. The evaluator shall neither carry out EAs related to SFRs that are not claimed in the ST nor EAs related to specific selected or assigned values that are not claimed in the ST.</p>
</li>
<li>
<p>EAs do not necessarily have to be executed independently from each other. A description in a guidance documentation or one test case, for example, can cover multiple EAs at a time, no matter whether the EAs are related to the same or different SFRs.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_terminology">1.4. Terminology</h3>
<div class="sect3">
<h4 id="_glossary">1.4.1. Glossary</h4>
<div class="olist arabic">
<ol class="arabic" start="13">
<li>
<p>For definitions of standard CC terminology see [CC] part 1.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Term</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Meaning</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Administrator</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See Security Administrator.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assurance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Grounds for confidence that a TOE meets the SFRs [CC1].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Security Administrator</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The terms “Administrator” “Security Administrator” and “User” are used interchangeably in this document at present and are used to represent a person that has authorized access to the TOE to perform configuration and management tasks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Supplementary Information</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information that is not necessarily included in the Security Target or operational guidance, and that may not necessarily be public. Examples of such information could be entropy analysis, or description of a cryptographic key management architecture used in (or in support of) the TOE. The requirement for any such supplementary information will be identified in the relevant cPP or PP-Module.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Target of Evaluation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A set of software, firmware and/or hardware possibly accompanied by guidance. [CC1]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TOE Security Functionality (TSF)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A set consisting of all hardware, software, and firmware of the TOE that must be relied upon for the correct enforcement of the SFRs. [CC1]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TSF Data</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data for the operation of the TSF upon which the enforcement of the requirements relies.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_acronyms">1.4.2. Acronyms</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Acronym</strong></th>
<th class="tableblock halign-left valign-top"><strong>Meaning</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cPP</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">collaborative Protection Profile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CA</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate Authority</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CN</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CRL</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate Revocation List</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CVE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Vulnerabilities and Exposures (database)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DN</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distinguished Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DNS</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain Name Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EA</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluation Activity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EC</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elliptic Curve</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DHE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ephemeral Diffie-Hellman Key Exchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>FFC</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Finite Field Cryptography</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>FQDN</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fully Qualified Domain Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>IKE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet Key Exchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>iTC</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">International Technical Community</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NIST</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">National Institute of Standards and Technology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OCSP</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Online Certificate Status Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>RBG</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Random Bit Generator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SAN</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subject Alternative Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Assurance Requirement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SFR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Functional Requirement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SD</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supporting Document</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SSH</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure Shell</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SSL</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure Sockets Layer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TLS</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transport Layer Security</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activities_for_sfrs">2. Evaluation Activities for SFRs</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic" start="14">
<li>
<p>The EAs presented in this section capture the actions the evaluator shall perform to address technology specific aspects covering specific SARs (e.g., ASE_TSS.1, ADV_FSP.1, AGD_OPE.1, and ATE_IND.1) – this is in addition to the CEM work units that are performed in Section 5 (Evaluation Activities for SARs).</p>
</li>
<li>
<p>Regarding design descriptions (designated by the subsections labelled TSS, as well as any required supplementary material that may be treated as proprietary), the evaluator must ensure there is specific information that satisfies the EA. For findings regarding the TSS section, the evaluator’s verdicts will be associated with the CEM work unit ASE_TSS.1-1. Evaluator verdicts associated with the supplementary evidence will also be associated with ASE_TSS.1-1, since the requirement to provide such evidence is specified in ASE in the cPP.</p>
</li>
<li>
<p>For ensuring the guidance documentation provides sufficient information for the Security Administrators as it pertains to SFRs, the evaluator’s verdicts will be associated with CEM work units AGD_OPE.1-4 and AGD_OPE.1-5.</p>
</li>
<li>
<p>Finally, the subsection labelled Tests is where the iTC has determined that testing of the product in the context of the associated SFR is necessary. While the evaluator is expected to develop tests, there may be instances where it is more practical for the developer to construct tests, or where the developer may have existing tests. Approval for using tests created by developers is up to the certification body. The CEM work units that are associated with the EAs specified in this section are: ATE_IND.1-3, ATE_IND.1-4, ATE_IND.1-5, ATE_IND.1-6, and ATE_IND.1-7.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>Additional Note for Distributed TOEs</em></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="18">
<li>
<p>For a distributed TOE, all examination of Operational Guidance information should be extended to include confirmation that it defines sufficient information to configure individual components such that the overall TOE is correctly established.</p>
</li>
<li>
<p>Evaluation activities for SFRs must be carried out for all distributed TOE components that implement the SFR (as defined in the mapping of SFRs to components, cf. section 5.1.2). This applies to optional and selection-based SFRs in section 3 and 4 as well as to the core SFRs in this section.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_security_audit_fau">2.1. Security Audit (FAU)</h3>
<div class="sect3">
<h4 id="_fau_gen_1_audit_data_generation">2.1.1. FAU_GEN.1 Audit data generation</h4>
<div class="olist arabic">
<ol class="arabic" start="20">
<li>
<p>The main reasons for collecting audit information are to detect and identify error conditions, security violations, etc. and to provide sufficient information to the Security Administrator to resolve the issue. The audit information to be collected according to FAU_GEN.1, and the failure conditions identified in tables 2, 4, and 5 need to enable the Security Administrator at least to detect and identify the problem and provide at least basic information to resolve the issue. Also for this level of detail, the other FAU requirements apply, in particular the need for local and remote storage of audit information according to FAU_STG_EXT.1.</p>
</li>
<li>
<p>The level of detail that needs to be provided to the Security Administrator to actually resolve an issue usually depends on the complexity of the underlying use case. It is expected that a product provides additional levels of auditing to support resolution of error conditions, security violations, etc. beyond the level required by FAU_GEN.1, but it should also be clear that a high level of granularity cannot be maintained on most systems by default due to the high number of audit events that would be generated in such a configuration. It is expected that the TOE will be capable of auditing sufficient information to meet the requirements of FAU_GEN.1. If the TOE allows configuration of the level of auditing without taking the TOE out of the evaluated configuration, some of the audit events required by FAU_GEN.1 may only be recorded after corresponding configuration of the audit functionality.</p>
</li>
<li>
<p>The issue described above explicitly refers to the use of X.509 certificates. In case a certificate-based authentication fails, an error message telling the Security Administrator that ‘something is wrong with the certificate’ shall not be considered as sufficient information about the ‘reason for failure’ as a basic information to resolve the issue. The log message will inform the Security Administrator of at least the following:</p>
<div class="ulist">
<ul>
<li>
<p>‘Trust issue’ with the certificate, e.g. due to failed path validation</p>
</li>
<li>
<p>Use of an ‘expired certificate’</p>
</li>
<li>
<p>Absence of basicConstraints extension</p>
</li>
<li>
<p>CA flag not set for a certificate presented as a CA</p>
</li>
<li>
<p>Signature validation failure for any certificate in the certificate path; failure to establish revocation status; revoked certificate</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="23">
<li>
<p>As such for audit information related to the use of X.509 certificates that it uniquely identifies the certificate that could not be successfully verified. For example, identification of a certificate could include Key Subject and Key ID, where key subject is an identifier contained in the CN or SAN and where Key ID is a certificate&#8217;s serial number and issuer name or subject key identifier (SKI) and authority key identifier (AKI). In general, when using open source libraries like OpenSSL, passing on error messages from such libraries to the Security Administrator is regarded as good practice.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_tss">2.1.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="24">
<li>
<p>For the administrative task of generating/import of, changing, or deleting of cryptographic keys as defined in FAU_GEN.1.1c, the TSS should identify what information is logged to identify the relevant key.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall examine the TSS to ensure that it describes which of the overall required auditable events defined in FAU_GEN.1.1 are generated and recorded by which TOE components. The evaluator shall ensure that this mapping of audit events to TOE components accounts for, and is consistent with, information provided in Table 1, as well as events in Tables 2, 4, and 5 (where applicable to the overall TOE). This includes that the evaluator shall confirm that all components defined as generating audit information for a particular SFR should also contribute to that SFR as defined in the mapping of SFRs to TOE components, and that the audit records generated by each component cover all the SFRs that it implements.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation">2.1.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="26">
<li>
<p>The evaluator shall check the guidance documentation and ensure that it provides an example of each auditable event required by FAU_GEN.1 (i.e. at least one instance of each auditable event, comprising the mandatory, optional and selection-based SFR sections as applicable, shall be provided from the actual audit record).</p>
</li>
<li>
<p>The evaluator shall also make a determination of the administrative actions related to TSF data related to configuration changes. The evaluator shall examine the guidance documentation and make a determination of which administrative commands, including subcommands, scripts, and configuration files, are related to the configuration (including enabling or disabling) of the mechanisms implemented in the TOE that are necessary to enforce the requirements specified in the cPP. The evaluator shall document the methodology or approach taken while determining which actions in the administrative guide are related to TSF data related to configuration changes. The evaluator may perform this activity as part of the activities associated with ensuring that the corresponding guidance documentation satisfies the requirements related to it.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests">2.1.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="28">
<li>
<p>The evaluator shall test the TOE’s ability to correctly generate audit records by having the TOE generate audit records for the events listed in the table of audit events and administrative actions listed above. This should include all instances of an event: for instance, if there are several different I&amp;A mechanisms for a system, the FIA_UIA_EXT.1 events must be generated for each mechanism. The evaluator shall test that audit records are generated for the establishment and termination of a channel for each of the cryptographic protocols contained in the ST. If HTTPS is implemented, the test demonstrating the establishment and termination of a TLS session can be combined with the test for an HTTPS session. When verifying the test results, the evaluator shall ensure the audit records generated during testing match the format specified in the guidance documentation, and that the fields in each audit record have the proper entries.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall perform tests on all TOE components according to the mapping of auditable events to TOE components in the Security Target. For all events involving more than one TOE component when an audit event is triggered, the evaluator has to check that the event has been audited on both sides (e.g. failure of building up a secure communication channel between the two components). This is not limited to error cases but includes also events about successful actions like successful build up/tear down of a secure communication channel between TOE components.</p>
</li>
<li>
<p>Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fau_gen_2_user_identity_association">2.1.2. FAU_GEN.2 User identity association</h4>
<div class="sect4">
<h5 id="_tss_guidance_documentation">2.1.2.1. TSS &amp; Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="31">
<li>
<p>The TSS and Guidance Documentation requirements for FAU_GEN.2 are already covered by the TSS and Guidance Documentation requirements for FAU_GEN.1.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_2">2.1.2.2. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="32">
<li>
<p>This activity should be accomplished in conjunction with the testing of FAU_GEN.1.1.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall verify that where auditable events are instigated by another component, the component that records the event associates the event with the identity of the instigator. The evaluator shall perform at least one test on one component where another component instigates an auditable event. The evaluator shall verify that the event is recorded by the component as expected and the event is associated with the instigating component. It is assumed that an event instigated by another component can at least be generated for building up a secure channel between two TOE components. If for some reason (could be e.g. TSS or Guidance Documentation) the evaluator would come to the conclusion that the overall TOE does not generate any events instigated by other components, then this requirement shall be omitted.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fau_stg_ext_1_protected_audit_event_storage">2.1.3. FAU_STG_EXT.1 Protected Audit Event Storage</h4>
<div class="sect4">
<h5 id="_tss_2">2.1.3.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="34">
<li>
<p>The evaluator shall examine the TSS to ensure it describes the means by which the audit data are transferred to the external audit server, and how the trusted channel is provided.</p>
</li>
<li>
<p>The evaluator shall examine the TSS to ensure it describes whether the TOE is a standalone TOE that stores audit data locally or a distributed TOE that stores audit data locally on each TOE component or a distributed TOE that contains TOE components that cannot store audit data locally on themselves but need to transfer audit data to other TOE components that can store audit data locally. The evaluator shall examine the TSS to ensure that for distributed TOEs it contains a list of TOE components that store audit data locally. The evaluator shall examine the TSS to ensure that for distributed TOEs that contain components which do not store audit data locally but transmit their generated audit data to other components it contains a mapping between the transmitting and storing TOE components.</p>
</li>
<li>
<p>The evaluator shall examine the TSS to ensure that it details whether the transmission of audit data to an external IT entity can be done in real-time, periodically, or both. In the case where the TOE is capable of performing transmission periodically, the evaluator needs to verify that the TSS provides details about what event stimulates the transmission to be made as well as the possible acceptable frequency for the transfer of audit data.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall examine the TSS to ensure it describes to which TOE components this SFR applies and how audit data transfer to the external audit server is implemented among the different TOE components (e.g. every TOE components does its own transfer or the data is sent to another TOE component for central transfer of all audit events to the external audit server).</p>
</li>
<li>
<p>The evaluator shall examine the TSS to ensure it describes the amount of audit data that can be stored locally and how these records are protected against unauthorized modification or deletion.</p>
</li>
<li>
<p>The evaluator shall examine the TSS to ensure it describes the method implemented for local logging, including format (e.g. buffer, log file, database) and whether the logs are persistent or non-persistent.</p>
</li>
<li>
<p>The evaluator shall examine the TSS to ensure it describes the conditions that must be met for authorized deletion of audit records.</p>
</li>
<li>
<p>The evaluator shall examine the TSS to ensure it details the behaviour of the TOE when the storage space for audit data is full. When the option ‘overwrite previous audit record’ is selected this description should include an outline of the rule for overwriting audit data. If ‘other actions’ are chosen such as sending the new audit data to an external IT entity, then the related behaviour of the TOE shall also be detailed in the TSS.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall examine the TSS to ensure it describes which TOE components are storing audit information locally and which components are buffering audit information and forwarding the information to another TOE component for local storage. For every component the TSS shall describe the behaviour when local storage space or buffer space is exhausted.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_2">2.1.3.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="43">
<li>
<p>The evaluator shall also examine the guidance documentation to ensure it describes how to establish the trusted channel to the audit server, as well as describe any requirements on the audit server (particular audit server protocol, version of the protocol required, etc.), as well as configuration of the TOE needed to communicate with the audit server.</p>
</li>
<li>
<p>The evaluator shall also examine the guidance documentation to ensure it describes the relationship between the local audit data and the audit data that are sent to the audit log server. For example, when an audit event is generated, is it simultaneously sent to the external server and the local store, or is the local store used as a buffer and “cleared” periodically by sending the data to the audit server.</p>
</li>
<li>
<p>The evaluator shall examine the guidance documentation to ensure it describes any configuration required for protection of the locally stored audit data against unauthorized modification or deletion.</p>
</li>
<li>
<p>If the storage size is configurable, the evaluator shall review the Guidance Documentation to ensure it contains instructions on specifying the required parameters.</p>
</li>
<li>
<p>If more than one selection is made for FAU_STG_EXT.1.5, the evaluator shall review the Guidance Documentation to ensure it contains instructions on specifying which action is performed when the local storage space is full.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_3">2.1.3.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="48">
<li>
<p>Testing of secure transmission of the audit data externally (FTP_ITC.1) and, where applicable, intercomponent (FPT_ITT.1 or FTP_ITC.1) shall be performed according to the assurance activities for the particular protocol(s).</p>
</li>
<li>
<p>The evaluator shall perform the following additional test for this requirement:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall establish a session between the TOE and the audit server according to the configuration guidance provided. The evaluator shall then examine the traffic that passes between the audit server and the TOE during several activities of the evaluator’s choice designed to generate audit data to be transferred to the audit server. The evaluator shall observe that these data are not able to be viewed in the clear during this transfer, and that they are successfully received by the audit server. The evaluator shall record the particular software (name, version) used on the audit server during testing. The evaluator shall verify that the TOE is capable of transferring audit data to an external audit server automatically without administrator intervention.</p>
</li>
<li>
<p>Test 2: For distributed TOEs, Test 1 defined above shall be applicable to all TOE components that forward audit data to an external audit server.</p>
</li>
<li>
<p>Test 3: The evaluator shall perform operations that generate audit data and verify that this data is stored locally. The evaluator shall then make note of whether the TSS claims persistent or non-persistent logging and perform one of the following actions:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>If persistent logging is selected, the evaluator shall perform a power cycle of the TOE and ensure that following power on operations the log events generated are still maintained within the local audit storage.</p>
</li>
<li>
<p>If non-persistent logging is selected, the evaluator shall perform a power cycle of the TOE and ensure that following power on operations the log events generated are no longer present within the local audit storage.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 4: The evaluator shall perform operations that generate audit data until the local storage space is exceeded and verifies that the TOE complies with the behaviour defined in FAU_STG_EXT.1.5. Depending on the configuration this means that the evaluator has to check the content of the audit data when the audit data is just filled to the maximum and then verifies that:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The audit data remains unchanged with every new auditable event that should be tracked but that the audit data is recorded again after the local storage for audit data is cleared (for the option ‘drop new audit data’ in FAU_STG_EXT.1.5).</p>
</li>
<li>
<p>The existing audit data is overwritten with every new auditable event that should be tracked according to the specified rule (for the option ‘overwrite previous audit records’ in FAU_STG_EXT.1.5)</p>
</li>
<li>
<p>The TOE behaves as specified (for the option ‘other action’ in FAU_STG_EXT.1.5).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 5: For distributed TOEs, for the local storage according to FAU_STG_EXT.1.4, Test 1 specified above shall be applied to all TOE components that store audit data locally. For all TOE components that store audit data locally and comply with FAU_STG_EXT.2, Test 2 specified above shall be applied. The evaluator shall verify that the transfer of audit data to an external audit server is implemented.</p>
</li>
<li>
<p>Test 6 [Conditional]: In case manual export or ability to view locally is selected in FAU_STG_EXT.1.4/LocSpace, during interruption the evaluator shall perform a TSF-mediated action and verify the event is recorded in the audit trail.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cryptographic_support_fcs">2.2. Cryptographic Support (FCS)</h3>
<div class="sect3">
<h4 id="_fcs_ckm_1_cryptographic_key_generation">2.2.1. FCS_CKM.1 Cryptographic Key Generation</h4>
<div class="sect4">
<h5 id="_tss_3">2.2.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="50">
<li>
<p>The evaluator shall ensure that the TSS identifies the key sizes supported by the TOE. If the ST specifies more than one scheme, the evaluator shall examine the TSS to verify that it identifies the usage for each scheme.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_3">2.2.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="51">
<li>
<p>The evaluator shall verify that the AGD guidance instructs the administrator how to configure the TOE to use the selected key generation scheme(s) and key size(s) for all cryptographic protocols defined in the Security Target.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_4">2.2.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="52">
<li>
<p>Note: The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products. Generation of long-term cryptographic keys (i.e. keys that are not ephemeral keys/session keys) might be performed automatically (e.g. during initial start-up). Testing of key generation must cover not only administrator invoked key generation but also automated key generation (if supported).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Key Generation for FIPS PUB 186-4 RSA Schemes</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="53">
<li>
<p>The evaluator shall verify the implementation of RSA Key Generation by the TOE using the Key Generation test. This test verifies the ability of the TSF to correctly produce values for the key components including the public verification exponent <em>e</em>, the private prime factors <em>p</em> and <em>q</em>, the public modulus <em>n</em> and the calculation of the private signature exponent <em>d</em>.</p>
</li>
<li>
<p>Key Pair generation specifies 5 ways (or methods) to generate the primes <em>p</em> and <em>q</em>. These include:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Random Primes:</p>
<div class="ulist">
<ul>
<li>
<p>Provable primes</p>
</li>
<li>
<p>Probable primes</p>
</li>
</ul>
</div>
</li>
<li>
<p>Primes with Conditions:</p>
<div class="ulist">
<ul>
<li>
<p>Primes p1, p2, q1, q2, p and q shall all be provable primes</p>
</li>
<li>
<p>Primes p1, p2, q1, and q2 shall be provable primes and p and q shall be probable primes</p>
</li>
<li>
<p>Primes p1, p2, q1, q2, p and q shall all be probable primes</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="55">
<li>
<p>To test the key generation method for the Random Provable primes method and for all the Primes with Conditions methods, the evaluator must seed the TSF key generation routine with sufficient data to deterministically generate the RSA key pair. This includes the random seed(s), the public exponent of the RSA key, and the desired key length. For each key length supported, the evaluator shall have the TSF generate 25 key pairs. The evaluator shall verify the correctness of the TSF’s implementation by comparing values generated by the TSF with those generated from a known good implementation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Key Generation for Elliptic Curve Cryptography (ECC)</strong></p>
</div>
<div class="paragraph">
<p><em>FIPS 186-4 ECC Key Generation Test</em></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="56">
<li>
<p>For each supported NIST curve, i.e., P-256, P-384 and P-521, the evaluator shall require the implementation under test (IUT) to generate 10 private/public key pairs. The private key shall be generated using an approved random bit generator (RBG). To determine correctness, the evaluator shall submit the generated key pairs to the public key verification (PKV) function of a known good implementation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>FIPS 186-4 Public Key Verification (PKV) Test</em></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="57">
<li>
<p>For each supported NIST curve, i.e., P-256, P-384 and P-521, the evaluator shall generate 10 private/public key pairs using the key generation function of a known good implementation and modify five of the public key values so that they are incorrect, leaving five values unchanged (i.e., correct). The evaluator shall obtain in response a set of 10 PASS/FAIL values.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Key Generation for FIPS PUB 186-5</strong></p>
</div>
<div class="paragraph">
<p><em>FIPS 186-5 Key Generation Test</em></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="58">
<li>
<p>For the Ed25519 curve, the evaluator shall require the implementation under test (IUT) to generate 10 private/public key pairs. The private key shall be generated using an approved random bit generator (RBG). To determine correctness, the evaluator shall submit the generated key pairs to the public key verification (PKV) function of a known good implementation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>FIPS 186-5 Key Verification Test</em></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="59">
<li>
<p>For the Ed25519 curve, the evaluator shall generate 10 private/public key pairs using the key generation function of a known good implementation and modify five of the public key values so that they are incorrect, leaving five values unchanged (i.e., correct). The evaluator shall obtain in response a set of 10 PASS/FAIL values.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Key Generation for Finite-Field Cryptography (FFC)</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="60">
<li>
<p>The evaluator shall verify the implementation of the Parameters Generation and the Key Generation for FFC by the TOE using the Parameter Generation and Key Generation test. This test verifies the ability of the TSF to correctly produce values for the field prime p, the cryptographic prime q (dividing p-1), the cryptographic group generator g, and the calculation of the private key x and public key y.</p>
</li>
<li>
<p>The Parameter generation specifies 2 ways (or methods) to generate the cryptographic prime q and the field prime p:</p>
<div class="ulist">
<ul>
<li>
<p>Primes q and p shall both be provable primes </p>
</li>
<li>
<p>Primes q and field prime p shall both be probable primes</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="62">
<li>
<p>and two ways to generate the cryptographic group generator g:</p>
<div class="ulist">
<ul>
<li>
<p>Generator g constructed through a verifiable process</p>
</li>
<li>
<p>Generator g constructed through an unverifiable process.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="63">
<li>
<p>The Key generation specifies 2 ways to generate the private key x:</p>
<div class="ulist">
<ul>
<li>
<p>len(q) bit output of RBG where 1 &#8656;x &#8656; q-1 </p>
</li>
<li>
<p>len(q) + 64 bit output of RBG, followed by a mod q-1 operation and a +1 operation, where 1&#8656; x&#8656;q-1.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="64">
<li>
<p>The security strength of the RBG must be at least that of the security offered by the FFC parameter set.</p>
</li>
<li>
<p>To test the cryptographic and field prime generation method for the provable primes method and/or the group generator g for a verifiable process, the evaluator must seed the TSF parameter generation routine with sufficient data to deterministically generate the parameter set.</p>
</li>
<li>
<p>For each key length supported, the evaluator shall have the TSF generate 25 parameter sets and key pairs. The evaluator shall verify the correctness of the TSF’s implementation by comparing values generated by the TSF with those generated from a known good implementation. Verification must also confirm</p>
<div class="ulist">
<ul>
<li>
<p>g != 0,1</p>
</li>
<li>
<p>q divides p-1</p>
</li>
<li>
<p>g^q mod p = 1</p>
</li>
<li>
<p>g^x mod p = y</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="67">
<li>
<p>for each FFC parameter set and key pair.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FFC Schemes using “safe-prime” groups</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="68">
<li>
<p>Testing for FFC Schemes using safe-prime groups is done as part of testing in CKM.2.1.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_ckm_2_cryptographic_key_establishment">2.2.2. FCS_CKM.2 Cryptographic Key Establishment</h4>
<div class="sect4">
<h5 id="_tss_4">2.2.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="69">
<li>
<p>The evaluator shall ensure that the supported key establishment schemes correspond to the key generation schemes identified in FCS_CKM.1.1. If the ST specifies more than one scheme, the evaluator shall examine the TSS to verify that it identifies the usage for each scheme. It is sufficient to provide the scheme, SFR, and service in the TSS.</p>
</li>
<li>
<p>The intent of this activity is to be able to identify the scheme being used by each service. This would mean, for example, one way to document scheme usage could be as shown in the table below. The information provided in this example does not necessarily have to be included as a table but can be presented in other ways as long as the necessary data is available.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Scheme</strong></th>
<th class="tableblock halign-left valign-top"><strong>SFR</strong></th>
<th class="tableblock halign-left valign-top"><strong>Service</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_TLSS_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Administration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECDH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCS_IPSEC_EXT.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication Server</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_4">2.2.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="71">
<li>
<p>The evaluator shall verify that the AGD guidance instructs the administrator how to configure the TOE to use the selected key establishment scheme(s).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_5">2.2.2.3. Tests</h5>
<div class="paragraph">
<p><strong><em>Key Establishment Schemes</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="72">
<li>
<p>The evaluator shall verify the implementation of the key establishment schemes of the supported by the TOE using the applicable tests below.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>ECC and FIPS 186-type FFC SP800-56A Key Establishment Schemes</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="73">
<li>
<p>The evaluator shall verify a TOE&#8217;s implementation of SP800-56A key agreement schemes using the following Function and Validity tests for ECC and FIPS186-type. These validation tests for each key agreement scheme verify that a TOE has implemented the components of the key agreement scheme according to the specifications in the Recommendation. These components include the calculation of the DLC primitives (the shared secret value Z) and the calculation of the derived keying material (DKM) via the Key Derivation Function (KDF). If key confirmation is supported, the evaluator shall also verify that the components of key confirmation have been implemented correctly, using the test procedures described below. This includes the parsing of the DKM, the generation of MACdata and the calculation of MACtag.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>Function Test</em></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="74">
<li>
<p>The Function test verifies the ability of the TOE to implement the key agreement schemes correctly. To conduct this test the evaluator shall generate or obtain test vectors from a known good implementation of the TOE supported schemes. For each supported key agreement scheme-key agreement role combination, KDF type, and, if supported, key confirmation role- key confirmation type combination, the tester shall generate 10 sets of test vectors. The data set consists of one set of domain parameter values (FFC) or the NIST approved curve (ECC) per 10 sets of public keys. These keys are static, ephemeral or both depending on the scheme being tested.</p>
</li>
<li>
<p>The evaluator shall obtain the DKM, the corresponding TOE’s public keys (static and/or ephemeral), the MAC tag(s), and any inputs used in the KDF, such as the Other Information field OI and TOE id fields.</p>
</li>
<li>
<p>If the TOE does not use a KDF defined in SP 800-56A, the evaluator shall obtain only the public keys and the hashed value of the shared secret.</p>
</li>
<li>
<p>The evaluator shall verify the correctness of the TSF’s implementation of a given scheme by using a known good implementation to calculate the shared secret value, derive the keying material DKM, and compare hashes or MAC tags generated from these values.</p>
</li>
<li>
<p>If key confirmation is supported, the TSF shall perform the above for each implemented approved MAC algorithm.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>Validity Test</em></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="79">
<li>
<p>The Validity test verifies the ability of the TOE to recognize another party’s valid and invalid key agreement results with or without key confirmation. To conduct this test, the evaluator shall obtain a list of the supporting cryptographic functions included in the SP800-56A key agreement implementation to determine which errors the TOE should be able to recognize. The evaluator generates a set of 24 (FFC) or 30 (ECC) test vectors consisting of data sets including domain parameter values or NIST approved curves, the evaluator’s public keys, the TOE’s public/private key pairs, MACTag, and any inputs used in the KDF, such as the other info and TOE id fields.</p>
</li>
<li>
<p>The evaluator shall inject an error in some of the test vectors to test that the TOE recognizes invalid key agreement results caused by the following fields being incorrect: the shared secret value Z, the DKM, the other information field OI, the data to be MACed, or the generated MACTag. If the TOE contains the full or partial (only ECC) public key validation, the evaluator will also individually inject errors in both parties’ static public keys, both parties’ ephemeral public keys and the TOE’s static private key to assure the TOE detects errors in the public key validation function and/or the partial key validation function (in ECC only). At least two of the test vectors shall remain unmodified and therefore should result in valid key agreement results (they should pass).</p>
</li>
<li>
<p>The TOE shall use these modified test vectors to emulate the key agreement scheme using the corresponding parameters. The evaluator shall compare the TOE’s results with the results using a known good implementation verifying that the TOE detects these errors.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>RSA-based key establishment</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="82">
<li>
<p>The evaluator shall verify the correctness of the TSF’s implementation of RSAES-PKCS1-v1_5 by using a known good implementation for each protocol selected in FTP_TRP.1/Admin, FTP_TRP.1/Join, FTP_ITC.1 and FPT_ITT.1 that uses RSAES-PKCS1-v1_5.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>FFC Schemes using “safe-prime” groups</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="83">
<li>
<p>The evaluator shall verify the correctness of the TSF’s implementation of safe-prime groups by using a known good implementation for each protocol selected in FTP_TRP.1/Admin, FTP_TRP.1/Join, FTP_ITC.1 and FPT_ITT.1 that uses safe-prime groups. This test must be performed for each safe-prime group that each protocol uses.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_ckm_4_cryptographic_key_destruction">2.2.3. FCS_CKM.4 Cryptographic Key Destruction</h4>
<div class="sect4">
<h5 id="_tss_5">2.2.3.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="84">
<li>
<p>The evaluator examines the TSS to ensure it lists all relevant keys (describing the origin and storage location of each), all relevant key destruction situations (e.g. factory reset or device wipe function, disconnection of trusted channels, key change as part of a secure channel protocol), and the destruction method used in each case. For the purpose of this Evaluation Activity the relevant keys are those keys that are relied upon to support any of the SFRs in the Security Target. The evaluator confirms that the description of keys and storage locations is consistent with the functions carried out by the TOE (e.g. that all keys for the TOE-specific secure channels and protocols, or that support FPT_APW.EXT.1 and FPT_SKP_EXT.1, are accounted for<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup>). In particular, if a TOE claims not to store plaintext keys in non-volatile memory then the evaluator checks that this is consistent with the operation of the TOE.</p>
</li>
<li>
<p>The evaluator shall check to ensure the TSS identifies how the TOE destroys keys stored as plaintext in non-volatile memory, and that the description includes identification and description of the interfaces that the TOE uses to destroy keys (e.g., file system APIs, key store APIs).</p>
</li>
<li>
<p>Note that where selections involve ‘<em>destruction of reference</em>’ (for volatile memory) or ‘<em>invocation of an interface’</em> (for non-volatile memory) then the relevant interface definition is examined by the evaluator to ensure that the interface supports the selection(s) and description in the TSS. In the case of non-volatile memory, the evaluator includes in their examination the relevant interface description for each media type on which plaintext keys are stored. The presence of OS-level and storage device-level swap and cache files is not examined in the current version of the Evaluation Activity.</p>
</li>
<li>
<p>Where the TSS identifies keys that are stored in a non-plaintext form, the evaluator shall check that the TSS identifies the encryption method and the key-encrypting-key used, and that the key-encrypting-key is either itself stored in an encrypted form or that it is destroyed by a method included under FCS_CKM.4.</p>
</li>
<li>
<p>The evaluator shall check that the TSS identifies any configurations or circumstances that may not conform to the key destruction requirement (see further discussion in the Guidance Documentation section below). Note that reference may be made to the Guidance Documentation for description of the detail of such cases where destruction may be prevented or delayed.</p>
</li>
<li>
<p>Where the ST specifies the use of “a value that does not contain any CSP” to overwrite keys, the evaluator examines the TSS to ensure that it describes how that pattern is obtained and used, and that this justifies the claim that the pattern does not contain any CSPs.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_5">2.2.3.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="90">
<li>
<p>A TOE may be subject to situations that could prevent or delay key destruction in some cases. The evaluator shall check that the guidance documentation identifies configurations or circumstances that may not strictly conform to the key destruction requirement, and that this description is consistent with the relevant parts of the TSS (and any other supporting information used). The evaluator shall check that the guidance documentation provides guidance on situations where key destruction may be delayed at the physical layer.</p>
</li>
<li>
<p>For example, when the TOE does not have full access to the physical memory, it is possible that the storage may be implementing wear-levelling and garbage collection. This may result in additional copies of the key that are logically inaccessible but persist physically. Where available, the TOE might then describe use of the TRIM command<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup> and garbage collection to destroy these persistent copies upon their deletion (this would be explained in TSS and Operational Guidance).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_6">2.2.3.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="92">
<li>
<p>None</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1dataencryption_cryptographic_operation_aes_data_encryptiondecryption">2.2.4. FCS_COP.1/DataEncryption Cryptographic Operation (AES Data Encryption/Decryption)</h4>
<div class="sect4">
<h5 id="_tss_6">2.2.4.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="93">
<li>
<p>The evaluator shall examine the TSS to ensure it identifies the key size(s) and mode(s) supported by the TOE for data encryption/decryption.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_6">2.2.4.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="94">
<li>
<p>The evaluator shall verify that the AGD guidance instructs the administrator how to configure the TOE to use the selected mode(s) and key size(s) defined in the Security Target supported by the TOE for data encryption/decryption.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_7">2.2.4.3. Tests</h5>
<div class="paragraph">
<p><strong>AES-CBC Known Answer Tests</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="95">
<li>
<p>There are four Known Answer Tests (KATs), described below. In all KATs, the plaintext, ciphertext, and IV values shall be 128-bit blocks. The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation.</p>
</li>
<li>
<p><strong>KAT-1.</strong> To test the encrypt functionality of AES-CBC, the evaluator shall supply a set of 10 plaintext values and obtain the ciphertext value that results from AES-CBC encryption of the given plaintext using a key value of all zeros and an IV of all zeros. Five plaintext values shall be encrypted with a 128-bit all-zeros key, and the other five shall be encrypted with a 256-bit all-zeros key.</p>
</li>
<li>
<p>To test the decrypt functionality of AES-CBC, the evaluator shall perform the same test as for encrypt, using 10 ciphertext values as input and AES-CBC decryption.</p>
</li>
<li>
<p><strong>KAT-2.</strong> To test the encrypt functionality of AES-CBC, the evaluator shall supply a set of 10 key values and obtain the ciphertext value that results from AES-CBC encryption of an all-zeros plaintext using the given key value and an IV of all zeros. Five of the keys shall be 128-bit keys, and the other five shall be 256-bit keys.</p>
</li>
<li>
<p>To test the decrypt functionality of AES-CBC, the evaluator shall perform the same test as for encrypt, using an all-zero ciphertext value as input and AES-CBC decryption.</p>
</li>
<li>
<p><strong>KAT-3.</strong> To test the encrypt functionality of AES-CBC, the evaluator shall supply the two sets of key values described below and obtain the ciphertext value that results from AES encryption of an all-zeros plaintext using the given key value and an IV of all zeros. The first set of keys shall have 128 128-bit keys, and the second set shall have 256 256-bit keys. Key <em>i</em> in each set shall have the leftmost <em>i</em> bits be ones and the rightmost <em>N-i</em> bits be zeros, for <em>i</em> in [1,N].</p>
</li>
<li>
<p>To test the decrypt functionality of AES-CBC, the evaluator shall supply the two sets of keys and ciphertext value pairs described below and obtain the plaintext value that results from AES-CBC decryption of the given ciphertext using the given key and an IV of all zeros. The first set of key/ciphertext pairs shall have 128 128-bit key/ciphertext pairs, and the second set of key/ciphertext pairs shall have 256 256-bit key/ciphertext pairs. Key i in each set shall have the leftmost i bits be ones and the rightmost N-i bits be zeros, for i in [1,N]. The ciphertext value in each pair shall be the value that results in an all-zeros plaintext when decrypted with its corresponding key.</p>
</li>
<li>
<p><strong>KAT-4.</strong> To test the encrypt functionality of AES-CBC, the evaluator shall supply the set of 128 plaintext values described below and obtain the two ciphertext values that result from AES-CBC encryption of the given plaintext using a 128-bit key value of all zeros with an IV of all zeros and using a 256-bit key value of all zeros with an IV of all zeros, respectively. Plaintext value i in each set shall have the leftmost i bits be ones and the rightmost 128-i bits be zeros, for i in [1,128].</p>
</li>
<li>
<p>To test the decrypt functionality of AES-CBC, the evaluator shall perform the same test as for encrypt, using ciphertext values of the same form as the plaintext in the encrypt test as input and AES-CBC decryption.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>AES-CBC Multi-Block Message Test</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="104">
<li>
<p>The evaluator shall test the encrypt functionality by encrypting an <em>i</em>-block message where 1 &lt; <em>i &#8656;</em>10. The evaluator shall choose a key, an IV and plaintext message of length <em>i</em> blocks and encrypt the message, using the mode to be tested, with the chosen key and IV. The ciphertext shall be compared to the result of encrypting the same plaintext message with the same key and IV using a known good implementation.</p>
</li>
<li>
<p>The evaluator shall also test the decrypt functionality for each mode by decrypting an <em>i</em>-block message where 1 &lt; <em>i</em> &#8656;10. The evaluator shall choose a key, an IV and a ciphertext message of length <em>i</em> blocks and decrypt the message, using the mode to be tested, with the chosen key and IV. The plaintext shall be compared to the result of decrypting the same ciphertext message with the same key and IV using a known good implementation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>AES-CBC Monte Carlo Tests</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="106">
<li>
<p>The evaluator shall test the encrypt functionality using a set of 200 plaintext, IV, and key 3-tuples. 100 of these shall use 128 bit keys, and 100 shall use 256 bit keys. The plaintext and IV values shall be 128-bit blocks. For each 3-tuple, 1000 iterations shall be run as follows:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p># Input: PT, IV, Key</p>
</div>
<div class="literalblock">
<div class="content">
<pre>for i = 1 to 1000:
  if i == 1:
      CT[1] = AES-CBC-Encrypt(Key, IV, PT)
      PT = IV
  else:
      CT[i] = AES-CBC-Encrypt(Key, PT)
      PT = CT[i-1]</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="107">
<li>
<p>The ciphertext computed in the 1000<sup>th</sup> iteration (i.e., CT[1000]) is the result for that trial. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation.</p>
</li>
<li>
<p>The evaluator shall test the decrypt functionality using the same test as for encrypt, exchanging CT and PT and replacing AES-CBC-Encrypt with AES-CBC-Decrypt.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>AES-GCM Test</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="109">
<li>
<p>The evaluator shall test the authenticated encrypt functionality of AES-GCM for each combination of the following input parameter lengths:</p>
<div class="paragraph">
<p><strong><em>128 bit and 256 bit keys</em></strong></p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>Two plaintext lengths</strong>. One of the plaintext lengths shall be a non-zero integer multiple of 128 bits, if supported. The other plaintext length shall not be an integer multiple of 128 bits, if supported.</p>
</li>
<li>
<p><strong>Three AAD lengths</strong>. One AAD length shall be 0, if supported. One AAD length shall be a non-zero integer multiple of 128 bits, if supported. One AAD length shall not be an integer multiple of 128 bits, if supported.</p>
</li>
<li>
<p><strong>Two IV lengths</strong>. If 96 bit IV is supported, 96 bits shall be one of the two IV lengths tested.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="110">
<li>
<p>The evaluator shall test the encrypt functionality using a set of 10 key, plaintext, AAD, and IV tuples for each combination of parameter lengths above and obtain the ciphertext value and tag that results from AES-GCM authenticated encrypt. Each supported tag length shall be tested at least once per set of 10. The IV value may be supplied by the evaluator or the implementation being tested, as long as it is known.</p>
</li>
<li>
<p>The evaluator shall test the decrypt functionality using a set of 10 key, ciphertext, tag, AAD, and IV 5-tuples for each combination of parameter lengths above and obtain a Pass/Fail result on authentication and the decrypted plaintext if Pass. The set shall include five tuples that Pass and five that Fail.</p>
</li>
<li>
<p>The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>AES-CTR Known Answer Tests</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="113">
<li>
<p>The Counter (CTR) mode is a confidentiality mode that features the application of the forward cipher to a set of input blocks, called counters, to produce a sequence of output blocks that are exclusive-ORed with the plaintext to produce the ciphertext, and vice versa. Since the Counter Mode does not specify the counter that is used, it is not possible to implement an automated test for this mode. The generation and management of the counter is tested if the TSF is validated against the requirements of the Functional Package for Secure Shell referenced in section 2.2 of the cPP. If CBC and/or GCM are selected in FCS_COP.1/DataEncryption, the test activities for those modes sufficiently demonstrate the correctness of the AES algorithm. If CTR is the only selection in FCS_COP.1/DataEncryption, the AES-CBC Known Answer Test, AES-GCM Known Answer Test, or the following test shall be performed (all of these tests demonstrate the correctness of the AES algorithm):</p>
</li>
<li>
<p>There are four Known Answer Tests (KATs) described below to test a basic AES encryption operation (AES-ECB mode). For all KATs, the plaintext,<del>IV</del>, and ciphertext values shall be 128-bit blocks. The results from each test may either be obtained by the validator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation.</p>
</li>
<li>
<p><strong>KAT-1</strong> To test the encrypt functionality, the evaluator shall supply a set of 5 plaintext values for each selected keysize and obtain the ciphertext value that results from encryption of the given plaintext using a key value of all zeros.</p>
</li>
<li>
<p><strong>KAT-2</strong> To test the encrypt functionality, the evaluator shall supply a set of 5 key values for each selected keysize and obtain the ciphertext value that results from encryption of an all zeros plaintext using the given key value.</p>
</li>
<li>
<p><strong>KAT-3</strong> To test the encrypt functionality, the evaluator shall supply a set of key values for each selected keysize as described below and obtain the ciphertext values that result from AES encryption of an all zeros plaintext using the given key values. A set of 128 128-bit keys, a set of 192 192-bit keys, and/or a set of 256 256-bit keys. Key_i in each set shall have the leftmost i bits be ones and the rightmost N-i bits be zeros, for i in [1, N].</p>
</li>
<li>
<p><strong>KAT-4</strong> To test the encrypt functionality, the evaluator shall supply the set of 128 plaintext values described below and obtain the ciphertext values that result from encryption of the given plaintext using each selected keysize with a key value of all zeros (e.g. 256 ciphertext values will be generated if 128 bits and 256 bits are selected and 384 ciphertext values will be generated if all keysizes are selected). Plaintext value i in each set shall have the leftmost bits be ones and the rightmost 128-i bits be zeros, for i in [1, 128].</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>AES-CTR Multi-Block Message Test</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="119">
<li>
<p>The evaluator shall test the encrypt functionality by encrypting an i-block message where 1 less-than i less-than-or-equal to 10 (test shall be performed using AES-ECB mode). For each i the evaluator shall choose a key and plaintext message of length i blocks and encrypt the message, using the mode to be tested, with the chosen key. The ciphertext shall be compared to the result of encrypting the same plaintext message with the same key using a known good implementation. The evaluator shall perform this test using each selected keysize.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>AES-CTR Monte-Carlo Test</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="120">
<li>
<p>The evaluator shall test the encrypt functionality using 100 plaintext/key pairs. The plaintext values shall be 128-bit blocks. For each pair, 1000 iterations shall be run as follows:</p>
<div class="paragraph">
<p># Input: PT, Key</p>
</div>
<div class="paragraph">
<p>for i = 1 to 1000:</p>
</div>
<div class="paragraph">
<p>CT[i] = AES-ECB-Encrypt(Key, PT) PT = CT[i]</p>
</div>
</li>
<li>
<p>The ciphertext computed in the 1000th iteration is the result for that trial. This result shall be compared to the result of running 1000 iterations with the same values using a known good implementation. The evaluator shall perform this test using each selected keysize.</p>
</li>
<li>
<p>There is no need to test the decryption engine.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1siggen_cryptographic_operation_signature_generation_and_verification">2.2.5. FCS_COP.1/SigGen Cryptographic Operation (Signature Generation and Verification</h4>
<div class="sect4">
<h5 id="_tss_7">2.2.5.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="123">
<li>
<p>The evaluator shall examine the TSS to determine that it specifies the cryptographic algorithm and key size supported by the TOE for signature services.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_7">2.2.5.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="124">
<li>
<p>The evaluator shall verify that the AGD guidance instructs the administrator how to configure the TOE to use the selected cryptographic algorithm and key size defined in the Security Target supported by the TOE for signature services.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_8">2.2.5.3. Tests</h5>
<div class="paragraph">
<p><strong>ECDSA Algorithm Tests</strong></p>
</div>
<div class="paragraph">
<p><strong><em>ECDSA FIPS 186-4 Signature Generation Test</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="125">
<li>
<p>For each supported NIST curve (i.e., P-256, P-384 and P-521) and SHA function pair, the evaluator shall generate 10 1024-bit long messages and obtain for each message a public key and the resulting signature values R and S. To determine correctness, the evaluator shall use the signature verification function of a known good implementation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>ECDSA FIPS 186-4 Signature Verification Test</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="126">
<li>
<p>For each supported NIST curve (i.e., P-256, P-384 and P-521) and SHA function pair, the evaluator shall generate a set of 10 1024-bit message, public key and signature tuples and modify one of the values (message, public key or signature) in five of the 10 tuples. The evaluator shall obtain in response a set of 10 PASS/FAIL values.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>EDDSA Algorithm Tests</strong></p>
</div>
<div class="paragraph">
<p><strong><em>EDDSA FIPS 186-5 Signature Generation Test</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="127">
<li>
<p>The evaluator shall use the Ed25519 curve and the SHA-512 function pair to generate signatures for 10, 1024-bit long messages, and obtain for each message, a public key and the resulting signature values R and S. To determine correctness, the evaluator shall use the signature verification function of a known good implementation.</p>
</li>
<li>
<p>The evaluator shall use the Ed25519 curve and the SHA-512 function pair to generate signatures for 10, 1024-bit long messages. The first of these 10 messages will be unique and the subsequent 9 messages shall be derived from the first message by flipping individual bits in the original message. For each of these messages, obtain a public key and the resulting signature values R and S. The evaluator shall verify that the resulting signature values are distinct. Furthermore, to determine correctness, the evaluator shall use the signature verification function of a known good implementation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>EDDSA FIPS 186-5 Signature Verification Test</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="129">
<li>
<p>The evaluator shall use the Ed25519 curve and the SHA-512 function to generate a set of 10 1024-bit messages, public key and signature tuples and modify one of the values (message, public key or signature) in five of the 10 tuples. The evaluator shall obtain in response a set of 10 PASS/FAIL values.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>RSA Signature Algorithm Tests</strong></p>
</div>
<div class="paragraph">
<p><strong><em>Signature Generation Test</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="130">
<li>
<p>The evaluator generates or obtains 10 messages for each modulus size/SHA combination supported by the TOE. The TOE generates and returns the corresponding signatures.</p>
</li>
<li>
<p>The evaluator shall verify the correctness of the TOE’s signature using a trusted reference implementation of the signature verification algorithm and the associated public keys to verify the signatures.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>Signature Verification Test</em></strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="132">
<li>
<p>For each modulus size/hash algorithm selected, the evaluator generates a modulus and three associated key pairs, (<em>d</em>, <em>e</em>). Each private key <em>d</em> is used to sign six pseudorandom messages each of 1024 bits using a trusted reference implementation of the signature generation algorithm. Some of the public keys, <em>e</em>, messages, or signatures are altered so that signature verification should fail. For both the set of original messages and the set of altered messages: the modulus, hash algorithm, public key <em>e</em> values, messages, and signatures are forwarded to the TOE, which then attempts to verify the signatures and returns the verification results.</p>
</li>
<li>
<p>The evaluator verifies that the TOE confirms correct signatures on the original messages and detects the errors introduced in the altered messages.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1hash_cryptographic_operation_hash_algorithm">2.2.6. FCS_COP.1/Hash Cryptographic Operation (Hash Algorithm)</h4>
<div class="sect4">
<h5 id="_tss_8">2.2.6.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="134">
<li>
<p>The evaluator shall check that the association of the hash function with other TSF cryptographic functions (for example, the digital signature verification function) is documented in the TSS.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_8">2.2.6.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="135">
<li>
<p>The evaluator checks the AGD documents to determine that any configuration that is required to configure the required hash sizes is present.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_9">2.2.6.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="136">
<li>
<p>The TSF hashing functions can be implemented in one of two modes. The first mode is the byte­oriented mode. In this mode the TSF only hashes messages that are an integral number of bytes in length; i.e., the length (in bits) of the message to be hashed is divisible by 8. The second mode is the bit­oriented mode. In this mode the TSF hashes messages of arbitrary length. As there are different tests for each mode, an indication is given in the following sections for the bit­oriented vs. the byte­oriented testmacs.</p>
</li>
<li>
<p>The evaluator shall perform all of the following tests for each hash algorithm implemented by the TSF and used to satisfy the requirements of this PP.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Short Messages Test- ­ Bit­-oriented Mode</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="138">
<li>
<p>The evaluators devise an input set consisting of m+1 messages, where m is the block length of the hash algorithm. The length of the messages range sequentially from 0 to m bits. The message text shall be pseudorandomly generated. The evaluators compute the message digest for each of the messages and ensure that the correct result is produced when the messages are provided to the TSF.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Short Messages Test- ­ Byte­-oriented Mode</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="139">
<li>
<p>The evaluators devise an input set consisting of m/8+1 messages, where m is the block length of the hash algorithm. The length of the messages range sequentially from 0 to m/8 bytes, with each message being an integral number of bytes. The message text shall be pseudorandomly generated. The evaluators compute the message digest for each of the messages and ensure that the correct result is produced when the messages are provided to the TSF.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Selected Long Messages Test- ­ Bit­-oriented Mode</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="140">
<li>
<p>The evaluators devise an input set consisting of m messages, where m is the block length of the hash algorithm (e.g. 512 bits for SHA-256). The length of the ith message is m + 99*i, where 1 ≤ i ≤ m. The message text shall be pseudorandomly generated. The evaluators compute the message digest for each of the messages and ensure that the correct result is produced when the messages are provided to the TSF.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Selected Long Messages Test- ­ Byte­-oriented Mode</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="141">
<li>
<p>The evaluators devise an input set consisting of m/8 messages, where m is the block length of the hash algorithm (e.g. 512 bits for SHA-256). The length of the ith message is m + 8*99*i, where 1 ≤ i ≤ m/8. The message text shall be pseudorandomly generated. The evaluators compute the message digest for each of the messages and ensure that the correct result is produced when the messages are provided to the TSF.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Pseudorandomly Generated Messages Test</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="142">
<li>
<p>This test is for byte­oriented implementations only. The evaluators randomly generate a seed that is n bits long, where n is the length of the message digest produced by the hash function to be tested. The evaluators then formulate a set of 100 messages and associated digests by following the algorithm provided in Figure 1 of [SHAVS]. The evaluators then ensure that the correct result is produced when the messages are provided to the TSF.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_cop_1keyedhash_cryptographic_operation_keyed_hash_algorithm">2.2.7. FCS_COP.1/KeyedHash Cryptographic Operation (Keyed Hash Algorithm)</h4>
<div class="sect4">
<h5 id="_tss_9">2.2.7.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="143">
<li>
<p>The evaluator shall examine the TSS to ensure that it specifies the following values used by the HMAC function: key length, hash function used, block size, and output MAC length used.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_9">2.2.7.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="144">
<li>
<p>The evaluator shall verify that the AGD guidance instructs the administrator how to configure the TOE to use the values used by the HMAC function: key length, hash function used, block size, and output MAC length used defined in the Security Target supported by the TOE for keyed hash function.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_10">2.2.7.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="145">
<li>
<p>For each of the supported parameter sets, the evaluator shall compose 15 sets of test data. Each set shall consist of a key and message data. The evaluator shall have the TSF generate HMAC tags for these sets of test data. The resulting MAC tags shall be compared to the result of generating HMAC tags with the same key and message data using a known good implementation.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_rbg_ext_1_extended_cryptographic_operation_random_bit_generation">2.2.8. FCS_RBG_EXT.1 Extended: Cryptographic Operation (Random Bit Generation)</h4>
<div class="olist arabic">
<ol class="arabic" start="146">
<li>
<p>Documentation shall be produced—and the evaluator shall perform the activities—in accordance with Appendix D of [NDcPP].</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_tss_10">2.2.8.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="147">
<li>
<p>The evaluator shall examine the TSS to determine that it specifies the DRBG type, identifies the entropy source(s) seeding the DRBG, and state the assumed or calculated min-entropy supplied either separately by each source or the min-entropy contained in the combined seed value.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_10">2.2.8.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="148">
<li>
<p>The evaluator shall confirm that the guidance documentation contains appropriate instructions for configuring the RNG functionality.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_11">2.2.8.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="149">
<li>
<p>The evaluator shall perform 15 trials for the RNG implementation. If the RNG is configurable, the evaluator shall perform 15 trials for each configuration.</p>
</li>
<li>
<p>If the RNG has prediction resistance enabled, each trial consists of (1) instantiate DRBG, (2) generate the first block of random bits (3) generate a second block of random bits (4) uninstantiate. The evaluator verifies that the second block of random bits is the expected value. The evaluator shall generate eight input values for each trial. The first is a count (0 – 14). The next three are entropy input, nonce, and personalization string for the instantiate operation. The next two are additional input and entropy input for the first call to generate. The final two are additional input and entropy input for the second call to generate. These values are randomly generated. “generate one block of random bits” means to generate random bits with number of returned bits equal to the Output Block Length (as defined in NIST SP800-90A).</p>
</li>
<li>
<p>If the RNG does not have prediction resistance, each trial consists of (1) instantiate DRBG, (2) generate the first block of random bits (3) reseed, (4) generate a second block of random bits (5) uninstantiate. The evaluator verifies that the second block of random bits is the expected value. The evaluator shall generate eight input values for each trial. The first is a count (0 – 14). The next three are entropy input, nonce, and personalization string for the instantiate operation. The fifth value is additional input to the first call to generate. The sixth and seventh are additional input and entropy input to the call to reseed. The final value is additional input to the second generate call.</p>
</li>
<li>
<p>The following paragraphs contain more information on some of the input values to be generated/selected by the evaluator.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Entropy input:</strong> the length of the entropy input value must equal the seed length.</p>
</li>
<li>
<p><strong>Nonce:</strong> If a nonce is supported (CTR_DRBG with no Derivation Function does not use a nonce), the nonce bit length is one-half the seed length.</p>
</li>
<li>
<p><strong>Personalization string:</strong> The length of the personalization string must be &#8656; seed length. If the implementation only supports one personalization string length, then the same length can be used for both values. If more than one string length is support, the evaluator shall use personalization strings of two different lengths. If the implementation does not use a personalization string, no value needs to be supplied.</p>
</li>
<li>
<p><strong>Additional input:</strong> the additional input bit lengths have the same defaults and restrictions as the personalization string lengths.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_identification_and_authentication_fia">2.3. Identification and Authentication (FIA)</h3>
<div class="sect3">
<h4 id="_fia_uia_ext_1_user_identification_and_authentication">2.3.1. FIA_UIA_EXT.1 User Identification and Authentication</h4>
<div class="sect4">
<h5 id="_tss_11">2.3.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="153">
<li>
<p>The evaluator shall examine the TSS to determine that it describes the logon process for remote authentication mechanism (e.g. SSH public key, Web GUI password, etc.) and optional local authentication mechanisms supported by the TOE. This description shall contain information pertaining to the credentials allowed/used, any protocol transactions that take place, and what constitutes a “successful logon”.</p>
</li>
<li>
<p>The evaluator shall examine the TSS to determine that it describes which actions are allowed before administrator identification and authentication. The description shall cover authentication and identification for local and remote TOE administration.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall examine that the TSS details how Security Administrators are authenticated and identified by all TOE components. If not, all TOE components support authentication of Security Administrators according to FIA_UIA_EXT.1, the TSS shall describe how the overall TOE functionality is split between TOE components including how it is ensured that no unauthorized access to any TOE component can occur.</p>
</li>
<li>
<p>For distributed TOEs, the evaluator shall examine the TSS to determine that it describes for each TOE component which actions are allowed before administrator identification and authentication. The description shall cover authentication and identification for remote TOE administration and optionally for local TOE administration if claimed by the ST author. For each TOE component that does not support authentication of Security Administrators according to FIA_UIA_EXT.1 the TSS shall describe any unauthenticated services/services that are supported by the component.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_11">2.3.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="157">
<li>
<p>The evaluator shall examine the guidance documentation to determine that any necessary preparatory steps (e.g., establishing credential material such as pre- shared keys, tunnels, certificates, etc.) to logging in are described. For each supported the login method, the evaluator shall ensure the guidance documentation provides clear instructions for successfully logging on. If configuration is necessary to ensure the services provided before login are limited, the evaluator shall determine that the guidance documentation provides sufficient instruction on limiting the allowed services.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_12">2.3.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="158">
<li>
<p>The evaluator shall perform the following tests for each method by which administrators access the TOE (local and remote), as well as for each type of credential supported by the login method:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall use the guidance documentation to configure the appropriate credential supported for the login method. For all combinations of supported credentials and login methods, the evaluator shall show that providing correct I&amp;A information results in the ability to access the system, while providing incorrect information results in denial of access.</p>
</li>
<li>
<p>Test 2: The evaluator shall configure the services allowed (if any) according to the guidance documentation, and then determine the services available to an external remote entity. The evaluator shall determine that the list of services available is limited to those specified in the requirement.</p>
</li>
<li>
<p>Test 3: For local access, the evaluator shall determine what services are available to a local administrator prior to logging in, and make sure this list is consistent with the requirement.</p>
</li>
<li>
<p>Test 4: For distributed TOEs where not all TOE components support the authentication of Security Administrators according to FIA_UIA_EXT.1, the evaluator shall test that the components authenticate Security Administrators as described in the TSS.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security_management_fmt">2.4. Security management (FMT)</h3>
<div class="sect3">
<h4 id="_general_requirements_for_distributed_toes">2.4.1. General requirements for distributed TOEs</h4>
<div class="sect4">
<h5 id="_tss_12">2.4.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="159">
<li>
<p>For distributed TOEs, the evaluator shall verify that the TSS describes how every function related to security management is realized for every TOE component and shared between different TOE components. The evaluator shall confirm that all relevant aspects of each TOE component are covered by the FMT SFRs.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_12">2.4.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="160">
<li>
<p>For distributed TOEs, the evaluator shall verify that the Guidance Documentation to describe management of each TOE component. The evaluator shall confirm that all relevant aspects of each TOE component are covered by the FMT SFRs.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_13">2.4.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="161">
<li>
<p>Tests defined to verify the correct implementation of security management functions shall be performed for every TOE component. For security management functions that are implemented centrally, sampling should be applied when defining the evaluator’s tests (ensuring that all components are covered by the sample).</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_mof_1manualupdate">2.4.2. FMT_MOF.1/ManualUpdate</h4>
<div class="sect4">
<h5 id="_tss_13">2.4.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="162">
<li>
<p>For distributed TOEs see chapter 2.4.1.1. There are no specific requirements for non-distributed TOEs.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_13">2.4.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="163">
<li>
<p>The evaluator shall examine the guidance documentation to determine that any necessary steps to perform manual update are described. The guidance documentation shall also provide warnings regarding functions that may cease to operate during the update (if applicable).</p>
</li>
<li>
<p>For distributed TOEs the guidance documentation shall describe all steps how to update all TOE components. This shall contain description of the order in which components need to be updated if the order is relevant to the update process. The guidance documentation shall also provide warnings regarding functions of TOE components and the overall TOE that may cease to operate during the update (if applicable).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_14">2.4.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="165">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall try to perform the update using a legitimate update image without prior authentication as Security Administrator (either by authentication as a user with no administrator privileges or without user authentication at all – depending on the configuration of the TOE). The attempt to update the TOE shall fail.</p>
</li>
<li>
<p>Test 2: The evaluator shall try to perform the update with prior authentication as Security Administrator using a legitimate update image. This attempt should be successful. This test case should be covered by the tests for FPT_TUD_EXT.1 already.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_mtd_1coredata_management_of_tsf_data">2.4.3. FMT_MTD.1/CoreData Management of TSF Data</h4>
<div class="sect4">
<h5 id="_tss_14">2.4.3.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="166">
<li>
<p>For each administrative function identified in the guidance documentation that is accessible through an interface prior to administrator log-in, the evaluator shall confirm that the TSS details how the ability to manipulate the TSF data through these interfaces is disallowed for non-administrative users.</p>
</li>
<li>
<p>If the TOE supports handling of X.509v3 certificates and implements a trust store, the evaluator shall examine the TSS to determine that it contains sufficient information to describe how the ability to manage the TOE’s trust store is restricted.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_14">2.4.3.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="168">
<li>
<p>The evaluator shall review the guidance documentation to determine that each of the TSF-data-manipulating functions implemented in response to the requirements of the cPP is identified, and that configuration information is provided to ensure that only administrators have access to the functions.</p>
</li>
<li>
<p>If the TOE supports handling of X.509v3 certificates and provides a trust store, the evaluator shall review the guidance documentation to determine that it provides sufficient information for the administrator to configure and maintain the trust store in a secure way. If the TOE supports loading of CA certificates, the evaluator shall review the guidance documentation to determine that it provides sufficient information for the administrator to securely load CA certificates into the trust store. The evaluator shall also review the guidance documentation to determine that it explains how to designate a CA certificate a trust anchor.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_15">2.4.3.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="170">
<li>
<p>No separate testing for FMT_MTD.1/CoreData is required unless one of the management functions has not already been exercised under any other SFR.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_smf_1_specification_of_management_functions">2.4.4. FMT_SMF.1 Specification of Management Functions</h4>
<div class="olist arabic">
<ol class="arabic" start="171">
<li>
<p>The security management functions for FMT_SMF.1 are distributed throughout the cPP and are included as part of the requirements in FTA_SSL_EXT.1, FTA_SSL.3, FTA_TAB.1, FMT_MOF.1/ManualUpdate, FMT_MOF.1/AutoUpdate (if included in the ST), FIA_AFL.1, FIA_X509_EXT.2.2 (if included in the ST), FPT_TUD_EXT.1.2 &amp; FPT_TUD_EXT.2.2 (if included in the ST and if they include an administrator-configurable action), FMT_MOF.1/Services, and FMT_MOF.1/Functions (for all of these SFRs that are included in the ST), FMT_MTD, FPT_TST_EXT, and any cryptographic management functions specified in the reference standards. Compliance to these requirements satisfies compliance with FMT_SMF.1.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_tss_containing_also_requirements_on_guidance_documentation_and_tests">2.4.4.1. TSS (containing also requirements on Guidance Documentation and Tests)</h5>
<div class="olist arabic">
<ol class="arabic" start="172">
<li>
<p>The evaluator shall examine the TSS, Guidance Documentation and the TOE as observed during all other testing and shall confirm that the management functions specified in FMT_SMF.1 are provided by the TOE. The evaluator shall confirm that the TSS details which security management functions are available through which interface(s) (local administration interface, remote administration interface).</p>
</li>
<li>
<p>The evaluator shall examine the TSS and Guidance Documentation to verify they both describe the local administrative interface. The evaluator shall ensure the Guidance Documentation includes appropriate warnings for the administrator to ensure the interface is local.</p>
</li>
<li>
<p>For distributed TOEs with the option 'ability to configure the interaction between TOE components' the evaluator shall examine that the ways to configure the interaction between TOE components is detailed in the TSS and Guidance Documentation. The evaluator shall check that the TOE behaviour observed during testing of the configured SFRs is as described in the TSS and Guidance Documentation.</p>
</li>
<li>
<p>(If configure local audit is selected) The evaluator shall examine the TSS and Guidance Documentation to ensure that a description of the logging implementation is described in enough detail to determine how log files are maintained on the TOE.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_15">2.4.4.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="176">
<li>
<p>See section 2.4.4.1.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_16">2.4.4.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="177">
<li>
<p>The evaluator tests management functions as part of testing the SFRs identified in section 2.4.4. No separate testing for FMT_SMF.1 is required unless one of the management functions in FMT_SMF.1.1 has not already been exercised under any other SFR.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_smr_2_restrictions_on_security_roles">2.4.5. FMT_SMR.2 Restrictions on security roles</h4>
<div class="sect4">
<h5 id="_tss_15">2.4.5.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="178">
<li>
<p>The evaluator shall examine the TSS to determine that it details the TOE supported roles and any restrictions of the roles involving administration of the TOE (e.g. if local administrators and remote administrators have different privileges or if several types of administrators with different privileges are supported by the TOE).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_16">2.4.5.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="179">
<li>
<p>The evaluator shall review the guidance documentation to ensure that it contains instructions for administering the TOE both locally and remotely, including any configuration that needs to be performed on the client for remote administration.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_17">2.4.5.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="180">
<li>
<p>In the course of performing the testing activities for the evaluation, the evaluator shall use all supported interfaces, although it is not necessary to repeat each test involving an administrative action with each interface. The evaluator shall ensure, however, that each supported method of administering the TOE that conforms to the requirements of this cPP be tested; for instance, if the TOE can be administered through a local hardware interface; SSH, if the TSF shall be validated against the Functional Package for Secure Shell referenced in section 2.2 of the cPP; and TLS/HTTPS; then all three methods of administration must be exercised during the evaluation team’s test activities.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_protection_of_the_tsf_fpt">2.5. Protection of the TSF (FPT)</h3>
<div class="sect3">
<h4 id="_fpt_skp_ext_1_protection_of_tsf_data_for_reading_of_all_pre_shared_symmetric_and_private_keys">2.5.1. FPT_SKP_EXT.1 Protection of TSF Data (for reading of all pre-shared, symmetric and private keys)</h4>
<div class="sect4">
<h5 id="_tss_16">2.5.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="181">
<li>
<p>The evaluator shall examine the TSS to determine that it details how any preshared keys, symmetric keys, and private keys are stored and that they are unable to be viewed through any interface designed specifically for that purpose, by any enabled role, as outlined in the application note. If these values are not stored in plaintext, the TSS shall describe how they are protected/obscured.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fpt_tst_ext_1_tsf_testing">2.5.2. FPT_TST_EXT.1 TSF testing</h4>
<div class="sect4">
<h5 id="_tss_17">2.5.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="182">
<li>
<p>The evaluator shall examine the TSS to ensure that it details the self-tests that are run by the TSF; this description should include an outline of what the tests are actually doing (e.g., rather than saying "memory is tested", a description similar to "memory is tested by writing a value to each memory location and reading it back to ensure it is identical to what was written" shall be used). The evaluator shall ensure that the TSS makes an argument that the tests are sufficient to demonstrate that the TSF is operating correctly.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall examine the TSS to ensure that it details which TOE component performs which self-tests and when these self-tests are run. The evaluator shall also examine the TSS to ensure it describes how the TOE reacts if one or more TOE components fail self-testing (e.g. halting and displaying an error message; failover behaviour).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_17">2.5.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="184">
<li>
<p>The evaluator shall also ensure that the guidance documentation describes the possible errors that may result from such tests, and actions the administrator should take in response; these possible errors shall correspond to those described in the TSS.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall ensure that the guidance documentation describes how to determine from an error message returned which TOE component has failed the self-test.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_18">2.5.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="186">
<li>
<p>It is expected that at least the following tests are performed:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Verification of the integrity of the firmware and executable software of the TOE</p>
</li>
<li>
<p>Verification of the correct operation of the cryptographic functions necessary to fulfil any of the SFRs.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="187">
<li>
<p>Although formal compliance is not mandated, the self-tests performed should aim for a level of confidence comparable to:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>[FIPS 140-2], chap. 4.9.1, Software/firmware integrity test for the verification of the integrity of the firmware and executable software. Note that the testing is not restricted to the cryptographic functions of the TOE.</p>
</li>
<li>
<p>[FIPS 140-2], chap. 4.9.1, Cryptographic algorithm test for the verification of the correct operation of cryptographic functions. Alternatively, national requirements of any CCRA member state for the security evaluation of cryptographic functions should be considered as appropriate.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="188">
<li>
<p>The evaluator shall either verify that the self-tests described above are carried out during initial start-up or that the developer has justified any deviation from this.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall perform testing of self-tests on all TOE components according to the description in the TSS about which self-test are performed by which component.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fpt_tud_ext_1_trusted_update">2.5.3. FPT_TUD_EXT.1 Trusted Update</h4>
<div class="sect4">
<h5 id="_tss_18">2.5.3.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="190">
<li>
<p>The evaluator shall verify that the TSS describe how to query the currently active version. If a trusted update can be installed on the TOE with a delayed activation, the TSS needs to describe how and when the inactive version becomes active. The evaluator shall verify this description.</p>
</li>
<li>
<p>The evaluator shall verify that the TSS describes all TSF software update mechanisms for updating the system firmware and software (for simplicity the term 'software' will be used in the following although the requirements apply to firmware and software). The evaluator shall verify that the description includes a digital signature verification of the software before installation and that installation fails if the verification fails. The evaluator shall verify that the TSS describes the method by which the digital signature is verified to include how the candidate updates are obtained, the processing associated with verifying the digital signature of the update, and the actions that take place for both successful and unsuccessful signature verification.</p>
</li>
<li>
<p>If the options ‘support automatic checking for updates’ or ‘support automatic updates’ are chosen from the selection in FPT_TUD_EXT.1.2, the evaluator shall verify that the TSS explains what actions are involved in automatic checking or automatic updating by the TOE, respectively.</p>
</li>
<li>
<p>For distributed TOEs, the evaluator shall examine the TSS to ensure that it describes how all TOE components are updated, that it describes all mechanisms that support continuous proper functioning of the TOE during update (when applying updates separately to individual TOE components) and how verification of the signature or checksum is performed for each TOE component. Alternatively, this description can be provided in the guidance documentation. In that case the evaluator should examine the guidance documentation instead.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_18">2.5.3.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="194">
<li>
<p>The evaluator shall verify that the guidance documentation describes how to query the currently active version. If a trusted update can be installed on the TOE with a delayed activation, the guidance documentation needs to describe how to query the loaded but inactive version.</p>
</li>
<li>
<p>The evaluator shall verify that the guidance documentation describes how the verification of the authenticity of the update is performed (digital signature verification). The description shall include the procedures for successful and unsuccessful verification. The description shall correspond to the description in the TSS.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall verify that the guidance documentation describes how the versions of individual TOE components are determined for FPT_TUD_EXT.1, how all TOE components are updated, and the error conditions that may arise from checking or applying the update (e.g. failure of signature verification, or exceeding available storage space) along with appropriate recovery actions. The guidance documentation only has to describe the procedures relevant for the Security Administrator; it does not need to give information about the internal communication that takes place when applying updates.</p>
</li>
<li>
<p>If this was information was not provided in the TSS: For distributed TOEs, the evaluator shall examine the Guidance Documentation to ensure that it describes how all TOE components are updated, that it describes all mechanisms that support continuous proper functioning of the TOE during update (when applying updates separately to individual TOE components) and how verification of the signature or checksum is performed for each TOE component.</p>
</li>
<li>
<p>If this was information was not provided in the TSS: If the ST author indicates that a certificate-based mechanism is used for software update digital signature verification, the evaluator shall verify that the Guidance Documentation contains a description of how the certificates are contained on the device. The evaluator also ensures that the Guidance Documentation describes how the certificates are installed/updated/selected, if necessary.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_19">2.5.3.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="199">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall perform the version verification activity to determine the current version of the product. If a trusted update can be installed on the TOE with a delayed activation, the evaluator shall also query the most recently installed version (for this test the TOE shall be in a state where these two versions match). The evaluator obtains a legitimate update using procedures described in the guidance documentation and verifies that it is successfully installed on the TOE. For some TOEs loading the update onto the TOE and activation of the update are separate steps (‘activation’ could be performed e.g. by a distinct activation step or by rebooting the device). In that case the evaluator verifies after loading the update onto the TOE but before activation of the update that the current version of the product did not change but the most recently installed version has changed to the new product version. After the update, the evaluator shall perform the version verification activity again to verify the version correctly corresponds to that of the update and that current version of the product and most recently installed version match again.</p>
</li>
<li>
<p>Test 2 [conditional]: If the TOE itself verifies a digital signature to authorize the installation of an image to update the TOE the following test shall be performed (otherwise the test shall be omitted). The evaluator first confirms that no updates are pending and then performs the version verification activity to determine the current version of the product, verifying that it is different from the version claimed in the update(s) to be used in this test. The evaluator obtains or produces illegitimate updates as defined below and attempts to install them on the TOE. The evaluator verifies that the TOE rejects all of the illegitimate updates. The evaluator shall perform this test using all of the following forms of illegitimate updates:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>A modified version (e.g. using a hex editor) of a legitimately signed update</p>
</li>
<li>
<p>An image that has not been signed</p>
</li>
<li>
<p>An image signed with an invalid signature (e.g. by using a different key as expected for creating the signature or by manual modification of a legitimate signature)</p>
</li>
<li>
<p>The handling of version information of the most recently installed version might differ between different TOEs depending on the point in time when an attempted update is rejected. The evaluator shall verify that the TOE handles the most recently installed version information for that case as described in the guidance documentation. After the TOE has rejected the update the evaluator shall verify, that both, current version and most recently installed version, reflect the same version information as prior to the update attempt.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>The evaluator shall perform Test 1 and Test 2  for all methods supported (manual updates, automatic checking for updates, automatic updates).</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall perform Test 1 and Test 2 for all TOE components.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fpt_stm_ext_1_reliable_time_stamps">2.5.4. FPT_STM_EXT.1 Reliable Time Stamps</h4>
<div class="sect4">
<h5 id="_tss_19">2.5.4.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="202">
<li>
<p>The evaluator shall examine the TSS to ensure that it lists each security function that makes use of time, and that it provides a description of how the time is maintained and considered reliable in the context of each of the time related functions.</p>
</li>
<li>
<p>If “obtain time from the underlying virtualization system” is selected, the evaluator shall examine the TSS to ensure that it identifies the VS interface the TOE uses to obtain time. If there is a delay between updates to the time on the VS and updating the time on the TOE, the TSS shall identify the maximum possible delay.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_19">2.5.4.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="204">
<li>
<p>The evaluator examines the guidance documentation to ensure it instructs the administrator how to set the time. If the TOE supports the use of an NTP server, the guidance documentation instructs how a communication path is established between the TOE and the NTP server, and any configuration of the NTP client on the TOE to support this communication.</p>
</li>
<li>
<p>If the TOE supports obtaining time from the underlying VS, the evaluator shall verify the Guidance Documentation specifies any configuration steps necessary. If no configuration is necessary, no statement is necessary in the Guidance Documentation. If there is a delay between updates to the time on the VS and updating the time on the TOE, the evaluator shall ensure the Guidance Documentation informs the administrator of the maximum possible delay.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_20">2.5.4.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="206">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: If the TOE supports direct setting of the time by the Security Administrator then the evaluator uses the guidance documentation to set the time. The evaluator shall then use an available interface to observe that the time was set correctly.</p>
</li>
<li>
<p>Test 2: If the TOE supports the use of an NTP server; the evaluator shall use the guidance documentation to configure the NTP client on the TOE and set up a communication path with the NTP server. The evaluator will observe that the NTP server has set the time to what is expected. If the TOE supports multiple protocols for establishing a connection with the NTP server, the evaluator shall perform this test using each supported protocol claimed in the guidance documentation.</p>
</li>
<li>
<p>Test 3 [conditional]: If the TOE obtains time from the underlying VS, the evaluator shall record the time on the TOE, modify the time on the underlying VS, and verify the modified time is reflected by the TOE. If there is a delay between the setting the time on the VS and when the time is reflected on the TOE, the evaluator shall ensure this delay is consistent with the TSS and Guidance.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="207">
<li>
<p>If the audit component of the TOE consists of several parts with independent time information, then the evaluator shall verify that the time information between the different parts are either synchronized or that it is possible for all audit information to relate the time information of the different part to one base information unambiguously.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_toe_access_fta">2.6. TOE Access (FTA)</h3>
<div class="sect3">
<h4 id="_fta_ssl_3_tsf_initiated_termination">2.6.1. FTA_SSL.3 TSF-initiated Termination</h4>
<div class="sect4">
<h5 id="_tss_20">2.6.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="208">
<li>
<p>The evaluator shall examine the TSS to determine that it details the administrative remote session termination and the related inactivity time period.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_20">2.6.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="209">
<li>
<p>The evaluator shall confirm that the guidance documentation includes instructions for configuring the inactivity time period for remote administrative session termination.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_21">2.6.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="210">
<li>
<p>For each method of remote administration, the evaluator shall perform the following test:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator follows the guidance documentation to configure several different values for the inactivity time period referenced in the component. For each period configured, the evaluator establishes a remote interactive session with the TOE. The evaluator then observes that the session is terminated after the configured time period.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fta_ssl_4_user_initiated_termination">2.6.2. FTA_SSL.4 User-initiated Termination</h4>
<div class="sect4">
<h5 id="_tss_21">2.6.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="211">
<li>
<p>The evaluator shall examine the TSS to determine that it details how the remote administrative session (and if applicable the local administrative session) are terminated.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_21">2.6.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="212">
<li>
<p>The evaluator shall confirm that the guidance documentation states how to terminate a remote interactive session (and if applicable the local administrative session).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_22">2.6.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="213">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1 [conditional]: If the TOE supports local administration, the evaluator initiates an interactive local session with the TOE. The evaluator then follows the guidance documentation to exit or log off the session and observes that the session has been terminated.</p>
</li>
<li>
<p>Test 2: For each method of remote administration, the evaluator initiates an interactive remote session with the TOE. The evaluator then follows the guidance documentation to exit or log off the session and observes that the session has been terminated.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fta_tab_1_default_toe_access_banners">2.6.3. FTA_TAB.1 Default TOE Access Banners</h4>
<div class="sect4">
<h5 id="_tss_22">2.6.3.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="214">
<li>
<p>The evaluator shall check the TSS to ensure that it details each administrative method of access (local and/or remote) available to the Security Administrator (e.g. serial port, SSH, HTTPS). The evaluator shall check the TSS to ensure that all administrative methods of access available to the Security Administrator are listed and that the TSS states that the TOE is displaying an advisory notice and a consent warning message for each administrative method of access. The advisory notice and the consent warning message might be different for different administrative methods of access and might be configured during initial configuration (e.g. via configuration file).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_22">2.6.3.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="215">
<li>
<p>The evaluator shall check the guidance documentation to ensure that it describes how to configure the banner message.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_23">2.6.3.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="216">
<li>
<p>The evaluator shall also perform the following test:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator follows the guidance documentation to configure a notice and consent warning message. The evaluator shall then, for each method of access specified in the TSS, establish a session with the TOE. The evaluator shall verify that the notice and consent warning message is displayed in each instance.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_trusted_pathchannels_ftp">2.7. Trusted path/channels (FTP)</h3>
<div class="sect3">
<h4 id="_ftp_itc_1_inter_tsf_trusted_channel">2.7.1. FTP_ITC.1 Inter-TSF trusted channel</h4>
<div class="sect4">
<h5 id="_tss_23">2.7.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="217">
<li>
<p>The evaluator shall examine the TSS to determine that, for all communications with authorized IT entities identified in the requirement, each secure communication mechanism is identified in terms of the allowed protocols for that IT entity, whether the TOE acts as a server or a client, and the method of assured identification of the non-TSF endpoint. The evaluator shall also confirm that all secure communication mechanisms are described in sufficient detail to allow the evaluator to match them to the cryptographic protocol Security Functional Requirements listed in the ST.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_23">2.7.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="218">
<li>
<p>The evaluator shall confirm that the guidance documentation contains instructions for establishing the allowed protocols with each authorized IT entity, and that it contains recovery instructions should a connection be unintentionally broken.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_24">2.7.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="219">
<li>
<p>The developer shall provide to the evaluator application layer configuration settings for all secure communication mechanisms specified by the FTP_ITC.1 requirement. This information should be sufficiently detailed to allow the evaluator to determine the application layer timeout settings for each cryptographic protocol. There is no expectation that this information must be recorded in any public-facing document or report.</p>
</li>
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluators shall ensure that communications using each protocol with each authorized IT entity is tested during the course of the evaluation, setting up the connections as described in the guidance documentation and ensuring that communication is successful.</p>
</li>
<li>
<p>Test 2: For each protocol that the TOE can initiate as defined in the requirement, the evaluator shall follow the guidance documentation to ensure that in fact the communication channel can be initiated from the TOE.</p>
</li>
<li>
<p>Test 3: The evaluator shall ensure, for each communication channel with an authorized IT entity, the channel data is not sent in plaintext.</p>
</li>
<li>
<p>Test 4: Objective: The objective of this test is to ensure that the TOE reacts appropriately to any connection outage or interruption of the route to the external IT entities.</p>
<div class="paragraph">
<p>The evaluator shall, for each instance where the TOE acts as a client utilizing a secure communication mechanism with a distinct IT entity, physically interrupt the connection of that IT entity for the following durations: i) a duration that exceeds the TOE’s application layer timeout setting, ii) a duration shorter than the application layer timeout but of sufficient length to interrupt the network link layer.</p>
</div>
<div class="paragraph">
<p>The evaluator shall ensure that, when the physical connectivity is restored, communications are appropriately protected and no TSF data is sent in plaintext.</p>
</div>
<div class="paragraph">
<p>In the case where the TOE is able to detect when the cable is removed from the device, another physical network device (e.g. a core switch) shall be used to interrupt the connection between the TOE and the distinct IT entity. The interruption shall not be performed at the virtual node (e.g. virtual switch) and must be physical in nature.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="221">
<li>
<p>Further assurance activities are associated with the specific protocols.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall perform tests on all TOE components according to the mapping of external secure channels to TOE components in the Security Target.</p>
</li>
<li>
<p>The developer shall provide to the evaluator application layer configuration settings for all secure communication mechanisms specified by the FTP_ITC.1 requirement. This information should be sufficiently detailed to allow the evaluator to determine the application layer timeout settings for each cryptographic protocol. There is no expectation that this information must be recorded in any public- facing document or report.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ftp_trp_1admin_trusted_path">2.7.2. FTP_TRP.1/Admin Trusted Path</h4>
<div class="sect4">
<h5 id="_tss_24">2.7.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="224">
<li>
<p>The evaluator shall examine the TSS to determine that the methods of remote TOE administration are indicated, along with how those communications are protected. The evaluator shall also confirm that all protocols listed in the TSS in support of TOE administration are consistent with those specified in the requirement, and are included in the requirements in the ST.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_24">2.7.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="225">
<li>
<p>The evaluator shall confirm that the guidance documentation contains instructions for establishing the remote administrative sessions for each supported method.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_25">2.7.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="226">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluators shall ensure that communications using each specified (in the guidance documentation) remote administration method is tested during the course of the evaluation, setting up the connections as described in the guidance documentation and ensuring that communication is successful.</p>
</li>
<li>
<p>Test 2: The evaluator shall ensure, for each communication channel, the channel data is not sent in plaintext.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="227">
<li>
<p>Further assurance activities are associated with the specific protocols.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall perform tests on all TOE components according to the mapping of trusted paths to TOE components in the Security Target.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activities_for_optional_requirements">3. Evaluation Activities for Optional Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_security_audit_fau_2">3.1. Security Audit (FAU)</h3>
<div class="sect3">
<h4 id="_fau_stg_1_protected_audit_trail_storage">3.1.1. FAU_STG.1 Protected audit trail storage</h4>
<div class="sect4">
<h5 id="_tss_25">3.1.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="229">
<li>
<p>The evaluator shall examine the TSS to ensure it describes the amount of audit data that are stored locally and how these records are protected against unauthorized modification or deletion. The evaluator shall ensure that the TSS describes the conditions that must be met for authorized deletion of audit records.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall examine the TSS to ensure it describes to which TOE components this SFR applies and how local storage is implemented among the different TOE components (e.g. every TOE component does its own local storage or the data is sent to another TOE component for central local storage of all audit events).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_25">3.1.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="231">
<li>
<p>The evaluator shall examine the guidance documentation to determine that it describes any configuration required for protection of the locally stored audit data against unauthorized modification or deletion.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_26">3.1.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="232">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall attempt to access the audit trail without authentication as Security Administrator (either by authentication as a non-administrative user, if supported, or without authentication at all) and attempt to modify and delete the audit records. The evaluator shall verify that these attempts fail. According to the implementation no other users than the Security Administrator might be defined and without any user authentication the user might not be able to get to the point where the attempt to access the audit trail can be executed. In that case it shall be demonstrated that access control mechanisms prevent execution up to the step that can be reached without authentication as Security Administrator.</p>
</li>
<li>
<p>Test 2: The evaluator shall access the audit trail as an authenticated Security Administrator and attempt to delete the audit records (if supported by the TOE, and to the extent described in the TSS). The evaluator shall verify that these attempts succeed. The evaluator shall verify that only the records authorized for deletion are deleted.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="233">
<li>
<p>For distributed TOEs the evaluator shall perform test 1 and test 2 for each component that is defined by the TSS to be covered by this SFR.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fau_stg_ext_2_counting_lost_audit_data">3.1.2. FAU_STG_EXT.2 Counting lost audit data</h4>
<div class="olist arabic">
<ol class="arabic" start="234">
<li>
<p>This activity should be accomplished in conjunction with the testing of FAU_STG_EXT.1.4 and FAU_STG_EXT.1.5.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_tss_26">3.1.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="235">
<li>
<p>The evaluator shall examine the TSS to ensure that it details the possible options the TOE supports for information about the number of audit records that have been dropped, overwritten, etc. if the local storage for audit data is full.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall examine the TSS to ensure it describes to which TOE components this SFR applies. Since this SFR is optional, it might only apply to some TOE components but not all. This might lead to the situation where all TOE components store their audit information themselves but FAU_STG_EXT.2 is supported only by one of the components.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_26">3.1.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="237">
<li>
<p>The evaluator shall also ensure that the guidance documentation describes all possible configuration options and the meaning of the result returned by the TOE for each possible configuration. The description of possible configuration options and explanation of the result shall correspond to those described in the TSS.</p>
</li>
<li>
<p>The evaluator shall verify that the guidance documentation contains a warning for the administrator about the loss of audit data when clearing the local storage for audit records.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_27">3.1.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="239">
<li>
<p>The evaluator shall verify that the numbers provided by the TOE according to the selection for FAU_STG_EXT.2 are correct when performing the tests for FAU_STG_EXT.1.5.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall verify the correct implementation of counting of lost audit data for all TOE components that are supporting this feature according to the description in the TSS.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fau_stg_ext_3_action_in_case_of_possible_audit_data_loss">3.1.3. FAU_STG_EXT.3 Action in case of possible audit data loss</h4>
<div class="olist arabic">
<ol class="arabic" start="241">
<li>
<p>This activity should be accomplished in conjunction with the testing of FAU_STG_EXT.1.4 and FAU_STG_EXT.1.5.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_tss_27">3.1.3.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="242">
<li>
<p>The evaluator shall examine the TSS to ensure that it details how the Security Administrator is warned before the local storage for audit data is full.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall examine the TSS to ensure it describes to which TOE components this SFR applies and how each TOE component realises this SFR. Since this SFR is optional, it might only apply to some TOE components but not all. This might lead to the situation where all TOE components store their audit information themselves but FAU_STG_EXT.3 is supported only by one of the components. In particular, the evaluator has to verify, that the TSS describes for every component supporting this functionality, whether the warning is generated by the component itself or through another component and name the corresponding component in the latter case. The evaluator has to verify that the TSS makes clear any situations in which audit records might be 'invisibly lost'.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_27">3.1.3.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="244">
<li>
<p>The evaluator shall also ensure that the guidance documentation describes how the Security Administrator is warned before the local storage for audit data is full and how this warning is displayed or stored (since there is no guarantee that an administrator session is running at the time the warning is issued, it is probably stored in the log files). The description in the guidance documentation shall correspond to the description in the TSS.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_28">3.1.3.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="245">
<li>
<p>The evaluator shall verify that a warning is issued by the TOE before the local storage space for audit data is full.</p>
</li>
<li>
<p>For distributed TOEs the evaluator shall verify the correct implementation of display warning for local storage space for all TOE components that are supporting this feature according to the description in the TSS. The evaluator shall verify that each component that supports this feature according to the description in the TSS is capable of generating a warning itself or through another component.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_identification_and_authentication_fia_2">3.2. Identification and Authentication (FIA)</h3>
<div class="sect3">
<h4 id="_fia_x509_ext_1itt_x_509_certificate_validation">3.2.1. FIA_X509_EXT.1/ITT X.509 Certificate Validation</h4>
<div class="sect4">
<h5 id="_tss_28">3.2.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="247">
<li>
<p>The evaluator shall examine the TSS to ensure it describes where the check of validity of the certificates takes place, and that the TSS identifies any of the rules for extendedKeyUsage fields (in FIA_X509_EXT.1.1) that are not supported by the TOE (i.e. where the ST is therefore claiming that they are trivially satisfied).</p>
</li>
<li>
<p>If selected, the TSS shall describe how certificate revocation checking is performed. It is expected that either OCSP or CRL revocation checking is performed when a certificate is presented to the TOE (e.g. during authentication).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_28">3.2.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="249">
<li>
<p>The evaluator shall also ensure that the guidance documentation describes where the check of validity of the certificates takes place, describes any of the rules for extendedKeyUsage fields (in FIA_X509_EXT.1.1) that are not supported by the TOE (i.e. where the ST is therefore claiming that they are trivially satisfied) and describe how certificate revocation checking is performed.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_29">3.2.1.3. Tests</h5>
<div class="paragraph">
<p><strong>FIA_X509_EXT.1.1/ITT</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="250">
<li>
<p>The evaluator shall demonstrate that checking the validity of a certificate is performed when a certificate is used in an authentication step. It is not sufficient to verify the status of a X.509 certificate only when it is loaded onto the device. The evaluator shall perform the following tests for FIA_X509_EXT.1.1/ITT. These tests must be repeated for each distinct security function that utilizes X.509v3 certificates. For example, if the TOE implements certificate-based authentication with IPSEC and TLS, then it shall be tested with each of these protocols.:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1a: The evaluator shall present the TOE with a valid chain of certificates (terminating in a trusted CA certificate) as needed to validate the leaf certificate to be used in the function and shall use this chain to demonstrate that the function succeeds. Test 1a shall be designed in a way that the chain can be 'broken' in Test 1b by either being able to remove the trust anchor from the TOEs trust store, or by setting up the trust store in a way that at least one intermediate CA certificate needs to be provided, together with the leaf certificate from outside the TOE, to complete the chain (e.g. by storing only the root CA certificate in the trust store).</p>
<div class="paragraph">
<p>Test 1b: The evaluator shall then 'break' the chain used in Test 1a by either removing the trust anchor in the TOE&#8217;s trust store used to terminate the chain, or by removing one of the intermediate CA certificates (provided together with the leaf certificate in Test 1a) to complete the chain. The evaluator shall show that an attempt to validate this broken chain fails.</p>
</div>
</li>
<li>
<p>Test 2: The evaluator shall demonstrate that validating an expired certificate results in the function failing.</p>
</li>
<li>
<p>Test 3: The evaluator shall test that the TOE can properly handle revoked certificates-–depending on whether CRL or OCSP is selected; if both are selected, then a test shall be performed for each method. The evaluator shall test revocation of the TOE certificate and revocation of the TOE intermediate CA certificate i.e. the intermediate CA certificate should be revoked by the root CA. The evaluator shall ensure that a valid certificate is used, and that the validation function succeeds. The evaluator then attempts the test with a certificate that has been revoked (for each method chosen in the selection) to ensure when the certificate is no longer valid that the validation function fails. No testing is required if no revocation method is selected. Revocation checking is only applied to certificates that are not designated as trust anchors. Therefore, the revoked certificate(s) used for testing shall not be a trust anchor.</p>
</li>
<li>
<p>Test 4: If OCSP is selected, the evaluator shall configure the OCSP server or use a man-in-the-middle tool to present a certificate that does not have the OCSP signing purpose and verify that validation of the OCSP response fails. If CRL is selected, the evaluator shall configure the CA to sign a CRL with a certificate that does not have the cRLsign key usage bit set and verify that validation of the CRL fails.</p>
</li>
<li>
<p>Test 5: The evaluator shall modify any byte in the first eight bytes of the certificate and demonstrate that the certificate fails to validate. (The certificate will fail to parse correctly.)</p>
</li>
<li>
<p>Test 6: The evaluator shall modify any byte in the last byte of the certificate and demonstrate that the certificate fails to validate. (The signature on the certificate will not validate.)</p>
</li>
<li>
<p>Test 7: The evaluator shall modify any byte in the public key of the certificate and demonstrate that the certificate fails to validate. (The hash of the certificate will not validate.)</p>
</li>
<li>
<p>Test 8: (Conditional on support for EC certificates as indicated in FCS_COP.1/SigGen). The following tests are run when a minimum certificate path length of three certificates is implemented:</p>
<div class="paragraph">
<p>Test 8a: (Conditional on TOE ability to process CA certificates presented in certificate message) The test shall be designed in a way such that only the EC root certificate is designated as a trust anchor, and by setting up the trust store in a way that the EC Intermediate CA certificate needs to be provided, together with the leaf certificate, from outside the TOE to complete the chain (e.g. by storing only the EC root CA certificate in the trust store). The evaluator shall present the TOE with a valid chain of EC certificates (terminating in a trusted CA certificate), where the elliptic curve parameters are specified as a named curve. The evaluator shall confirm that the TOE validates the certificate chain.</p>
</div>
<div class="paragraph">
<p>Test 8b: (Conditional on TOE ability to process CA certificates presented in certificate message) The test shall be designed in a way such that only the EC root certificate is designated as a trust anchor, and by setting up the trust store in a way that the EC Intermediate CA certificate needs to be provided, together with the leaf certificate, from outside the TOE to complete the chain (e.g. by storing only the EC root CA certificate in the trust store). The evaluator shall present the TOE with a chain of EC certificates (terminating in a trusted CA certificate), where the intermediate certificate in the certificate chain uses an explicit format version of the Elliptic Curve parameters in the public key information field, and is signed by the trusted EC root CA, but having no other changes. The evaluator shall confirm the TOE treats the certificate as invalid.</p>
</div>
<div class="paragraph">
<p>Test 8c: The evaluator shall establish a subordinate CA certificate, where the elliptic curve parameters are specified as a named curve, that is signed by a trusted EC root CA. The evaluator shall attempt to load the certificate into the trust store and observe that it is accepted into the TOE&#8217;s trust store. The evaluator shall then establish a subordinate CA certificate that uses an explicit format version of the elliptic curve parameters, and that is signed by a trusted EC root CA. The evaluator shall attempt to load the certificate into the trust store and observe that it is rejected, and not added to the TOE&#8217;s trust store.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FIA_X509_EXT.1.2/ITT</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="251">
<li>
<p>The evaluator shall perform the following tests for FIA_X509_EXT.1.2/ITT. The tests described must be performed in conjunction with the other certificate services assurance activities, including the functions in FIA_X509_EXT.2.1/ITT. The tests for the extendedKeyUsage rules are performed in conjunction with the uses that require those rules. Where the TSS identifies any of the rules for extendedKeyUsage fields (in FIA_X509_EXT.1.1) that are not supported by the TOE (i.e. where the ST is therefore claiming that they are trivially satisfied) then the associated extendedKeyUsage rule testing may be omitted.</p>
</li>
<li>
<p>The goal of the following tests is to verify that the TOE accepts a certificate as a CA certificate only if it has been marked as a CA certificate by using basicConstraints with the CA flag set to True (and implicitly tests that the TOE correctly parses the basicConstraints extension as part of X509v3 certificate chain validation).</p>
</li>
<li>
<p>For each of the following tests the evaluator shall create a chain of at least two certificates: a self-signed root CA certificate and a leaf (node) certificate. The properties of the certificates in the chain are adjusted as described in each individual test below (and this modification shall be the only invalid aspect of the relevant certificate chain).</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall ensure that one CA in the chain does not contain the basicConstraints extension. The evaluator confirms that the TOE rejects such a certificate at each of the following points supported: (i) as part of the validation of the leaf certificate belonging to this chain; (ii) when attempting to add a CA certificate without the basicConstraints extension to the TOE’s trust store (i.e. when attempting to install the CA certificate as one which will be retrieved from the TOE itself when validating future certificate chains).</p>
</li>
<li>
<p>Test 2: The evaluator shall ensure that at least one of the CA certificates in the chain has a basicConstraints extension in which the CA flag is set to FALSE. The evaluator confirms that the TOE rejects such a certificate at one (or both) of the following points: (i) as part of the validation of the leaf certificate belonging to this chain; (ii) when attempting to add a CA certificate with the CA flag set to FALSE to the TOE’s trust store (i.e. when attempting to install the CA certificate as one which will be retrieved from the TOE itself when validating future certificate chains).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_protection_of_the_tsf_fpt_2">3.3. Protection of the TSF (FPT)</h3>
<div class="sect3">
<h4 id="_fpt_itt_1_basic_internal_tsf_data_transfer_protection">3.3.1. FPT_ITT.1 Basic internal TSF data transfer protection</h4>
<div class="olist arabic">
<ol class="arabic" start="254">
<li>
<p>If the TOE is not a distributed TOE, then no evaluator action is necessary. For a distributed TOE the evaluator carries out the activities below.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_tss_29">3.3.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="255">
<li>
<p>The evaluator shall examine the TSS to determine that, for all communications between components of a distributed TOE, each communications mechanism is identified in terms of the allowed protocols for that IT entity. The evaluator shall also confirm that all protocols listed in the TSS for these inter-component communications are specified and included in the requirements in the ST.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_29">3.3.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="256">
<li>
<p>The evaluator shall confirm that the guidance documentation contains instructions for establishing the relevant allowed communication channels and protocols between each pair of authorized TOE components, and that it contains recovery instructions should a connection be unintentionally broken.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_30">3.3.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="257">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall ensure that communications using each protocol between each pair of authorized TOE components is tested during the course of the evaluation, setting up the connections as described in the guidance documentation and ensuring that communication is successful.</p>
</li>
<li>
<p>Test 2: The evaluator shall ensure, for each communication channel with an authorized IT entity, the channel data is not sent in plaintext.</p>
</li>
<li>
<p>Test 3: Objective: This test is to ensure that the TOE reacts appropriately to any connection outage or interruption of the route between distributed components.</p>
<div class="paragraph">
<p>The evaluator shall ensure that, for each different pair of non-equivalent component types, the connection is physically interrupted for the following durations: i) a duration that exceeds the TOE’s application layer timeout setting, ii) a duration that is shorter than the application layer timeout but is of sufficient length to interrupt the network link layer.</p>
</div>
<div class="paragraph">
<p>The evaluator shall ensure that when physical connectivity is restored, either communications are appropriately protected, or the secure channel is terminated and the registration process (as described in the FTP_TRP.1/Join) re-initiated, with the TOE generating adequate warnings to alert the Security Administrator.</p>
</div>
<div class="paragraph">
<p>In the case that the TOE is able to detect when the cable is removed from the device, another physical network device (e.g. a core switch) shall be used to interrupt the connection between the components.</p>
</div>
<div class="paragraph">
<p>For a non-virtualized TOE, the interruption shall not be performed at the virtual node (e.g. virtual switch) and must be physical in nature.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Further assurance activities are associated with the specific protocols.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_trusted_pathchannels_ftp_2">3.4. Trusted path/channels (FTP)</h3>
<div class="sect3">
<h4 id="_ftp_trp_1join_trusted_path">3.4.1. FTP_TRP.1/Join Trusted Path</h4>
<div class="sect4">
<h5 id="_tss_30">3.4.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="259">
<li>
<p>The evaluator shall examine the TSS to determine that the methods of joining components to the TOE are identified, along with how those communications are protected, including identification of whether the environment is required to provide confidentiality of the communications or whether the registration data exchanged does not require confidentiality. If the TSS asserts that registration data does not require confidentiality protection, then the evaluator shall examine the justification provided to confirm that.</p>
</li>
<li>
<p>The evaluator shall also check that all protocols listed in the TSS in support of this process are included in the SFRs in the ST, and that if the ST uses FTP_TRP.1/Join for the registration channel then this channel cannot be reused as the normal inter-component communication channel (the latter channel must meet FTP_ITC.1 or FPT_ITT.1).</p>
</li>
<li>
<p>The evaluator shall examine the TSS to confirm that sufficient information is provided to determine the TOE actions in the case that the initial component joining attempt fails</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_30">3.4.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="262">
<li>
<p>The evaluator shall examine the guidance documentation to confirm that it contains instructions for establishing and using the enablement and registration channel. The evaluator shall confirm that the guidance documentation makes clear which component initiates the communication. The evaluator shall confirm that the guidance documentation contains recovery instructions should a connection be unintentionally broken during the registration process.</p>
</li>
<li>
<p>In the case of a distributed TOE that relies on the operational environment to provide security for some aspects of the registration channel security then there are particular requirements on the Preparative Procedures as listed below. (Reliance on the operational environment in this way is indicated in an ST by a reference to operational guidance in the assignment in FTP_TRP.1.3/Join.) In this case the evaluator shall examine the Preparative Procedures to confirm that they:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>clearly state the strength of the authentication and encryption provided by the registration channel itself and the specific requirements on the environment used for joining components to the TOE (e.g. where the environment is relied upon to prevent interception of sensitive messages, IP spoofing attempts, man-in-the-middle attacks, or race conditions)</p>
</li>
<li>
<p>identify what confidential values are transmitted over the enablement channel (e.g. any keys, their lengths, and their purposes), use of any non-confidential keys (e.g. where a developer uses the same key for more than one device or across all devices of a type or family), and use of any unauthenticated identification data (e.g. IP addresses, self-signed certificates)</p>
</li>
<li>
<p>highlight any situation in which a secret value/key may be transmitted over a channel that uses a key of lower comparable strength than the transmitted value/key. Comparable strength is defined as the amount of work required to compromise the algorithm or key and is typically expressed as ‘bits’ of security. The ST author and evaluator should consult NIST 800-57 Table 2 for further guidance on comparable algorithm strength.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_31">3.4.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="264">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall ensure that the communications path for joining components to the TSF is tested for each distinct (non-equivalent) component type<sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup>, setting up the connections as described in the guidance documentation and ensuring that communication is successful. In particular the evaluator shall confirm that requirements on environment protection for the registration process are consistent with observations made on the test configuration (for example, a requirement to isolate the components from the Internet during registration might be inconsistent with the need for a component to contact a license server). If no requirements on the registration environment are identified as necessary to protect confidentiality, then the evaluator shall confirm that the key used for registration can be configured (following the instructions in the guidance documentation) to be at least the same length as the key used for the internal TSF channel that is being enabled. The evaluator shall confirm that the key used for the channel is unique to the pair of components (this is done by identifying the relevant key during the registration test: it is not necessary to examine the key value).</p>
</li>
<li>
<p>Test 2: The evaluator shall follow the guidance documentation to ensure that in fact the communication channel can be enabled by a Security Administrator for all the TOE components identified in the guidance documentation as capable of initiation.</p>
</li>
<li>
<p>Test 3: The evaluator shall ensure that if the guidance documentation states that the channel data is encrypted then the data observed on the channel is not plaintext.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="265">
<li>
<p>Further assurance activities are associated with the specific protocols.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_communication_fco">3.5. Communication (FCO)</h3>
<div class="sect3">
<h4 id="_fco_cpc_ext_1_component_registration_channel_definition">3.5.1. FCO_CPC_EXT.1 Component Registration Channel Definition</h4>
<div class="olist arabic">
<ol class="arabic" start="266">
<li>
<p>If the TOE is not a distributed TOE, then no evaluator action is necessary. For a distributed TOE the evaluator carries out the activities below. In carrying out these activities the evaluator shall determine answers to the following questions based on a combination of documentation analysis and testing (possibly also using input from carrying out the Evaluation Activities for the relevant registration channel, such as FTP_TRP.1/Join), and shall report the answers.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>What stops<sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup> a component from successfully communicating with TOE components (in a way that enables it to participate as part of the TOE) before it has properly authenticated and joined the TOE?</p>
</li>
<li>
<p>What is the enablement step? (Describe what interface it uses, with a reference to the relevant section and step in the operational guidance).</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>What stops anybody other than a Security Administrator from carrying out this step?</p>
</li>
<li>
<p>How does the Security Administrator know that they are enabling the intended component to join? (Identification of the joiner might be part of the enablement action itself or might be part of secure channel establishment, but it must prevent unintended joining of components)</p>
</li>
</ol>
</div>
</li>
<li>
<p>What stops a component successfully joining if the Security Administrator has not carried out the enablement step; or, equivalently, how does the TOE ensure that an action by an authentic Security Administrator is required before a component can successfully join?</p>
</li>
<li>
<p>What stops a component from carrying out the registration process over a different, insecure channel?</p>
</li>
<li>
<p>If the FTP_TRP.1/Join channel type is selected in FCO_CPC_EXT.1.2 then how do the registration process and its secure channel ensure that the data is protected from disclosure and provides detection of modification?</p>
</li>
<li>
<p>Where the registration channel does not rely on protection of the registration environment, does the registration channel provide a sufficient level of protection (especially with regard to confidentiality) for the data that passes over it?</p>
</li>
<li>
<p>Where the registration channel is subsequently used for normal internal communication between TOE components (i.e. after the joiner has completed registration), do any of the authentication or encryption features of the registration channel result in use of a channel that has weaker protection than the normal FPT_ITT.1 requirements for such a channel?</p>
</li>
<li>
<p>What is the disablement step? (Describe what interface it uses, with a reference to the relevant section and step in the operational guidance).</p>
</li>
<li>
<p>What stops a component successfully communicating with other TOE components if the Security Administrator has carried out the disablement step?</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_tss_31">3.5.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="267">
<li>
<p>(Note: paragraph 266 lists questions for which the evaluator needs to determine and report answers through the combination of the TSS, Guidance Documentation, and Tests Evaluation Activities.)</p>
</li>
<li>
<p>The evaluator shall examine the TSS to confirm that it:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Describes the method by which a Security Administrator enables and disables communications between pairs of TOE components.</p>
</li>
<li>
<p>Describes the relevant details according to the type of channel in the main selection made in FCO_CPC_EXT.1.2:</p>
<div class="ulist">
<ul>
<li>
<p>First type: the TSS identifies the relevant SFR iteration that specifies the channel used</p>
</li>
<li>
<p>Second type: the TSS (with support from the operational guidance if selected in FTP_TRP.1.3/Join) describes details of the channel and the mechanisms that it uses (and describes how the process ensures that the key is unique to the pair of components) – see also the Evaluation Activities for FTP_TRP.1/Join.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="269">
<li>
<p>The evaluator shall confirm that if any aspects of the registration channel are identified as not meeting FTP_ITC.1 or FPT_ITT.1, then the ST has also selected the FTP_TRP.1/Join option in the main selection in FCO_CPC_EXT.1.2.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_31">3.5.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="270">
<li>
<p>(Note: paragraph 266 lists questions for which the evaluator needs to determine and report answers through the combination of the TSS, Guidance Documentation, and Tests Evaluation Activities.)</p>
</li>
<li>
<p>The evaluator shall examine the guidance documentation to confirm that it contains instructions for enabling and disabling communications with any individual component of a distributed TOE. The evaluator shall confirm that the method of disabling is such that all other components can be prevented from communicating with the component that is being removed from the TOE (preventing the remaining components from either attempting to initiate communications to the disabled component, or from responding to communications from the disabled component).</p>
</li>
<li>
<p>The evaluator shall examine the guidance documentation to confirm that it includes recovery instructions should a connection be unintentionally broken during the registration process.</p>
</li>
<li>
<p>If the TOE uses a registration channel for registering components to the TOE (i.e. where the ST author uses the FTP_ITC.1/FPT_ITT.1 or FTP_TRP.1/Join channel types in the main selection for FCO_CPC_EXT.1.2) then the evaluator shall examine the Preparative Procedures to confirm that they:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>describe the security characteristics of the registration channel (e.g. the protocol, keys and authentication data on which it is based) and shall highlight any aspects which do not meet the requirements for a steady-state inter-component channel (as in FTP_ITC.1 or FPT_ITT.1)</p>
</li>
<li>
<p>identify any dependencies between the configuration of the registration channel and the security of the subsequent inter-component communications (e.g. where AES-256 inter-component communications depend on transmitting 256 bit keys between components and therefore rely on the registration channel being configured to use an equivalent key length)</p>
</li>
<li>
<p>identify any aspects of the channel can be modified by the operational environment in order to improve the channel security and shall describe how this modification can be achieved (e.g. generating a new key pair, or replacing a default public key certificate).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="274">
<li>
<p>As background for the examination of the registration channel description, it is noted that the requirements above are intended to ensure that administrators can make an accurate judgement of any risks that arise from the default registration process. Examples would be the use of self-signed certificates (i.e. certificates that are not chained to an external or local Certification Authority), manufacturer-issued certificates (where control over aspects such as revocation, or which devices are issued with recognised certificates, is outside the control of the operational environment), use of generic/non-unique keys (e.g. where the same key is present on more than one instance of a device), or well-known keys (i.e. where the confidentiality of the keys is not intended to be strongly protected – note that this need not mean there is a positive action or intention to publicise the keys).</p>
</li>
<li>
<p>In the case of a distributed TOE for which the ST author uses the FTP_TRP.1/Join channel type in the main selection for FCO_CPC_EXT.1.2 and the TOE relies on the operational environment to provide security for some aspects of the registration channel security then there are additional requirements on the Preparative Procedures as described in section 3.4.1.2.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_32">3.5.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="276">
<li>
<p>(Note: paragraph 266 lists questions for which the evaluator needs to determine and report answers through the combination of the TSS, Guidance Documentation, and Tests Evaluation Activities.)</p>
</li>
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1a: the evaluator shall confirm that an IT entity that is not currently a member of the distributed TOE cannot communicate with any component of the TOE until the non-member entity is enabled by a Security Administrator for each of the non-equivalent TOE components<sup class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup> that it is required to communicate with (non-equivalent TOE components are as defined in the minimum configuration for the distributed TOE)</p>
</li>
<li>
<p>Test 1b: the evaluator shall confirm that after enablement, an IT entity can communicate only with the components that it has been enabled for. This includes testing that the enabled communication is successful for the enabled component pair, and that communication remains unsuccessful with any other component for which communication has not been explicitly enabled</p>
<div class="paragraph">
<p>Some TOEs may set up the registration channel before the enablement step is carried out, but in such a case the channel must not allow communications until after the enablement step has been completed.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>The evaluator shall repeat Tests 1a and 1b for each different type of enablement process that can be used in the TOE.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="3">
<li>
<p>Test 2: The evaluator shall separately disable each TOE component in turn and ensure that the other TOE components cannot then communicate with the disabled component, whether by attempting to initiate communications with the disabled component or by responding to communication attempts from the disabled component.</p>
</li>
<li>
<p>Test 3: The evaluator shall perform the following tests according to those that apply to the values of the main (outer) selection made in the ST for FCO_CPC_EXT.1.2.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>If the ST uses the first type of communication channel in the selection in FCO_CPC_EXT.1.2 then the evaluator tests the channel via the Evaluation Activities for FTP_ITC.1 or FPT_ITT.1 according to the second selection – the evaluator shall ensure that the test coverage for these SFRs includes their use in the registration process.</p>
</li>
<li>
<p>If the ST uses the second type of communication channel in the selection in FCO_CPC_EXT.1.2 then the evaluator tests the channel via the Evaluation Activities for FTP_TRP.1/Join.</p>
</li>
<li>
<p>If the ST uses the ‘no channel’ selection, then no test is required.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 4: The evaluator shall perform one of the following tests, according to the TOE characteristics identified in its TSS and operational guidance:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>If the registration channel is not subsequently used for inter-component communication, and in all cases where the second selection in FCO_CPC_EXT.1.2 is made (i.e. using FTP_TRP.1/Join) then the evaluator shall confirm that the registration channel can no longer be used after the registration process has completed, by attempting to use the channel to communicate with each of the endpoints after registration has completed</p>
</li>
<li>
<p>If the registration channel is subsequently used for inter-component communication then the evaluator shall confirm that any aspects identified in the operational guidance as necessary to meet the requirements for a steady-state inter-component channel (as in FTP_ITC.1 or FPT_ITT.1) can indeed be carried out (e.g. there might be a requirement to replace the default key pair and/or public key certificate).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 5: For each aspect of the security of the registration channel that operational guidance states can be modified by the operational environment in order to improve the channel security (cf. AGD_PRE.1 refinement item 2 in (cf. the requirements on Preparative Procedures in 3.5.1.2), the evaluator shall confirm, by following the procedure described in the operational guidance, that this modification can be successfully carried out.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cryptographic_support_fcs_2">3.6. Cryptographic Support (FCS)</h3>
<div class="sect3">
<h4 id="_fcs_dtlsc_ext_2_extended_dtls_client_support_for_mutual_authentication">3.6.1. FCS_DTLSC_EXT.2 Extended: DTLS Client support for mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_32">3.6.1.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="279">
<li>
<p>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for DTLS mutual authentication.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="280">
<li>
<p>The evaluator shall verify that the TSS describes the actions that take place if a message received from the DTLS Server fails the MAC integrity check.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="281">
<li>
<p>The evaluator shall verify that TSS describes how replay is detected and silently discarded for DTLS records that have previously been received and too old to fit in the sliding window.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_32">3.6.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="282">
<li>
<p>If the TSS indicates that mutual authentication using X.509v3 certificates is used, the evaluator shall verify that the AGD guidance includes instructions for configuring the client-side certificates for DTLS mutual authentication.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_33">3.6.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="283">
<li>
<p>For all tests in this chapter the DTLS server used for testing of the TOE shall be configured to require mutual authentication.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="284">
<li>
<p>Test 1: The evaluator shall establish a connection to a peer server that is configured for mutual authentication (i.e. sends a server Certificate Request (type 13) message). The evaluator observes that the TOE DTLS client sends both client Certificate (type 11) and client Certificate Verify (type 15) messages during its negotiation of a DTLS channel and that Application Data is sent.</p>
<div class="paragraph">
<p>In addition, all other testing in FCS_DTLSC_EXT.1 and FIA_X509_EXT.* must be performed as per the requirements.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="285">
<li>
<p>Test 1: The evaluator shall establish a DTLS connection. The evaluator will then modify at least one byte in a record message and verify that the Client discards the record or terminates the DTLS session.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.2.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="286">
<li>
<p>Test 1: The evaluator shall set up a DTLS connection with a DTLS Server. The evaluator shall then capture traffic sent from the DTLS Server to the TOE. The evaluator shall retransmit copies of this traffic to the TOE in order to impersonate the DTLS Server. The evaluator shall observe that the TSF does not take action in response to receiving these packets and that the audit log indicates that the replayed traffic was discarded.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_dtlsc_ext_3_extended_dtls_client_support_for_secure_renegotiation_dtlsv1_2_only">3.6.2. FCS_DTLSC_EXT.3 Extended: DTLS Client support for secure renegotiation (DTLSv1.2 only)</h4>
<div class="sect4">
<h5 id="_tss_33">3.6.2.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="287">
<li>
<p>None.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_33">3.6.2.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="288">
<li>
<p>None</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_34">3.6.2.3. Tests</h5>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="289">
<li>
<p>The evaluator shall perform the following tests:</p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall use a network packet analyzer/sniffer to capture the traffic between the two DTLS endpoints. The evaluator shall verify that either the “renegotiation_info” field or the SCSV cipher suite is included in the ClientHello message during the initial handshake.</p>
</li>
<li>
<p>Test 2: The evaluator shall verify the TOE DTLS Client’s handling of ServerHello messages received during the initial handshake that include the “renegotiation_info” extension. The evaluator shall modify the length portion of this field in the ServerHello message to be non-zero and verify that the TOE DTLS client sends a failure and terminates the connection. The evaluator shall verify that a properly formatted field results in a successful DTLS connection.</p>
</li>
<li>
<p>Test 3: The evaluator shall verify that ServerHello messages received during secure renegotiation contain the “renegotiation_info” extension. The evaluator shall modify either the “client_verify_data” or “server_verify_data” value and verify that the TOE DTLS client terminates the connection.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_dtlss_ext_2_extended_dtls_server_support_for_mutual_authentication">3.6.3. FCS_DTLSS_EXT.2 Extended: DTLS Server support for mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_34">3.6.3.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.1 and FCS_DTLSS_EXT.2.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="290">
<li>
<p>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for DTLS mutual authentication.</p>
</li>
<li>
<p>The evaluator shall verify the TSS describes how the TSF uses certificates to authenticate the DTLS client and how the TOE reacts in case either the client does not send a client certificate or the verification of the client certificate fails. The evaluator shall verify the TSS describes whether the TSF supports any fallback authentication functions (e.g. username/password, challenge response) the TSF uses to authenticate DTLS clients that do not present a certificate. If fallback authentication functions are supported, the evaluator shall verify the TSS describes whether the fallback authentication functions can be disabled.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="292">
<li>
<p>The evaluator shall verify that the TSS describes which types of identifiers are supported for during client authentication (e.g. Fully Qualified Domain Name (FQDN)). If FQDNs are supported, the evaluator shall verify that the TSS describes that corresponding identifiers are matched according to RFC6125. For all other types of identifiers, the evaluator shall verify that the TSS describes how these identifiers are parsed from the certificate, what the expected identifiers are and how the parsed identifiers from the certificate are matched against the expected identifiers.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="293">
<li>
<p>The evaluator shall verify that TSS describes the signature_algorithms extension and whether the required behavior is performed by default or may be configured.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_34">3.6.3.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.1 and FCS_DTLSS_EXT.2.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="294">
<li>
<p>If the TSS indicates that mutual authentication using X.509v3 certificates is used, the evaluator shall verify that the AGD guidance includes instructions for configuring the client-side certificates for DTLS mutual authentication.</p>
</li>
<li>
<p>The evaluator shall verify the guidance describes how to configure the DTLS client certificate authentication function. If the TSF supports fallback authentication functions, the evaluator shall verify the guidance provides instructions for configuring the fallback authentication functions. If fallback authentication functions can be disabled, the evaluator shall verify the guidance provides instructions for disabling the fallback authentication functions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="296">
<li>
<p>The evaluator shall ensure that the AGD guidance describes the configuration of expected identifier(s) for X.509 certificate-based authentication of DTLS clients. The evaluator ensures this description includes all types of identifiers described in the TSS and, if claimed, configuration of the TOE to use a directory server.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="297">
<li>
<p>If the TSS indicates that the signature_algorithms extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the signature_algorithms extension.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_35">3.6.3.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="298">
<li>
<p>For all tests in this chapter the DTLS client used for testing of the TOE shall support mutual authentication.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.1 and FCS_DTLSS_EXT.2.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="299">
<li>
<p>The evaluator shal perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1a [conditional]: If the 'hard fail' option has been selected in FCS_DTLSS_EXT.2.1, the evaluator shall configure the TOE to require a client certificate and send a Certificate Request to the client. The evaluator shall attempt a connection while sending a certificate_list structure with a length of zero in the Client Certificate message. The evaluator shall verify that the handshake is not finished successfully and no application data flows.</p>
</li>
<li>
<p>Test 1b [conditional]: If the 'soft fail' option has been selected in FCS_DTLSS_EXT.2.1, the evaluator shall configure the TOE to require a client certificate and configure the TOE to send a Certificate Request to the client. The evaluator shall attempt a connection while sending a certificate_list structure with a length of zero in the Client Certificate message. The evaluator verifies the client remains unauthenticated (e.g. requires application layer authentication tested according to the related SFRs for this application layer authentication) or is restricted to unauthenticated operations.</p>
<div class="paragraph">
<p>Note: Testing the validity of the client certificate is performed as part of X.509 testing.</p>
</div>
</li>
<li>
<p>Test 2: The intent of this test is to check the response of the server when it receives a client identity certificate that is signed by an impostor CA (either Root CA or intermediate CA). To perform this test the evaluator shall configure the client to send a client identity certificate with an issuer field that identifies a CA recognised by the TOE as a trusted CA, but where the key used for the signature on the client certificate does not correspond to the CA certificate trusted by the TOE (meaning that the client certificate is invalid because its certification path does not terminate in the claimed CA certificate). The evaluator shall verify that the attempted connection is denied.</p>
</li>
<li>
<p>Test 3: The intent of this test is to verify certificate validation logic to ensure that only certificates with the correct OID present in the EKU are accepted.</p>
<div class="paragraph">
<p>The evaluator shall establish the connection with a client presenting a certificate with the ClientAuth (OID 1.3.6.1.5.5.7.3.2) in the extendedKeyUsage field and verify that the connection successfully negotiated. The evaluator will then verify that when the same client presents an otherwise valid client certificate that contains the extendedKeyUsage extension without ClientAuth the server rejects the connection. Ideally, the two certificates should be identical except for the OID values.</p>
</div>
</li>
<li>
<p>Test 4 [conditional]: The evaluator shall perform the following modifications to the traffic:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Perform this test only if support of DTLS 1.2 is claimed. Configure the server to require mutual authentication and then connect to the server with a client configured to send a client certificate that is signed by a Certificate Authority trusted by the TOE. The evaluator shall verify that the server accepts the connection.</p>
</li>
<li>
<p>Perform this test only if support of DTLS 1.2 is claimed. Configure the server to require mutual authentication and then modify a byte in the signature block of the client’s Certificate Verify handshake message (see RFC5246 Sec 7.4.8). The evaluator shall verify that the server rejects the connection.</p>
<div class="paragraph">
<p>Note: Testing the validity of the client certificate is performed as part of X.509 testing.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Test 5 [conditional]: The purpose of this test is to verify that only selected certificate validation failures could be administratively overridden. If any override mechanism is defined for failed certificate validation, the evaluator shall configure a new presented certificate that does not contain a valid entry in one of the mandatory fields or parameters (e.g. inappropriate value in extendedKeyUsage field) but is otherwise valid and signed by a trusted CA. The evaluator shall confirm that the certificate validation fails (i.e. certificate is rejected), and there is no administrative override available to accept such certificate.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="300">
<li>
<p>The evaluator shall send a client certificate with an identifier that does not match an expected identifier and verify that the server denies the connection.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.2.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="301">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: If “present a [selection: DTLS 1.2, DTLS 1.3] Certificate Request message” is selected, the evaluator shall perform the following tests for each selected version of DTLS:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall examine the Certificate Request message. The evaluator shall verify that the SignatureAndHashAlgorithms (DTLS 1.2) or the SignatureSchemes (DTLS 1.3) match the SignatureAndHashAlgorithms specified in the requirement.</p>
</li>
<li>
<p>The evaluator shall establish a connection and authenticate the client using each selected SignatureAndHashAlgorithm. The evaluator shall verify the connection succeeds.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 2 [conditional]: If DTLS 1.3 is supported, the evaluator shall perform the following tests if “present the signature_algorithms_cert extension” is selected:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall examine the Certificate Request message and verify it contains the signature_algorihtms_cert extension and the SignatureSchemes match the SignatureSchemes specified in the requirement.</p>
</li>
<li>
<p>The evaluator shall establish a DTLS connection and perform client authentication using a certificate chain using each of the SignatureSchemes specified by the requirement. The evaluator shall ensure the signatures used in the certificate chain are consistent with the SignatureScheme being tested.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_dtlss_ext_3_extended_dtls_server_support_for_secure_renegotiation_dtlsv1_2_only">3.6.4. FCS_DTLSS_EXT.3 Extended: DTLS Server support for secure renegotiation (DTLSv1.2 only)</h4>
<div class="sect4">
<h5 id="_tss_35">3.6.4.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="302">
<li>
<p>None.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_35">3.6.4.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="303">
<li>
<p>None</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_36">3.6.4.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="304">
<li>
<p>The evaluator shall perform the following tests. The following tests require connection with a client that supports secure renegotiation and the ”renegotiation_info” extension.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="305">
<li>
<p>Test 1: The evaluator shall use a network packet analyzer/sniffer to capture the traffic between the two DTLS endpoints. The evaluator shall verify that the “renegotiation_info” field is included in the ServerHello message.</p>
</li>
<li>
<p>Test 2: The evaluator shall modify the length portion of the field in the ClientHello message in the initial handshake to be non-zero and verify that the TOE DTLS server sends a failure and terminates the connection. The evaluator shall verify that a properly formatted field results in a successful DTLS connection.</p>
</li>
<li>
<p>Test 3: The evaluator shall modify the "client_verify_data" or "server_verify_data" value in the ClientHello message received during secure renegotiation and verify that the TOE DTLS server terminates the connection.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_tlsc_ext_2_extended_tls_client_support_for_mutual_authentication">3.6.5. FCS_TLSC_EXT.2 Extended: TLS Client support for mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_36">3.6.5.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.2.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="308">
<li>
<p>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for TLS mutual authentication.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_36">3.6.5.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.2.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="309">
<li>
<p>If the TSS indicates that mutual authentication using X.509v3 certificates is used, the evaluator shall verify that the AGD guidance includes instructions for configuring the client-side certificates for TLS mutual authentication.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_37">3.6.5.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="310">
<li>
<p>For all tests in this chapter the TLS server used for testing of the TOE shall be configured to require mutual authentication.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.2.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="311">
<li>
<p>Test 1: The evaluator shall establish a connection to a peer server that is configured for mutual authentication (i.e. sends a server Certificate Request (type 13) message). The evaluator observes that the TOE TLS client sends both client Certificate (type 11) and client Certificate Verify (type 15) messages during its negotiation of a TLS channel and that Application Data is sent.</p>
<div class="paragraph">
<p>In addition, all other testing in FCS_TLSC_EXT.1 and FIA_X509_EXT.* must be performed as per the requirements.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_tlsc_ext_3_extended_tls_client_support_for_secure_renegotiation_tlsv1_2_only">3.6.6. FCS_TLSC_EXT.3 Extended: TLS Client support for secure renegotiation (TLSv1.2 only)</h4>
<div class="sect4">
<h5 id="_tss_37">3.6.6.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="312">
<li>
<p>None.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_37">3.6.6.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="313">
<li>
<p>None</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_38">3.6.6.3. Tests</h5>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="314">
<li>
<p>The evaluator shall perform the following tests:</p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall use a network packet analyzer/sniffer to capture the traffic between the two TLS endpoints. The evaluator shall verify that either the “renegotiation_info” field or the SCSV cipher suite is included in the ClientHello message during the initial handshake.</p>
</li>
<li>
<p>Test 2: The evaluator shall verify the TOE TLS Client’s handling of ServerHello messages received during the initial handshake that include the “renegotiation_info” extension. The evaluator shall modify the length portion of this field in the ServerHello message to be non-zero and verify that the TOE TLS client sends a failure and terminates the connection. The evaluator shall verify that a properly formatted field results in a successful TLS connection.</p>
</li>
<li>
<p>Test 3: The evaluator shall verify that ServerHello messages received during secure renegotiation contain the “renegotiation_info” extension. The evaluator shall modify either the “client_verify_data” or “server_verify_data” value and verify that the TOE TLS client terminates the connection.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_tlss_ext_2_extended_tls_server_support_for_mutual_authentication">3.6.7. FCS_TLSS_EXT.2 Extended: TLS Server support for mutual authentication</h4>
<div class="sect4">
<h5 id="_tss_38">3.6.7.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="315">
<li>
<p>The evaluator shall ensure that the TSS description required per FIA_X509_EXT.2.1 includes the use of client-side certificates for TLS mutual authentication.</p>
</li>
<li>
<p>The evaluator shall verify the TSS describes how the TSF uses certificates to authenticate the TLS client and how the TOE reacts in case either the client does not send a client certificate or the verification of the client certificate fails. The evaluator shall verify the TSS describes if the TSF supports any fallback authentication functions (e.g. username/password, challenge response) the TSF uses to authenticate TLS clients that do not present a certificate. If fallback authentication functions are supported, the evaluator shall verify the TSS describes whether the fallback authentication functions can be disabled.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="317">
<li>
<p>The evaluator shall verify that the TSS describes which types of identifiers are supported during client authentication (e.g. Fully Qualified Domain Name (FQDN)). If FQDNs are supported, the evaluator shall verify that the TSS describes that corresponding identifiers are matched according to RFC6125. For all other types of identifiers, the evaluator shall verify that the TSS describes how these identifiers are parsed from the certificate, what the expected identifiers are and how the parsed identifiers from the certificate are matched against the expected identifiers.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="318">
<li>
<p>The evaluator shall verify that TSS describes the signature_algorithms extension and whether the required behavior is performed by default or may be configured.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_38">3.6.7.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="319">
<li>
<p>If the TSS indicates that mutual authentication using X.509v3 certificates is used, the evaluator shall verify that the AGD guidance includes instructions for configuring the client-side certificates for TLS mutual authentication.</p>
</li>
<li>
<p>The evaluator shall verify the guidance describes how to configure the TLS client certificate authentication function. If the TSF supports fallback authentication functions, the evaluator shall verify the guidance provides instructions for configuring the fallback authentication functions. If fallback authentication functions can be disabled, the evaluator shall verify the guidance provides instructions for disabling the fallback authentication functions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="321">
<li>
<p>The evaluator shall ensure that the AGD guidance describes the configuration of expected identifier(s) for X.509 certificate-based authentication of TLS clients. The evaluator ensures this description includes all types of identifiers described in the TSS and, if claimed, configuration of the TOE to use a directory server.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="322">
<li>
<p>If the TSS indicates that the signature_algorithms extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the signature_algorithms extension.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_39">3.6.7.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="323">
<li>
<p>For all tests in this chapter the TLS client used for testing of the TOE shall support mutual authentication.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.1 and FCS_TLSS_EXT.2.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="324">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1a [conditional]: If the 'hard fail' option has been selected in FCS_TLSS_EXT.2.1, the evaluator shall configure the TOE to require a client certificate and send a Certificate Request to the client. The evaluator shall attempt a connection while sending a certificate_list structure with a length of zero in the Client Certificate message. The evaluator shall verify that the handshake is not finished successfully and no application data flows.</p>
</li>
<li>
<p>Test 1b [conditional]: If the 'soft fail' option has been selected in FCS_TLSS_EXT.2.1, the evaluator shall configure the TOE to require a client certificate and configure the TOE to send a Certificate Request to the client. The evaluator shall attempt a connection while sending a certificate_list structure with a length of zero in the Client Certificate message. The evaluator verifies the client remains unauthenticated (e.g. requires application layer authentication tested according to the related SFRs for this application layer authentication) or is restricted to unauthenticated operations.</p>
<div class="paragraph">
<p>Note: Testing the validity of the client certificate is performed as part of X.509 testing.</p>
</div>
</li>
<li>
<p>Test 2: The intent of this test is to check the response of the server when it receives a client identity certificate that is signed by an impostor CA (either Root CA or intermediate CA). To perform this test the evaluator shall configure the client to send a client identity certificate with an issuer field that identifies a CA recognised by the TOE as a trusted CA, but where the key used for the signature on the client certificate does not correspond to the CA certificate trusted by the TOE (meaning that the client certificate is invalid because its certification path does not terminate in the claimed CA certificate). The evaluator shall verify that the attempted connection is denied.</p>
</li>
<li>
<p>Test 3: The intent of this test is to verify certificate validation logic to ensure that only certificates with the correct OID present in the EKU are accepted.</p>
<div class="paragraph">
<p>The evaluator shall establish the connection with a client presenting a certificate with the ClientAuth (OID 1.3.6.1.5.5.7.3.2) in the extendedKeyUsage field and verify that the connection successfully negotiated. The evaluator will then verify that when the same client presents an otherwise valid client certificate that contains the extendedKeyUsage extension without ClientAuth the server rejects the connection. Ideally, the two certificates should be identical except for the OID values.</p>
</div>
</li>
<li>
<p>Test 4 [conditional]: The evaluator shall perform the following modifications to the traffic:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Perform this test only if support of TLS 1.2 is claimed. Configure the server to require mutual authentication and then connect to the server with a client configured to send a client certificate that is signed by a Certificate Authority trusted by the TOE. The evaluator shall verify that the server accepts the connection.</p>
</li>
<li>
<p>Perform this test only if support of TLS 1.2 is claimed. Configure the server to require mutual authentication and then modify a byte in the signature block of the client’s Certificate Verify handshake message (see RFC5246 Sec 7.4.8). The evaluator shall verify that the server rejects the connection.</p>
<div class="paragraph">
<p>Note: Testing the validity of the client certificate is performed as part of X.509 testing.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Test 5 [conditional]: The purpose of this test is to verify that only selected certificate validation failures could be administratively overridden. If any override mechanism is defined for failed certificate validation, the evaluator shall configure a new presented certificate that does not contain a valid entry in one of the mandatory fields or parameters (e.g. inappropriate value in extendedKeyUsage field) but is otherwise valid and signed by a trusted CA. The evaluator shall confirm that the certificate validation fails (i.e. certificate is rejected), and there is no administrative override available to accept such certificate.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="325">
<li>
<p>The evaluator shall send a client certificate with an identifier that does not match an expected identifier and verify that the server denies the connection.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.2.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="326">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: If “present a [selection: TLS 1.2, TLS 1.3] Certificate Request message” is selected, the evaluator shall perform the following tests for each selected version of TLS:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall examine the Certificate Request message. The evaluator shall verify that the SignatureAndHashAlgorithms (TLS 1.2) or the SignatureSchemes (TLS 1.3) match the SignatureAndHashAlgorithms specified in the requirement.</p>
</li>
<li>
<p>The evaluator shall establish a connection and authenticate the client using each selected SignatureAndHashAlgorithm. The evaluator shall verify the connection succeeds.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 2 [conditional]: If TLS 1.3 is supported, the evaluator shall perform the following tests if “present the signature_algorithms_cert extension” is selected:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall examine the Certificate Request message and verify it contains the signature_algorihtms_cert extension and the SignatureSchemes match the SignatureSchemes specified in the requirement.</p>
</li>
<li>
<p>The evaluator shall establish a TLS connection and perform client authentication using a certificate chain using each of the SignatureSchemes specified by the requirement. The evaluator shall ensure the signatures used in the certificate chain are consistent with the SignatureScheme being tested.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_tlss_ext_3_extended_tls_server_support_for_secure_renegotiation_tlsv1_2_only">3.6.8. FCS_TLSS_EXT.3 Extended: TLS Server support for secure renegotiation (TLSv1.2 only)</h4>
<div class="sect4">
<h5 id="_tss_39">3.6.8.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="327">
<li>
<p>None.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_39">3.6.8.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="328">
<li>
<p>None</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_40">3.6.8.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="329">
<li>
<p>The evaluator shall perform the following tests. The following tests require connection with a client that supports secure renegotiation and the ”renegotiation_info” extension.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.3.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="330">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall use a network packet analyzer/sniffer to capture the traffic between the two TLS endpoints. The evaluator shall verify that the “renegotiation_info” field is included in the ServerHello message.</p>
</li>
<li>
<p>Test 2: The evaluator shall modify the length portion of the field in the ClientHello message in the initial handshake to be non-zero and verify that the TOE TLS server sends a failure and terminates the connection. The evaluator shall verify that a properly formatted field results in a successful TLS connection.</p>
</li>
<li>
<p>Test 3: The evaluator shall modify the "client_verify_data" or "server_verify_data" value in the ClientHello message received during secure renegotiation and verify that the TOE TLS server terminates the connection.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activities_for_selection_based_requirements">4. Evaluation Activities for Selection-Based Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_security_audit_fau_3">4.1. Security Audit (FAU)</h3>
<div class="sect3">
<h4 id="_fau_gen_ext_1_security_audit_data_generation_for_distributed_toe_components">4.1.1. FAU_GEN_EXT.1 Security Audit Data Generation for Distributed TOE Components</h4>
<div class="olist arabic">
<ol class="arabic" start="331">
<li>
<p>For distributed TOEs, the requirements on TSS, Guidance Documentation and Tests regarding FAU_GEN_EXT.1 are already covered by the corresponding requirements for FAU_GEN.1.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_fau_stg_ext_4_protected_local_audit_event_storage_for_distributed_toes_fau_stg_ext_5_protected_remote_audit_event_storage_for_distributed_toes">4.1.2. FAU_STG_EXT.4 Protected Local audit event storage for distributed TOEs &amp; FAU_STG_EXT.5 Protected Remote audit event storage for Distributed TOEs</h4>
<div class="sect4">
<h5 id="_tss_40">4.1.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="332">
<li>
<p>The evaluator examines the TSS to confirm that it describes which TOE components store their security audit events locally and which send their security audit events to other TOE components for local storage. For the latter, the target TOE component(s) which store security audit events for other TOE components shall be identified. For every sending TOE component, the corresponding receiving TOE component(s) need to be identified. For every transfer of audit information between TOE components it shall be described how the data is secured during transfer according to FTP_ITC.1 or FPT_ITT.1.</p>
</li>
<li>
<p>For each TOE component which does not store audit events locally by itself, the evaluator confirms that the TSS describes how the audit information is buffered before sending to another TOE component for local storage.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_40">4.1.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="334">
<li>
<p>The evaluator shall examine the guidance documentation to ensure that it describes how the link between different TOE components is established if audit data is exchanged between TOE components for local storage. The guidance documentation shall describe all possible configuration options for local storage of audit data and provide all instructions how to perform the related configuration of the TOE components.</p>
</li>
<li>
<p>The evaluator shall also ensure that the guidance documentation describes for every TOE component which does not store audit information locally how audit information is buffered before transmission to other TOE components.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_41">4.1.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="336">
<li>
<p>For at least one of each type of distributed TOE components (sensors, central nodes, etc.), the following tests shall be performed using distributed TOEs.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: For each type of TOE component, the evaluator shall perform a representative subset of auditable actions and ensure that these actions cause the generation of appropriately formed audit records. Generation of such records can be observed directly on the distributed TOE component (if there is appropriate interface), or indirectly after transmission to a central location.</p>
</li>
<li>
<p>Test 2: For each type of TOE component that, in the evaluated configuration, is capable of transmitting audit information to the external audit server (as specified in FTP_ITC.1), the evaluator shall configure a trusted channel and confirm that audit records generated as a result of actions taken by the evaluator are securely transmitted. It is sufficient to observe negotiation and establishment of the secure channel with the TOE component and the subsequent transmission of encrypted data to confirm this functionality. Alternatively, the following steps shall be performed: The evaluator induces audit record transmission, then reviews the packet capture around the time of transmission and verifies that no audit data is transmitted in the clear.</p>
</li>
<li>
<p>Test 3: For each type of TOE component that, in the evaluated configuration, is capable of transmitting audit information to another TOE component (as specified in FTP_ITT.1 or FTP_ITC.1, respectively), the evaluator shall configure a secure channel and confirm that audit records generated as a result of actions taken by the evaluator are securely transmitted. It is sufficient to observe negotiation and establishment of the secure channel with the TOE component and the subsequent transmission of encrypted data to confirm this functionality. Alternatively, the following steps shall be performed: The evaluator induces audit record transmission, then reviews the packet capture around the time of transmission and verifies that no audit data is transmitted in the clear.</p>
</li>
</ol>
</div>
</li>
<li>
<p>While performing these tests, the evaluator shall verify that the TOE behaviour observed during testing is consistent with the descriptions provided in the TSS and the Guidance Documentation. Depending on the TOE configuration, there might be a large number of different possible configurations. In such cases, it is acceptable to perform subset testing, accompanied by an equivalency argument describing the evaluator’s sampling methodology.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cryptographic_support_fcs_3">4.2. Cryptographic Support (FCS)</h3>
<div class="sect3">
<h4 id="_fcs_dtlsc_ext_1_extended_dtls_client_protocol">4.2.1. FCS_DTLSC_EXT.1 Extended: DTLS Client Protocol</h4>
<div class="sect4">
<h5 id="_tss_41">4.2.1.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="338">
<li>
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. The evaluator shall check the TSS to ensure that the ciphersuites specified include those listed for this component.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="339">
<li>
<p>The evaluator shall ensure that the TSS describes the client’s method of establishing all reference identifiers from the administrator/application-configured reference identifier, including which types of reference identifiers are supported (e.g. application-specific Subject Alternative Names) and whether IP addresses and wildcards are supported.</p>
</li>
<li>
<p>Note that where a DTLS channel is being used between components of a distributed TOE for FPT_ITT.1, the requirements to have the reference identifier established by the administrator are relaxed and the identifier may also be established through a “Gatekeeper” discovery process. The TSS should describe the discovery process and highlight how the reference identifier is supplied to the “joining” component. Where the secure channel is being used between components of a distributed TOE for FPT_ITT.1 and the ST author selected attributes from RFC 5280, the evaluator shall ensure the TSS describes which attribute type, or combination of attributes types, are used by the client to match the presented identifier with the configured identifier. The evaluator shall ensure the TSS presents an argument how the attribute type, or combination of attribute types, uniquely identify the remote TOE component; and the evaluator shall verify the attribute type, or combination of attribute types, is sufficient to support unique identification of the maximum supported number of TOE components.</p>
</li>
<li>
<p>If IP addresses are supported in the CN as reference identifiers, the evaluator shall ensure that the TSS describes the TOE’s conversion of the text representation of the IP address in the CN to a binary representation of the IP address in network byte order. The evaluator shall also ensure that the TSS describes whether canonical format (RFC 5952 for IPv6, RFC 3986 for IPv4) is enforced.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="342">
<li>
<p>If “present the Supported Groups Extension” is selected, the evaluator shall verify that TSS describes the Supported Groups Extension and whether the required behaviour is performed by default or may be configured.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="343">
<li>
<p>[Conditional]: The evaluator shall verify that TSS describes the signature_algorithms extension and whether the required behavior is performed by default or may be configured.</p>
</li>
<li>
<p>[Conditional]: The evaluator shall verify that TSS describes the signature_algorithms_cert extension and whether the required behavior is performed by default or may be configured.</p>
</li>
<li>
<p>[Conditional]:If “not present the signature_algorithms extension” is selected, the evaluator shall verify that the TSS describes support for at least one RSA ciphersuite, RSA in FCS_COP.1/SigGen, and SHA-1 for FCS_COP.1/Hash.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="346">
<li>
<p>The evaluator shall verify that TSS describes whether the list of supported ciphersuites can be configured or not.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="347">
<li>
<p>The evaluator shall verify in the TSS that, for DTLS 1.3, the TOE shall not permit out-of-band provisioning of pre-shared keys (PSKs) in the evaluated configuration.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_41">4.2.1.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="348">
<li>
<p>The evaluator shall also check the guidance documentation to ensure that it contains instructions on configuring the TOE so that DTLS conforms to the description in the TSS.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="349">
<li>
<p>The evaluator shall ensure that the operational guidance describes all supported identifiers, explicitly states whether the TOE supports the SAN extension or not and includes detailed instructions on how to configure the reference identifier(s) used to check the identity of peer(s). If the identifier scheme implemented by the TOE includes support for IP addresses, the evaluator shall ensure that the operational guidance provides a set of warnings and/or CA policy recommendations that would result in secure TOE use.</p>
</li>
<li>
<p>Where the secure channel is being used between components of a distributed TOE for FPT_ITT.1, the SFR selects attributes from RFC 5280, and FCO_CPC_EXT.1.2 selects “no channel”; the evaluator shall verify the guidance provides instructions for establishing unique reference identifiers based on RFC5280 attributes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="351">
<li>
<p>If the TSS indicates that the Supported Groups Extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the Supported Groups Extension.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="352">
<li>
<p>If the TSS indicates that the signature_algorithms extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the signature_algorithms extension.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="353">
<li>
<p>If the TSF provides the ability of configuring the list of supported ciphersuites, the evaluator shall verify that AGD guidance includes configuration of the list of supported ciphersuites.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="354">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_42">4.2.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="355">
<li>
<p>For clarification: DTLS communication packets might be received in a different order than sent due to the use of the UDP protocol. All tests requiring a specific order of test steps ("before", "after") are therefore referring to the sequence numbering of DTLS packets.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="356">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall establish a DTLS connection using each of the ciphersuites specified by the requirement. This connection may be established as part of the establishment of a higher-level application protocol, e.g., as part of a syslog session. It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</p>
<div class="paragraph">
<p>The goal of the following test is to verify that the TOE accepts only certificates with appropriate values in the extendedKeyUsage extension, and implicitly that the TOE correctly parses the extendedKeyUsage extension as part of X.509v3 server certificate validation.</p>
</div>
</li>
<li>
<p>Test 2: The evaluator shall establish the connection with a server presenting a certificate that contains the serverAuth (OID 1.3.6.1.5.5.7.3.1) in the extendedKeyUsage extension and verify that the connection successfully negotiated. The evaluator will then verify that when the same server presents an otherwise valid server certificate that contains the extendedKeyUsage extension without serverAuth the client rejects the connection. Ideally, the two certificates should be identical except for the OID values.</p>
</li>
<li>
<p>Test 3 [conditional]: Perform this test only if support of DTLS 1.2 is claimed. The evaluator shall send a server certificate in the DTLS connection that does not match the server-selected ciphersuite (for example, send an ECDSA certificate while using the TLS_RSA_WITH_AES_128_CBC_SHA ciphersuite). The evaluator shall verify that the TOE disconnects after receiving the server’s Certificate handshake message.</p>
</li>
<li>
<p>Test 4: The evaluator shall perform the following 'negative tests':</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>[conditional]: Perform this test only if support of DTLS 1.2 is claimed. The evaluator shall configure the server to select the TLS_NULL_WITH_NULL_NULL ciphersuite and verify that the TOE DTLS client denies the connection.</p>
</li>
<li>
<p>Modify the server’s selected ciphersuite in the Server Hello handshake message to be a ciphersuite (compatible with the server-selected version of DTLS) not presented in the Client Hello handshake message. The evaluator shall verify that the TOE DTLS client rejects the connection after receiving the Server Hello.</p>
</li>
<li>
<p>The evaluator shall attempt to establish a DTLS connection using each of the supported DTLS versions (i.e. DTLS 1.3, DTLS 1.2). The evaluator shall verify that the versions specified in FCS_DTLSC_EXT.1.1 are successfully established and all other versions are rejected by the TOE DTLS client. The evaluator must ensure the ServerHello is valid for the DTLS version being negotiated. If the TOE includes the Supported Versions extension in its ClientHello, the evaluator shall also ensure the version(s) specified in the extension match the version(s) in FCS_DTLSC_EXT.1.1.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 5: The evaluator shall perform the following modifications to the traffic (i.e. Man-in-the-middle modifications that result in invalid signatures and MACs):</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>[conditional]: Perform this test only if support of DTLS 1.2 is claimed. If using DHE or ECDH ciphersuites, modify the signature block in the Server’s Key Exchange handshake message, and verify that the client denies the connection and no application data flows. The handshake shall be valid (e.g. the Finished message is calculated using the modified signature), with the exception of the invalid signature. This test does not apply to cipher suites using RSA key exchange. If a TOE only supports RSA key exchange in conjunction with DTLS then this test shall be omitted.</p>
</li>
<li>
<p>[conditional]: Perform this test only if support of DTLS 1.3 is claimed. Modify the signature block in the Server’s Certificate Verify handshake message, and verify that the client denies the connection and no application data flows. The handshake shall be valid (e.g. the Finished message is calculated using the modified signature), with the exception of the invalid signature.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 6: The evaluator shall perform the following 'scrambled message tests':</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Modify a byte in the Server Finished handshake message and verify that the handshake is not finished successfully and no application data flows. (<em>Note: This modification must be performed prior to the contents of the Finished message being encrypted.)</em></p>
</li>
<li>
<p>[conditional]: Perform this test only if support of DTLS 1.2 is claimed. Send a correctly sequenced datagram (i.e., DTLS message with an expected sequence number) with a garbled unfragmented payload from the Server after the Server issued the ChangeCipherSpec message and verify that the Client handshake is not finished successfully and no application data flows. <em>Note: The TOE is permitted to continue to retry to complete the DTLS handshake as long as no application data flows.</em></p>
<div class="paragraph">
<p><em>(Note: DTLS 1.3 provides for a dummy ChangeCipherSpec message to aid in middlebox compatibility if such an option is enabled in the specific implementation [see section D.4 in RFC 8446].  If DTLS 1.3 middlebox compatibility mode is enabled a ChangeCipherSpec message may appear in packet traces, but it does not influence the protocol. To be clear: for DTLS 1.3, this test does not need to be performed.)</em></p>
</div>
</li>
<li>
<p>[conditional] Perform this test only if support of DTLS 1.3 is claimed . Send a plaintext EncryptedExtensions message from the server and verify that the handshake is not finished successfully and no application data flows.  <em>(Note: Under DTLS 1.3, the EncryptedExtensions message is the first message to be encrypted with the handshake traffic secret.)</em></p>
</li>
<li>
<p>[conditional]: Perform this test only if support of DTLS 1.2 is claimed. Modify at least one byte in the server’s nonce in the Server Hello handshake message and verify that the client rejects the Server Key Exchange handshake message (if using a DHE or ECDHE ciphersuite) or that the server denies the client’s Finished handshake message.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="357">
<li>
<p>Note that tests 1-6 are only applicable to:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>DTLS-based trusted channel communications according to FTP_ITC.1 and trusted path communications according to FTP_TRP.1</p>
<div class="paragraph">
<p>Or:</p>
</div>
</li>
<li>
<p>DTLS-based trusted channel communications when RFC 6125 is selected for FPT_ITT.1</p>
<div class="paragraph">
<p>Test 7 is only applicable to DTLS-based trusted channel communications when RFC 5280 is selected for FPT_ITT.1. Therefore, all tests are marked as conditional. Note that for some tests additional conditions apply.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>IP addresses are binary values that must be converted to a textual representation when presented in the CN of a certificate. When testing IP addresses in the CN, the evaluator shall follow the following formatting rules:</p>
<div class="ulist">
<ul>
<li>
<p>IPv4: The CN contains a single address that is represented a 32-bit numeric address (IPv4) is written in decimal as four numbers that range from 0-255 separated by periods as specified in RFC 3986.</p>
</li>
<li>
<p>IPv6: The CN contains a single IPv6 address that is represented as eight colon separated groups of four lowercase hexadecimal digits, each group representing 16 bits as specified in RFC 4291. Note: Shortened addresses, suppressed zeros, and embedded IPv4 addresses are not tested..</p>
</li>
</ul>
</div>
</li>
<li>
<p>The evaluator shall configure the reference identifier according to the AGD guidance and perform the following tests during a DTLS connection:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1 [conditional]: The evaluator shall present a server certificate that contains a CN that does not match the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each identifier type (e.g. IPv4, IPv6, FQDN) supported in the CN. When testing IPv4 or IPv6 addresses, the evaluator shall modify a single decimal or hexadecimal digit in the CN.</p>
<div class="paragraph">
<p>Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass Test 1.</p>
</div>
</li>
<li>
<p>Test 2 [conditional]: The evaluator shall present a server certificate that contains a CN that matches the reference identifier, contains the SAN extension, but does not contain an identifier in the SAN that matches the reference identifier. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each supported SAN type (e.g. IPv4, IPv6, FQDN, URI). When testing IPv4 or IPv6 addresses, the evaluator shall modify a single decimal or hexadecimal digit in the SAN.</p>
</li>
<li>
<p>Test 3 [conditional]: If the TOE does not mandate the presence of the SAN extension, the evaluator shall present a server certificate that contains a CN that matches the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection succeeds. The evaluator shall repeat this test for each identifier type (e.g. IPv4, IPv6, FQDN) supported in the CN. If the TOE does mandate the presence of the SAN extension, this test shall be omitted.</p>
</li>
<li>
<p>Test 4 [conditional]: The evaluator shall present a server certificate that contains a CN that does not match the reference identifier but does contain an identifier in the SAN that matches. The evaluator shall verify that the connection succeeds. The evaluator shall repeat this test for each supported SAN type (e.g. IPv4, IPv6, FQDN, SRV).</p>
</li>
<li>
<p>Test 5 [conditional]: The evaluator shall perform the following wildcard tests with each supported type of reference identifier that includes a DNS name (i.e. CN-ID with DNS, DNS-ID, SRV-ID, URI-ID):</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>[conditional]: The evaluator shall present a server certificate containing a wildcard that is not in the left-most label of the presented identifier (e.g. foo.*.example.com) and verify that the connection fails.</p>
</li>
<li>
<p>[conditional]: The evaluator shall present a server certificate containing a wildcard in the left-most label (e.g. *.example.com). The evaluator shall configure the reference identifier with a single left-most label (e.g. foo.example.com) and verify that the connection succeeds, if wildcards are supported, or fails if wildcards are not supported. The evaluator shall configure the reference identifier without a left-most label as in the certificate (e.g. example.com) and verify that the connection fails. The evaluator shall configure the reference identifier with two left-most labels (e.g. bar.foo.example.com) and verify that the connection fails. (Remark: Support for wildcards was always intended to be optional. It is sufficient to state that the TOE does not support wildcards and observe rejected connection attempts to satisfy corresponding assurance activities).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 6: Objective: The objective of this test is to ensure the TOE is able to differentiate between IP address identifiers that are not allowed to contain wildcards and other types of identifiers that may contain wildcards.</p>
<div class="paragraph">
<p>[conditional] If IP address identifiers supported in the SAN or CN, the evaluator shall present a server certificate that contains a CN that matches the reference identifier, except one of the groups has been replaced with a wildcard asterisk (*) (e.g. CN=*.168.0.1 when connecting to 192.168.0.1.</p>
</div>
<div class="paragraph">
<p>Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass Test 6.</p>
</div>
</li>
<li>
<p>Test 7 [conditional] If the secure channel is used for FPT_ITT, and RFC 5280 is selected, the evaluator shall perform the following tests. Note, when multiple attribute types are selected in the SFR (e.g. when multiple attribute types are combined to form the unique identifier), the evaluator modifies each attribute type in accordance with the matching criteria described in the TSS (e.g. creating a mismatch of one attribute type at a time while other attribute types contain values that will match a portion of the reference identifier:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall present a server certificate that does not contain an identifier in the Subject (DN) attribute type(s) that matches the reference identifier. The evaluator shall verify that the connection fails.</p>
</li>
<li>
<p>The evaluator shall present a server certificate that contains a valid identifier as an attribute type other than the expected attribute type (e.g. if the TOE is configured to expect id-at-serialNumber=correct_identifier, the certificate could instead include id-at-name=correct_identifier), and does not contain the SAN extension. The evaluator shall verify that the connection fails. Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass this test.</p>
</li>
<li>
<p>The evaluator shall present a server certificate that contains a Subject attribute type that matches the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection succeeds.</p>
</li>
<li>
<p>The evaluator shall confirm that all use of wildcards results in connection failure regardless of whether the wildcards are used in the left or right side of the presented identifier. (Remark: Use of wildcards is not addressed within RFC 5280.)</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="360">
<li>
<p>The evaluator shall demonstrate that using an invalid certificate results in the function failing as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: Using the administrative guidance, the evaluator shall load a CA certificate or certificates needed to validate the presented certificate used to authenticate an external entity and demonstrate that the function succeeds and a trusted channel can be established.</p>
</li>
<li>
<p>Test 2: The evaluator shall then change the presented certificate(s) so that validation fails and show that the certificate is not automatically accepted. The evaluator shall repeat this test to cover the selected types of failure defined in the SFR (i.e. the selected ones from failed matching of the reference identifier, failed validation of the certificate path, failed validation of the expiration date, failed determination of the revocation status). The evaluator shall perform the action indicated in the SFR selection observing the TSF resulting in the expected state for the trusted channel (e.g. trusted channel was established) covering the types of failure for which an override mechanism is defined.</p>
</li>
<li>
<p>Test 3 [conditional]: The purpose of this test to verify that only selected certificate validation failures could be administratively overridden. If any override mechanism is defined for failed certificate validation, the evaluator shall configure a new presented certificate that does not contain a valid entry in one of the mandatory fields or parameters (e.g. inappropriate value in extendedKeyUsage field) but is otherwise valid and signed by a trusted CA. The evaluator shall confirm that the certificate validation fails (i.e. certificate is rejected), and there is no administrative override available to accept such certificate.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="361">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1 [conditional]: If “not present the Supported Groups Extension” is selected, the evaluator shall examine the Client Hello message and verify it does not contain the Supported Groups extension.</p>
</li>
<li>
<p>Test 2 [conditional]: If “present the Supported Groups Extension” is selected, the evaluator shall configure the server to perform ECDHE or DHE (as applicable) key exchange using each of the TOE’s supported groups. The evaluator shall verify that the connection succeeds. This test shall be repeated for each type of key exchange message/extension supported (i.e. Key Share extension for DTLS 1.3 and Server Key Exchange Message for DTLS 1.2).</p>
</li>
<li>
<p>Test 3 [conditional]: If secp groups are selected, the evaluator shall configure the server to perform an ECDHE key exchange in the DTLS connection using a non-supported curve and shall verify that the connection fails and no application data flows. The non-supported curve shall be as similar to the selected curve(s) as possible (i.e. a non-selected curve when not all curves are selected or P-224). This test shall be repeated for each type of key exchange message/extension supported (i.e. Key Share extension for DTLS 1.3 and Server Key Exchange Message for DTLS 1.2).</p>
</li>
<li>
<p>Test 4 [conditional]: If ffdhe curves are selected, the evaluator shall configure the server to perform an DHE key exchange in the DTLS connection using a non-supported group and shall verify that the connection fails and no application data flows. The non-supported group shall be as similar to the selected group(s) as possible (i.e. a non-selected group when not all groups are selected or undefined Codepoint 0x0105 (ffdhe8192 + 1)). This test shall be repeated for each type of key exchange message/extension supported (i.e. Key Share extension for DTLS 1.3 and Server Key Exchange Message for DTLS 1.2).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="362">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1 [conditional]: If “not present the signature_algorithms extension” is selected, the evaluator shall examine the Client Hello message and verify it does not contain the signature_algorihtms extension or the signature_algorithms_cert extension.</p>
</li>
<li>
<p>Test 2 [conditional]: The evaluator shall perform the following tests if “present the signature_algorithms extension” is selected:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall examine the Client Hello message and verify it contains the signature_algorihtms extension and the SignatureSchemes match the SignatureSchemes specified in the requirement.</p>
</li>
<li>
<p>The evaluator shall establish a DTLS connection using each of the SignatureSchemes specified by the requirement and observes the session is successfully completed. The evaluator shall ensure the test server sends a leaf Certificate that has a public key algorithm that is consistent with the SignatureScheme being tested. For DTLS 1.2 and if the ciphersuite is DHE or ECDHE, the evaluator shall ensure that the server sends Server Key Exchange messages consistent with the SignatureScheme being tested. For DTLS 1.3, the evaluator shall ensure that the server sends Certificate Verify messages consistent with the SignatureScheme being tested.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 3 [conditional]: The evaluator shall perform the following tests if “present the signature_algorithms_cert extension” is selected:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall examine the Client Hello message and verify it contains the signature_algorihtms_cert extension and the SignatureSchemes match the SignatureSchemes specified in the requirement.</p>
</li>
<li>
<p>The evaluator shall establish a DTLS connection using a certificate chain using each of the SignatureSchemes specified by the requirement. The evaluator shall ensure the signatures used in the certificate chain are consistent with the SignatureScheme being tested.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="363">
<li>
<p>[conditional]: If the TSF provides the ability of configuring the list of supported ciphersuites, the evaluator shall establish a DTLS connection using one of the possible configurations of the list of supported ciphersuites. The evaluator shall then change the configuration and repeat the test. The evaluator shall verify that the behavior of the TOE has changed according to the modification of the list of ciphers. This test shall be repeated for all supported DTLS versions. If the TSF does not provide the ability of configuring the list of supported ciphersuites, this test shall be omitted.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSC_EXT.1.7</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="364">
<li>
<p>The evaluator shall establish a DTLS connection with a server and observe that the early data extension and the post-handshake client authentication extension according to RFC 9147, section 5.8.4 are not advertised in the Client Hello Message. This test shall be executed for all DTLS versions supported by the TOE.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_dtlss_ext_1_extended_dtls_server_protocol">4.2.2. FCS_DTLSS_EXT.1 Extended: DTLS Server Protocol</h4>
<div class="sect4">
<h5 id="_tss_42">4.2.2.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="365">
<li>
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. The evaluator shall check the TSS to ensure that the ciphersuites specified are identical to those listed for this component.</p>
</li>
<li>
<p>The evaluator shall verify that the TSS contains a description of how the TOE technically prevents the use of unsupported and undefined DTLS versions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="367">
<li>
<p>The evaluator shall verify that the TSS describes how the DTLS Client IP address is validated prior to issuing a ServerHello message. The evaluator shall confirm that the TSS describes how the server presents a HelloVerify message (DTLS 1.2)/HelloRetry message (DTLS 1.3) containing a cookie and how the cookie is validated when the server receives the subsequent Client Hello message.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="368">
<li>
<p>The evaluator shall verify that the TSS describes the algorithms and key sizes the TSF supports for authenticating itself to DTLS clients. The evaluator shall ensure these algorithms are consistent with the selected ciphersuites.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="369">
<li>
<p>The evaluator shall verify that the TSS lists all EC Diffie-Hellman curves and/or Diffie-Hellman groups used in the key establishment by the TOE when acting as a DTLS Server. The evaluator shall ensure these algorithms are consistent with the selected ciphersuites.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="370">
<li>
<p>The evaluator shall verify that the TSS describes the actions that take place if a message received from the DTLS Client fails the MAC integrity check.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="371">
<li>
<p>The evaluator shall verify that TSS describes how replay is detected and silently discarded for DTLS records that have previously been received and too old to fit in the sliding window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.7</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="372">
<li>
<p>The evaluator shall verify that the TSS describes if session resumption based on session IDs is supported (RFC 4346 and/or RFC 5246) and/or if session resumption based on session tickets is supported (RFC 5077) and/or if session resumption according to RFC8446 is supported.</p>
</li>
<li>
<p>If session tickets are supported, the evaluator shall verify that the TSS describes that the session tickets are encrypted using symmetric algorithms consistent with FCS_COP.1/DataEncryption. The evaluator shall verify that the TSS identifies the key lengths and algorithms used to protect session tickets.</p>
</li>
<li>
<p>If session tickets are supported, the evaluator shall verify that the TSS describes that session tickets adhere to the structural format provided in section 4 of RFC 5077 and if not, a justification shall be given of the actual session ticket format.</p>
</li>
<li>
<p>If the TOE claims a DTLS server capable of session resumption (as a single context, or across multiple contexts), the evaluator verifies that the TSS describes how session resumption operates (i.e. what would trigger a full handshake, e.g. checking session status, checking Session ID, etc.). If multiple contexts are used, the TSS describes how session resumption is coordinated across those contexts. In case session establishment and session resumption are always using a separate context, the TSS shall describe how the contexts interact with respect to session resumption (in particular regarding the session ID). It is acceptable for sessions established in one context to be resumable in another context.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="376">
<li>
<p>The evaluator shall verify that TSS describes whether the list of supported ciphersuites can be configured or not.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.10</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="377">
<li>
<p>The evaluator shall verify in the TSS that, for DTLS 1.3, the TOE shall not permit out-of-band provisioning of pre-shared keys (PSKs) in the evaluated configuration.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_42">4.2.2.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="378">
<li>
<p>The evaluator shall also check the guidance documentation to ensure that it contains instructions on configuring the TOE so that DTLS conforms to the description in the TSS (for instance, the set of ciphersuites advertised by the TOE or DTLS versions supported by the TOE may have to be restricted to meet the requirements).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="379">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="380">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.7</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="381">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="382">
<li>
<p>If the TSF provides the ability of configuring the list of supported ciphersuites, the evaluator shall verify that AGD guidance includes configuration of the list of supported ciphersuites.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.10</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="383">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_43">4.2.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="384">
<li>
<p>For clarification: For DTLS communication packets might be received in a different order than sent due to the use of the UDP protocol. All tests requiring a specific order of test steps ("before", "after") are therefore referring to the sequence numbering of DTLS packets.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="385">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall establish a DTLS connection using each of the ciphersuites specified by the requirement. This connection may be established as part of the establishment of a higher-level application protocol, e.g., as part of a syslog session. It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic in an attempt to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</p>
</li>
<li>
<p>Test 2: The evaluator shall perform the following tests:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall send a Client Hello to the server with a list of ciphersuites that does not contain any of the ciphersuites in the server’s ST and verify that the server denies the connection.</p>
</li>
<li>
<p>[conditional]: Perform this test only if support of DTLS 1.2 is claimed. The evaluator shall send a Client Hello to the server containing only the TLS_NULL_WITH_NULL_NULL ciphersuite and verify that the server denies the connection.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 3: The evaluator shall perform the following modifications to the traffic:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>[conditional]: Perform this test only if support of DTLS 1.2 is claimed. Modify a byte in the Client Finished handshake message and verify that the server rejects the connection and does not send any application data.</p>
</li>
<li>
<p>(The intent of this test is to ensure that the server&#8217;s DTLS implementation immediately makes use of the key exchange and authentication algorithms to: a) Correctly encrypt DTLS Finished message and b) Encrypt every DTLS message after session keys are negotiated.)</p>
<div class="paragraph">
<p>[conditional]: Perform this test only if support of DTLS 1.2 is claimed. The evaluator shall use one of the claimed ciphersuites to complete a successful handshake and observe transmission of properly encrypted application data. The evaluator shall verify that no Alert with alert level Fatal (2) messages were sent.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify that the Finished message (Content type hexadecimal 16 and handshake message type hexadecimal 14) is sent immediately after the server&#8217;s ChangeCipherSpec (Content type hexadecimal 14) message. The evaluator shall examine the Finished message (encrypted example in hexadecimal of a TLS record containing a Finished message, 16 03 03 00 40 11 22 33 44 55&#8230;&#8203;) and confirm that it does not contain unencrypted data (unencrypted example in hexadecimal of a DTLS record containing a Finished message, 16 03 03 00 40 14 00 00 0c&#8230;&#8203;), by verifying that the first byte of the encrypted Finished message does not equal hexadecimal 14 for at least one of three test messages. There is a chance that an encrypted Finished message contains a hexadecimal value of '14' at the position where a plaintext Finished message would contain the message type code '14'. If the observed Finished message contains a hexadecimal value of '14' at the position where the plaintext Finished message would contain the message type code, the test shall be repeated three times in total. In case the value of '14' can be observed in all three tests it can be assumed that the Finished message has indeed been sent in plaintext and the test has to be regarded as 'failed'. Otherwise it has to be assumed that the observation of the value '14' has been due to chance and that the Finished message has indeed been sent encrypted. In that latter case the test shall be regarded as 'passed'.</p>
</div>
</li>
<li>
<p>[conditional]: Perform this test only if support of DTLS 1.3 is claimed. The evaluator shall use a client to send a Client Hello message containing a single curve in the Supported Groups extension. The curve that is selected to be presented in this extension should not be supported by the TOE. The evaluator shall verify that the TOE disconnects after receiving the Client Hello message.</p>
</li>
<li>
<p>[conditional]: Perform this test only if support of DTLS 1.3 is claimed. The evaluator shall use a client to send a Client Hello message containing multiple curves in the Supported Groups extension. These curves should be chosen such that only one of these curves is supported by the TOE. The evaluator shall verify that the TOE responds with a Hello Retry Request message selecting the supported curve. This shall be reflected in the Key Share extension of the Hello Retry Request message.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 4: The evaluator shall attempt to establish a DTLS connection using each of the supported DTLS versions (i.e., DTLS 1.3, DTLS 1.2). The client shall be configured so it only supports the version being tested. The evaluator shall verify that the versions specified in FCS_DTLSS_EXT.1.1 are successfully established and all other versions not successfully established. If the TOE attempts to downgrade the version, it is acceptable for the test client to terminate the connection; however, the version selected by the TOE shall always be a version specified in FCS_DTLSS_EXT.1.1.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="386">
<li>
<p>The DTLS server shall present a HelloRetryRequest message (DTLS 1.3)/ HelloVerify message (DTLS 1.2) containing a cookie. In the subsequent client hello message sent by the client to the server, the evaluator shall modify at least one byte in the cookie message and verify that the Server rejects the Client’s handshake message.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.3 and FCS_DTLSS_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="387">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1 [conditional]: If ECDHE ciphersuites/groups are supported:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall repeat this test for each supported elliptic curve. The evaluator shall attempt a connection using a supported ECDHE ciphersuite (DTLS 1.2) or group (DTLS 1.3) and a single supported elliptic curve specified in the supported groups extension. The evaluator shall verify (through a packet capture or instrumented client) that the TOE selects the same curve in the Server Key Exchange (DTLS 1.2) or Server Hello (key_share, for DTLS 1.3) message and successfully establishes the connection.</p>
</li>
<li>
<p>The evaluator shall attempt a connection using a supported_groups extension containing a single unsupported elliptic curve (e.g. secp192r1 (0x13)). Note: For DTLS 1.2 connections, a single supported ECDHE ciphersuite shall be proposed. The evaluator shall verify that the TOE does not send a Server Hello message and the connection is not successfully established.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 2 [conditional]: If DHE ciphersuites are supported, the evaluator shall repeat the following test for each supported parameter size. If any configuration is necessary, the evaluator shall configure the TOE to use a supported Diffie-Hellman parameter size. The evaluator shall attempt a connection using a supported DHE ciphersuite.</p>
<div class="paragraph">
<p>For DTLS 1.2, the evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a Server Key Exchange Message where p Length is consistent with the configured Diffie-Hellman parameter size(s).</p>
</div>
<div class="paragraph">
<p>For DTLS 1.3, the evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a Server Key Share Extension Message where the KeyShareServerHello structure contains a KeyShareEntry structure with an opaque key_exchange value whose Length is consistent with the configured Diffie-Hellman parameter size(s).</p>
</div>
</li>
<li>
<p>Test 3 [conditional]: If RSA key establishment ciphersuites are supported, the evaluator shall repeat this test for each RSA key establishment key size. If any configuration is necessary, the evaluator shall configure the TOE to perform RSA key establishment using a supported key size (e.g. by loading a certificate with the appropriate key size). The evaluator shall attempt a connection using a supported RSA key establishment ciphersuite. The evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a certificate whose modulus is consistent with the configured RSA key size.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="388">
<li>
<p>The evaluator shall establish a connection using a client.  The evaluator will then modify at least one byte in a record message, and verify that the Server discards the record or terminates the DTLS session.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="389">
<li>
<p>The evaluator shall set up a DTLS connection. The evaluator shall then capture traffic sent from the DTLS Client to the TOE. The evaluator shall retransmit copies of this traffic to the TOE in order to impersonate the DTLS Client. The evaluator shall observe that the TSF does not take action in response to receiving these packets and that the audit log indicates that the replayed traffic was discarded.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.7</strong></p>
</div>
<div class="paragraph">
<p><em>Test Objective: To demonstrate that the TOE will not resume a session for which the client failed to complete the handshake (independent of TOE support for session resumption)</em></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="390">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1 [conditional]: If the TOE does not support session resumption based on session IDs according to  RFC5246 (DTLS 1.2), or session tickets according to RFC5077 (DTLS 1.2) or session resumption according to RFC8446 (DTLS 1.3), the evaluator shall perform the following test:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>For all supported DTLS versions the client shall send a Client Hello with a zero-length session identifier and with a SessionTicket extension containing a zero-length ticket. A non-zero length session identifier for DTLS 1.3 would result in testing compatibility mode which is not the objective of this test. For DTLS 1.3, the evaluator shall ensure that a 'psk_key_exchange_modes' extension is included in the Client Hello.</p>
</li>
<li>
<p>The client verifies the server does not send a NewSessionTicket handshake message (at any point in the handshake).</p>
</li>
<li>
<p>The client verifies the Server Hello message contains a zero-length session identifier. For DTLS 1.2 the client could alternatively pass the following steps (not applicable for DTLS 1.3):</p>
<div class="paragraph">
<p>Note: The following steps are only performed if the ServerHello message contains a non-zero length SessionID.</p>
</div>
</li>
<li>
<p>The client completes the DTLS handshake, captures the SessionID from the ServerHello.</p>
</li>
<li>
<p>The client sends a ClientHello containing the SessionID captured in step d). This can be done e.g. by keeping the DTLS session in step d) open or start a new DTLS session using the SessionID captured in step d).</p>
</li>
<li>
<p>The client verifies the TOE (1) implicitly rejects the SessionID by sending a ServerHello containing a different SessionID and by performing a full handshake (as shown into shown in figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</p>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, the session ID or session ticket may be obtained in one context for resumption in another context. It is possible that one or more contexts may only permit the construction of sessions to be reused in other contexts but not actually permit resumption themselves. For contexts which do not permit resumption, the evaluator is required to verify this behaviour subject to the description provided in the TSS. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Test 2 [conditional]: If the TOE supports session resumption using session IDs according to RFC5246 (TLS 1.2), the evaluator shall perform the following steps (note that for each of these tests, it is not necessary to perform the test case for each supported version of TLS):</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall conduct a successful handshake and capture the TOE-generated session ID in the Server Hello message. The evaluator shall then initiate a new DTLS connection and send the previously captured session ID to show that the TOE resumed the previous session by responding with ServerHello containing the same SessionID immediately followed by ChangeCipherSpec and Finished messages (as shown in figure 2 of RFC 4346 or RFC 5246). When the session is resumed, the evaluator shall verify on the DTLS Client used for performing this test, that the TOE (DTLS Server) has not advertised support for the early data extension.</p>
</li>
<li>
<p>The evaluator shall initiate a handshake and capture the TOE-generated session ID in the Server Hello message. The evaluator shall then, within the same handshake, generate or force an unencrypted fatal Alert message immediately before the client would otherwise send its ChangeCipherSpec message thereby disrupting the handshake. The evaluator shall then initiate a new Client Hello using the previously captured session ID, and verify that the server (1) implicitly rejects the session ID by sending a ServerHello containing a different SessionID and performing a full handshake (as shown in figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</p>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, for each of the above test cases, the session ID may be obtained in one context for resumption in another context. There is no requirement that the session ID be obtained and replayed within the same context subject to the description provided in the TSS. All contexts that can reuse a session ID constructed in another context must be tested. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Test 3 [conditional]: If the TOE supports session tickets according to RFC5077 (supported only by DTLS 1.2), the evaluator shall carry out the following steps (note that for each of these tests, it is not necessary to perform the test case for each supported version of DTLS):</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall permit a successful DTLS handshake to occur in which a session ticket is exchanged with the non-TOE client. The evaluator shall then attempt to correctly reuse the previous session by sending the session ticket in the ClientHello. The evaluator shall confirm that the TOE responds with a ServerHello with an empty SessionTicket extension, NewSessionTicket, ChangeCipherSpec and Finished messages (as seen in figure 2 of RFC 5077). When the session is resumed, the evaluator shall verify on the DTLS Client used for performing this test, that the TOE (DTLS Server) has not advertised support for the early data extension.</p>
</li>
<li>
<p>The evaluator shall permit a successful DTLS handshake to occur in which a session ticket is exchanged with the non-TOE client. The evaluator will then modify the session ticket and send it as part of a new Client Hello message. The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake (as shown in figure 3 or 4 of RFC 5077), or (2) terminates the connection in some way that prevents the flow of application data.</p>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, for each of the above test cases, the session ticket may be obtained in one context for resumption in another context. There is no requirement that the session ticket be obtained and replayed within the same context subject to the description provided in the TSS. All contexts that can reuse a session ticket constructed in another context must be tested. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Test 4 [conditional]: If the TOE supports session resumption according to RFC8446 (supported only by DTLS 1.3), the evaluator shall carry out the following steps:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall permit a successful DTLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator shall then attempt to correctly reuse the previous session by sending the pre-shared key in the ClientHello. The evaluator shall confirm that the TOE responds similarly to figure 3 of RFC 8446 after successfully reusing the pre-shared-key to resume the session. Specifically, the server must not send back a Certificate message if the session is correctly resumed. When the session is resumed, the evaluator shall verify on the DTLS Client used for performing this test, that the TOE (DTLS Server) has not advertised support for the early data extension.</p>
</li>
<li>
<p>The evaluator shall permit a successful DTLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator will then modify the pre-shared key and send it as part of a new Client Hello message.  The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake, or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
<li>
<p>The evaluator shall permit a successful DTLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator will then force the non-TOE client to attempt to establish a new connection using the previous session ticket material as a pre-shared key, but set psk_key_exchange_modes with a value of psk_ke in the Client Hello message and omit the psk_ke_dhe.  The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake, or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="391">
<li>
<p>If the TSF provides the ability of configuring the list of supported ciphersuites, the evaluator shall establish a DTLS connection using one of the possible configurations of the list of supported ciphersuites. The evaluator shall then change the configuration and repeat the test. The evaluator shall verify that the behavior of the TOE has changed according to the modification of the list of ciphers. This test shall be repeated for all supported DTLS versions. If the TSF does not provide the ability of configuring the list of supported ciphersuites, this test shall be omitted.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_DTLSS_EXT.1.9</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="392">
<li>
<p>According to RFC8446 section 4.2.10, a PSK is required to use the early data extension. As NDcPP only allows the use of PSK in conjunction with session resumption, a NDcPP conformant TOE which acts as DTLS Server cannot use the early data extension if session resumption is not supported. For TOEs that do not support session resumption, execution of test FCS_DTLSS_EXT.1.7 Test 1 is regarded as sufficient that the TOE does not support the early data extension. For TOEs that support session resumption, FCS_DTLSS_EXT.1.7 Test 2(i), 3(i) or 4(i) (depending on the supported DTLS versions and the way session resumption is implemented) ensure that the TOE does not support the early data extension.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_https_ext_1_https_protocol">4.2.3. FCS_HTTPS_EXT.1 HTTPS Protocol</h4>
<div class="sect4">
<h5 id="_tss_43">4.2.3.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="393">
<li>
<p>The evaluator shall examine the TSS and determine that enough detail is provided to explain how the implementation complies with RFC 2818.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_43">4.2.3.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="394">
<li>
<p>The evaluator shall examine the guidance documentation to verify it instructs the Administrator how to configure TOE for use as an HTTPS client or HTTPS server.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_44">4.2.3.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="395">
<li>
<p>This test is now performed as part of FIA_X509_EXT.1/Rev testing.</p>
</li>
<li>
<p>Tests are performed in conjunction with the TLS evaluation activities.</p>
</li>
<li>
<p>If the TOE is an HTTPS client or an HTTPS server utilizing X.509 client authentication, then the certificate validity shall be tested in accordance with testing performed for FIA_X509_EXT.1.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_ipsec_ext_1_ipsec_protocol">4.2.4. FCS_IPSEC_EXT.1 IPsec Protocol</h4>
<div class="sect4">
<h5 id="_tss_44">4.2.4.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="398">
<li>
<p>The evaluator shall examine the TSS and determine that it describes what takes place when a packet is processed by the TOE, e.g., the algorithm used to process the packet. The TSS describes how the SPD is implemented and the rules for processing both inbound and outbound packets in terms of the IPsec policy. The TSS describes the rules that are available and the resulting actions available after matching a rule. The TSS describes how those rules and actions form the SPD in terms of the BYPASS (e.g., no encryption), DISCARD (e.g., drop the packet), and PROTECT (e.g., encrypt the packet) actions defined in RFC 4301.</p>
</li>
<li>
<p>As noted in section 4.4.1 of RFC 4301, the processing of entries in the SPD is non-trivial and the evaluator shall determine that the description in the TSS is sufficient to determine which rules will be applied given the rule structure implemented by the TOE. For example, if the TOE allows specification of ranges, conditional rules, etc., the evaluator shall determine that the description of rule processing (for both inbound and outbound packets) is sufficient to determine the action that will be applied, especially in the case where two different rules may apply. This description shall cover both the initial packets (that is, no SA is established on the interface or for that particular packet) as well as packets that are part of an established SA.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="400">
<li>
<p>The evaluator checks the TSS to ensure it states that the VPN can be established to operate in transport mode and/or tunnel mode (as identified in FCS_IPSEC_EXT.1.3).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="401">
<li>
<p>The evaluator shall examine the TSS to verify that the selected algorithms are implemented. In addition, the evaluator ensures that the SHA-based HMAC algorithm conforms to the algorithms specified in FCS_COP.1/KeyedHash Cryptographic Operations (for keyed-hash message authentication) and if the SHA-based HMAC function truncated output is utilized it must also be described.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="402">
<li>
<p>The evaluator shall examine the TSS to verify that IKEv1 and/or IKEv2 are implemented.</p>
</li>
<li>
<p>For IKEv1 implementations, the evaluator shall examine the TSS to ensure that, in the description of the IPsec protocol, it states that aggressive mode is not used for IKEv1 Phase 1 exchanges, and that only main mode is used. It may be that this is a configurable option.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="404">
<li>
<p>The evaluator shall ensure the TSS identifies the algorithms used for encrypting the IKEv1 and/or IKEv2 payload, and that the algorithms chosen in the selection of the requirement are included in the TSS discussion.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.7</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="405">
<li>
<p>The evaluator shall ensure the TSS identifies the lifetime configuration method used for limiting the IKEv1 Phase 1 SA lifetime and/or the IKEv2 SA lifetime. The evaluator shall verify that the selection made here corresponds to the selection in FCS_IPSEC_EXT.1.5.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="406">
<li>
<p>The evaluator shall ensure the TSS identifies the lifetime configuration method used for limiting the IKEv1 Phase 2 SA lifetime and/or the IKEv2 Child SA lifetime. The evaluator shall verify that the selection made here corresponds to the selection in FCS_IPSEC_EXT.1.5.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.9</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="407">
<li>
<p>The evaluator shall check to ensure that, for each DH group supported, the TSS describes the process for generating "x". The evaluator shall verify that the TSS indicates that the random number generated that meets the requirements in this PP is used, and that the length of "x" meets the stipulations in the requirement.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.10</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="408">
<li>
<p>If the first selection is chosen, the evaluator shall check to ensure that, for each DH group supported, the TSS describes the process for generating each nonce. The evaluator shall verify that the TSS indicates that the random number generated that meets the requirements in this PP is used, and that the length of the nonces meet the stipulations in the requirement.</p>
</li>
<li>
<p>If the second selection is chosen, the evaluator shall check to ensure that, for each PRF hash supported, the TSS describes the process for generating each nonce. The evaluator shall verify that the TSS indicates that the random number generated that meets the requirements in this PP is used, and that the length of the nonces meet the stipulations in the requirement.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.11</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="410">
<li>
<p>The evaluator shall check to ensure that the DH groups specified in the requirement are listed as being supported in the TSS. If there is more than one DH group supported, the evaluator checks to ensure the TSS describes how a particular DH group is specified/negotiated with a peer.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.12</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="411">
<li>
<p>The evaluator shall check that the TSS describes the potential strengths (in terms of the number of bits in the symmetric key) of the algorithms that are allowed for the IKE and ESP exchanges. The TSS shall also describe the checks that are done when negotiating IKEv1 Phase 2 and/or IKEv2 CHILD_SA suites to ensure that the strength (in terms of the number of bits of key in the symmetric algorithm) of the negotiated algorithm is less than or equal to that of the IKE SA this is protecting the negotiation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.13</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="412">
<li>
<p>The evaluator ensures that the TSS identifies RSA and/or ECDSA as being used to perform peer authentication. The description must be consistent with the algorithms as specified in FCS_COP.1/SigGen Cryptographic Operations (for cryptographic signature).</p>
</li>
<li>
<p>If pre-shared keys are chosen in the selection, the evaluator shall check to ensure that the TSS describes how pre-shared keys are established and used in authentication of IPsec connections. The description in the TSS shall also indicate how pre-shared key establishment is accomplished for TOEs that can generate a pre-shared key as well as TOEs that simply use a pre-shared key.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.14</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="414">
<li>
<p>The evaluator shall ensure that the TSS describes how the TOE compares the peer’s presented identifier to the reference identifier. This description shall include which field(s) of the certificate are used as the presented identifier (DN, Common Name, or SAN). If the TOE simultaneously supports the same identifier type in the CN and SAN, the TSS shall describe how the TOE prioritizes the comparisons (e.g. the result of comparison if CN matches but SAN does not). If the location (e.g. CN or SAN) of non-DN identifier types must explicitly be configured as part of the reference identifier, the TSS shall state this. If the ST author assigned an additional identifier type, the TSS description shall also include a description of that type and the method by which that type is compared to the peer’s presented certificate, including what field(s) are compared and which fields take precedence in the comparison.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_44">4.2.4.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="415">
<li>
<p>The evaluator shall examine the guidance documentation to verify it instructs the Administrator how to construct entries into the SPD that specify a rule for processing a packet. The description includes all three cases – a rule that ensures packets are encrypted/decrypted, dropped, and flow through the TOE without being encrypted. The evaluator shall determine that the description in the guidance documentation is consistent with the description in the TSS, and that the level of detail in the guidance documentation is sufficient to allow the administrator to set up the SPD in an unambiguous fashion. This includes a discussion of how ordering of rules impacts the processing of an IP packet.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="416">
<li>
<p>The evaluator shall confirm that the guidance documentation contains instructions on how to configure the connection in each mode selected.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="417">
<li>
<p>The evaluator checks the guidance documentation to ensure it provides instructions on how to configure the TOE to use the algorithms selected.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="418">
<li>
<p>The evaluator shall check the guidance documentation to ensure it instructs the administrator how to configure the TOE to use IKEv1 and/or IKEv2 (as selected), and how to configure the TOE to perform NAT traversal (if selected).</p>
</li>
<li>
<p>If the IKEv1 Phase 1 mode requires configuration of the TOE prior to its operation, the evaluator shall check the guidance documentation to ensure that instructions for this configuration are contained within that guidance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="420">
<li>
<p>The evaluator ensures that the guidance documentation describes the configuration of all selected algorithms in the requirement.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.7</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="421">
<li>
<p>The evaluator shall verify that the values for SA lifetimes can be configured and that the instructions for doing so are located in the guidance documentation. If time-based limits are supported, configuring the limit may lead to a rekey no later than the specified limit. For some implementations, it may be necessary, though, to configure the TOE with a lower time value to ensure a rekey is performed before the maximum SA lifetime of 24 hours is exceeded (e.g. configure a time value of 23h 45min to ensure the actual rekey is performed no later than 24h). The evaluator shall verify that the guidance documentation allows the Administrator to configure the Phase 1 SA value of 24 hours or provides sufficient instruction about the time value to configure to ensure the rekey is performed no later than the maximum SA lifetime of 24 hours. It is not permitted to configure a value of 24 hours if that leads to an actual rekey after more than 24hours. Currently there are no values mandated for the number of bytes, the evaluator just ensures that this can be configured if selected in the requirement.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="422">
<li>
<p>The evaluator shall verify that the values for SA lifetimes can be configured and that the instructions for doing so are located in the guidance documentation. If time-based limits are supported, configuring the limit may lead to a rekey no later than the specified limit. For some implementations, it may be necessary, though, to configure the TOE with a lower time value to ensure a rekey is performed before the maximum SA lifetime of 8 hours is exceeded (e.g. configure a time value of 7h 45min to ensure the actual rekey is performed no later than 8h). The evaluator shall verify that the guidance documentation allows the Administrator to configure the Phase 2 SA value of 8 hours or provides sufficient instruction about the time value to configure to ensure the rekey is performed no later than the maximum SA lifetime of 8 hours. It is not permitted to configure a value of 8 hours if that leads to an actual rekey after more than 8hours. Currently there are no values mandated for the number of bytes, the evaluator just ensures that this can be configured if selected in the requirement.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.11</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="423">
<li>
<p>The evaluator ensures that the guidance documentation describes the configuration of all algorithms selected in the requirement.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.13</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="424">
<li>
<p>The evaluator ensures the guidance documentation describes how to set up the TOE to use certificates with RSA and/or ECDSA signatures and public keys.</p>
</li>
<li>
<p>The evaluator shall check that the guidance documentation describes how pre-shared keys are to be generated and established. The description in the guidance documentation shall also indicate how pre-shared key establishment is accomplished for TOEs that can generate a pre-shared key as well as TOEs that simply use a pre-shared key.</p>
</li>
<li>
<p>The evaluator will ensure that the guidance documentation describes how to configure the TOE to connect to a trusted CA and ensure a valid certificate for that CA is loaded into the TOE and marked “trusted”.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.14</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="427">
<li>
<p>The evaluator shall ensure that the operational guidance describes all supported identifiers, explicitly states whether the TOE supports the SAN extension or not and includes detailed instructions on how to configure the reference identifier(s) used to check the identity of peer(s). If the identifier scheme implemented by the TOE does not guarantee unique identifiers, the evaluator shall ensure that the operational guidance provides a set of warnings and/or CA policy recommendations that would result in secure TOE use.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_45">4.2.4.3. Tests</h5>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="428">
<li>
<p>The evaluator uses the guidance documentation to configure the TOE to perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall configure the SPD such that there is a rule for dropping a packet, encrypting a packet, and allowing a packet to flow in plaintext. The selectors used in the construction of the rule shall be different such that the evaluator can generate a packet and send packets to the gateway with the appropriate fields (fields that are used by the rule - e.g., the IP addresses, TCP/UDP ports) in the packet header. The evaluator shall perform both positive and negative test cases for each type of rule (e.g. a packet that matches the rule and another that does not match the rule). The evaluator observes via the audit trail, and packet captures that the TOE exhibited the expected behaviour: appropriate packets were dropped, allowed to flow without modification, encrypted by the IPsec implementation.</p>
</li>
<li>
<p>Test 2: The evaluator shall devise several tests that cover a variety of scenarios for packet processing. As with Test 1, the evaluator ensures both positive and negative test cases are constructed. These scenarios must exercise the range of possibilities for SPD entries and processing modes as outlined in the TSS and guidance documentation. Potential areas to cover include rules with overlapping ranges and conflicting entries, inbound and outbound packets, and packets that establish SAs as well as packets that belong to established SAs. The evaluator shall verify, via the audit trail and packet captures, for each scenario that the expected behavior is exhibited, and is consistent with both the TSS and the guidance documentation.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="429">
<li>
<p>The assurance activity for this element is performed in conjunction with the activities for FCS_IPSEC_EXT.1.1.</p>
</li>
<li>
<p>The evaluator uses the guidance documentation to configure the TOE to perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall configure the SPD such that there is a rule for dropping a packet, encrypting a packet, and allowing a packet to flow in plaintext. The evaluator may use the SPD that was created for verification of FCS_IPSEC_EXT.1.1. The evaluator shall construct a network packet that matches the rule to allow the packet to flow in plaintext and send that packet. The evaluator should observe that the network packet is passed to the proper destination interface with no modification. The evaluator shall then modify a field in the packet header; such that it no longer matches the evaluator-created entries (there may be a “TOE created” final entry that discards packets that do not match any previous entries). The evaluator sends the packet and observes that the packet was dropped.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="431">
<li>
<p>The evaluator shall perform the following test(s) based on the selections chosen:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: If tunnel mode is selected, the evaluator uses the guidance documentation to configure the TOE to operate in tunnel mode and also configures a VPN peer to operate in tunnel mode. The evaluator configures the TOE and the VPN peer to use any of the allowable cryptographic algorithms, authentication methods, etc. to ensure an allowable SA can be negotiated. The evaluator shall then initiate a connection from the TOE to connect to the VPN peer. The evaluator observes (for example, in the audit trail and the captured packets) that a successful connection was established using the tunnel mode.</p>
</li>
<li>
<p>Test 2: If transport mode is selected, the evaluator uses the guidance documentation to configure the TOE to operate in transport mode and also configures a VPN peer to operate in transport mode. The evaluator configures the TOE and the VPN peer to use any of the allowed cryptographic algorithms, authentication methods, etc. to ensure an allowable SA can be negotiated. The evaluator then initiates a connection from the TOE to connect to the VPN peer. The evaluator observes (for example, in the audit trail and the captured packets) that a successful connection was established using the transport mode.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="432">
<li>
<p>The evaluator shall configure the TOE as indicated in the guidance documentation configuring the TOE to use each of the supported algorithms, attempt to establish a connection using ESP, and verify that the attempt succeeds.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="433">
<li>
<p>Tests are performed in conjunction with the other IPsec evaluation activities.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: If IKEv1 is selected, the evaluator shall configure the TOE as indicated in the guidance documentation and attempt to establish a connection using an IKEv1 Phase 1 connection in aggressive mode. This attempt should fail. The evaluator should then show that main mode exchanges are supported.</p>
</li>
<li>
<p>Test 2: If NAT traversal is selected within the IKEv2 selection, the evaluator shall configure the TOE so that it will perform NAT traversal processing as described in the TSS and RFC 7296, section 2.23. The evaluator shall initiate an IPsec connection and determine that the NAT is successfully traversed.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="434">
<li>
<p>The evaluator shall configure the TOE to use the ciphersuite under test to encrypt the IKEv1 and/or IKEv2 payload and establish a connection with a peer device, which is configured to only accept the payload encrypted using the indicated ciphersuite. The evaluator will confirm the algorithm was that used in the negotiation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.7</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="435">
<li>
<p>When testing this functionality, the evaluator needs to ensure that both sides are configured appropriately. From the RFC “A difference between IKEv1 and IKEv2 is that in IKEv1 SA lifetimes were negotiated. In IKEv2, each end of the SA is responsible for enforcing its own lifetime policy on the SA and rekeying the SA when necessary. If the two ends have different lifetime policies, the end with the shorter lifetime will end up always being the one to request the rekeying. If the two ends have the same lifetime policies, it is possible that both will initiate a rekeying at the same time (which will result in redundant SAs). To reduce the probability of this happening, the timing of rekeying requests SHOULD be jittered.”</p>
</li>
<li>
<p>Each of the following tests shall be performed for each version of IKE selected in the FCS_IPSEC_EXT.1.5 protocol selection:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: If ‘number of bytes’ is selected as the SA lifetime measure, the evaluator shall configure a maximum lifetime in terms of the number of bytes allowed following the guidance documentation. The evaluator shall configure a test peer with a byte lifetime that exceeds the lifetime of the TOE. The evaluator shall establish a SA between the TOE and the test peer, and determine that once the allowed number of bytes through this SA is exceeded, a new SA is negotiated. The evaluator shall verify that the TOE initiates a Phase 1 negotiation.</p>
</li>
<li>
<p>Test 2: If ‘length of time’ is selected as the SA lifetime measure, the evaluator shall configure a maximum lifetime no later than 24 hours for the Phase 1 SA following the guidance documentation. The evaluator shall configure a test peer with a Phase 1 SA lifetime that exceeds the Phase 1 SA lifetime on the TOE.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="437">
<li>
<p>When testing this functionality, the evaluator needs to ensure that both sides are configured appropriately. From the RFC “A difference between IKEv1 and IKEv2 is that in IKEv1 SA lifetimes were negotiated. In IKEv2, each end of the SA is responsible for enforcing its own lifetime policy on the SA and rekeying the SA when necessary. If the two ends have different lifetime policies, the end with the shorter lifetime will end up always being the one to request the rekeying. If the two ends have the same lifetime policies, it is possible that both will initiate a rekeying at the same time (which will result in redundant SAs). To reduce the probability of this happening, the timing of rekeying requests SHOULD be jittered.”</p>
</li>
<li>
<p>Each of the following tests shall be performed for each version of IKE selected in the FCS_IPSEC_EXT.1.5 protocol selection:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: If ‘number of bytes’ is selected as the SA lifetime measure, the evaluator shall configure a maximum lifetime in terms of the number of bytes allowed following the guidance documentation. The evaluator shall configure a test peer with a byte lifetime that exceeds the lifetime of the TOE. The evaluator shall establish a SA between the TOE and the test peer, and determine that once the allowed number of bytes through this SA is exceeded, a new SA is negotiated. The evaluator shall verify that the TOE initiates a Phase 2 negotiation.</p>
</li>
<li>
<p>Test 2: If ‘length of time’ is selected as the SA lifetime measure, the evaluator shall configure a maximum lifetime no later than 8 hours for the Phase 2 SA following the guidance documentation. The evaluator shall configure a test peer with a Phase 2 SA lifetime that exceeds the Phase 2 SA lifetime on the TOE.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.10</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="439">
<li>
<p>Each of the following tests shall be performed for each version of IKE selected in the FCS_IPSEC_EXT.1.5 protocol selection:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: If the first selection is chosen, the evaluator shall check to ensure that, for each DH group supported, the TSS describes the process for generating each nonce. The evaluator shall verify that the TSS indicates that the random number generated that meets the requirements in this PP is used, and that the length of the nonces meet the stipulations in the requirement.</p>
</li>
<li>
<p>Test 2: If the second selection is chosen, the evaluator shall check to ensure that, for each PRF hash supported, the TSS describes the process for generating each nonce. The evaluator shall verify that the TSS indicates that the random number generated that meets the requirements in this PP is used, and that the length of the nonces meet the stipulations in the requirement.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.11</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="440">
<li>
<p>For each supported DH group, the evaluator shall test to ensure that all supported IKE protocols can be successfully completed using that particular DH group.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.12</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="441">
<li>
<p>The evaluator follows the guidance to configure the TOE to perform the following tests.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: This test shall be performed for each version of IKE supported. The evaluator shall successfully negotiate an IPsec connection using each of the supported algorithms and hash functions identified in the requirements.</p>
</li>
<li>
<p>Test 2: This test shall be performed for each version of IKE supported. The evaluator shall attempt to establish a SA for ESP that selects an encryption algorithm with more strength than that being used for the IKE SA (i.e., symmetric algorithm with a key size larger than that being used for the IKE SA). Such attempts should fail.</p>
</li>
<li>
<p>Test 3: This test shall be performed for each version of IKE supported. The evaluator shall attempt to establish an IKE SA using an algorithm that is not one of the supported algorithms and hash functions identified in the requirements. Such an attempt should fail.</p>
</li>
<li>
<p>Test 4: This test shall be performed for each version of IKE supported. The evaluator shall attempt to establish a SA for ESP (assumes the proper parameters where used to establish the IKE SA) that selects an encryption algorithm that is not identified in FCS_IPSEC_EXT.1.4. Such an attempt should fail.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.13</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="442">
<li>
<p>For efficiency sake, the testing is combined with the testing for FIA_X509_EXT.1, FIA_X509_EXT.2 (for IPsec connections), and FCS_IPSEC_EXT.1.1.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_IPSEC_EXT.1.14</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="443">
<li>
<p>In the context of the tests below, a valid certificate is a certificate that passes FIA_X509_EXT.1 validation checks but does not necessarily contain an authorized subject.</p>
</li>
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1 [conditional]: For each CN/identifier type combination selected, the evaluator shall configure the peer’s reference identifier on the TOE (per the administrative guidance) to match the field in the peer’s presented certificate and shall verify that the IKE authentication succeeds. If the TOE prioritizes CN checking over SAN (through explicit configuration of the field when specifying the reference identifier or prioritization rules), the evaluator shall also configure the SAN so it contains an incorrect identifier of the correct type (e.g. the reference identifier on the TOE is example.com, the CN=example.com, and the SAN:FQDN=otherdomain.com) and verify that IKE authentication succeeds.</p>
</li>
<li>
<p>Test 2 [conditional]: For each SAN/identifier type combination selected, the evaluator shall configure the peer’s reference identifier on the TOE (per the administrative guidance) to match the field in the peer’s presented certificate and shall verify that the IKE authentication succeeds. If the TOE prioritizes SAN checking over CN (through explicit specification of the field when specifying the reference identifier or prioritization rules), the evaluator shall also configure the CN so it contains an incorrect identifier formatted to be the same type (e.g. the reference identifier on the TOE is DNS-ID; identify certificate has an identifier in SAN with correct DNS-ID, CN with incorrect DNS-ID (and not a different type of identifier)) and verify that IKE authentication succeeds.</p>
</li>
<li>
<p>Test 3 [conditional]: For each CN/identifier type combination selected, the evaluator shall:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Create a valid certificate with the CN so it contains the valid identifier followed by ‘\0’. If the TOE prioritizes CN checking over SAN (through explicit specification of the field when specifying the reference identifier or prioritization rules) for the same identifier type, the evaluator shall configure the SAN so it matches the reference identifier.</p>
</li>
<li>
<p>Configure the peer’s reference identifier on the TOE (per the administrative guidance) to match the CN without the ‘\0’ and verify that IKE authentication fails.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 4 [conditional]: For each SAN/identifier type combination selected, the evaluator shall:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Create a valid certificate with an incorrect identifier in the SAN. The evaluator shall configure a string representation of the correct identifier in the DN. If the TOE prioritizes CN checking over SAN (through explicit specification of the field when specifying the reference identifier or prioritization rules) for the same identifier type, the addition/modification shall be to any non-CN field of the DN. Otherwise, the addition/modification shall be to the CN.</p>
</li>
<li>
<p>Configure the peer’s reference identifier on the TOE (per the administrative guidance) to match the correct identifier (expected in the SAN) and verify that IKE authentication fails.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 5 [conditional]: If the TOE supports DN identifier types, the evaluator shall configure the peer’s reference identifier on the TOE (per the administrative guidance) to match the subject DN in the peer’s presented certificate and shall verify that the IKE authentication succeeds.</p>
</li>
<li>
<p>Test 6 [conditional]: If the TOE supports DN identifier types, to demonstrate a bit-wise comparison of the DN, the evaluator shall create the following valid certificates and verify that the IKE authentication fails when each certificate is presented to the TOE:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Duplicate the CN field, so the otherwise authorized DN contains two identical CNs.</p>
</li>
<li>
<p>Append ‘\0’ to a non-CN field of an otherwise authorized DN.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_ntp_ext_1_ntp_protocol">4.2.5. FCS_NTP_EXT.1 NTP Protocol</h4>
<div class="sect4">
<h5 id="_tss_45">4.2.5.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_NTP_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="445">
<li>
<p>The evaluator shall examine the TSS to ensure it identifies the version of NTP supported, how it is implemented and what approach the TOE uses to ensure the timestamp it receives from an NTP timeserver (or NTP peer) is from an authenticated source and the integrity of the time has been maintained.</p>
</li>
<li>
<p>The TOE must support at least one of the methods or may use multiple methods, as specified in the SFR element 1.2. The evaluator shall ensure that each method selected in the ST is described in the TSS, including the version of NTP supported in element 1.1, the message digest algorithms used to verify the authenticity of the timestamp and/or the protocols used to ensure integrity of the timestamp.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_45">4.2.5.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_NTP_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="447">
<li>
<p>The evaluator shall examine the guidance documentation to ensure it provides the Security Administrator instructions as how to configure the version of NTP supported, how to configure multiple NTP servers for the TOE’s time source and how to configure the TOE to use the method(s) that are selected in the ST.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_NTP_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="448">
<li>
<p>For each of the secondary selections made in the ST, the evaluator shall examine the guidance document to ensure it instructs the Security Administrator how to configure the TOE to use the algorithms that support the authenticity of the timestamp and/or how to configure the TOE to use the protocols that ensure the integrity of the timestamp.</p>
<div class="paragraph">
<p><em>Assurance Activity Note:</em></p>
</div>
<div class="paragraph">
<p>Each primary selection in the SFR contains selections that specify a cryptographic algorithm or cryptographic protocol. For each of these secondary selections made in the ST, the evaluator shall examine the guidance documentation to ensure that the documentation instructs the Security Administrator how to configure the TOE to use the chosen option(s).</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_NTP_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="449">
<li>
<p>The evaluator shall examine the guidance documentation to ensure it provides the Security Administrator instructions as how to configure the TOE to not accept broadcast and multicast NTP packets that would result in the timestamp being updated.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_46">4.2.5.3. Tests</h5>
<div class="paragraph">
<p><strong>FCS_NTP_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="450">
<li>
<p>The version of NTP selected in element 1.1 and specified in the ST shall be verified by observing establishment of a connection to an external NTP server known to be using the specified version(s) of NTP. This may be combined with tests of other aspects of FCS_NTP_EXT.1 as described below.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_NTP_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="451">
<li>
<p>The cryptographic algorithms selected in element 1.2 and specified in the ST will have been specified in an FCS_COP SFR and tested in the accompanying Evaluation Activity for that SFR. Likewise, the cryptographic protocol selected in in element 1.2 and specified in the ST will have been specified in an FCS SFR and tested in the accompanying Evaluation Activity for that SFR.</p>
<div class="paragraph">
<p>[conditional] If the message digest algorithm is claimed in element 1.2, the evaluator will change the message digest algorithm used by the NTP server in such a way that the new value does not match the configuration on the TOE and confirms that the TOE does not synchronize to this time source.</p>
</div>
<div class="paragraph">
<p>The evaluator shall use a packet sniffer to capture the network traffic between the TOE and the NTP server. The evaluator uses the captured network traffic, to verify the NTP version, to observe time change of the TOE and uses the TOE’s audit log to determine that the TOE accepted the NTP server’s timestamp update.</p>
</div>
<div class="paragraph">
<p>The captured traffic is also used to verify that the appropriate message digest algorithm was used to authenticate the time source and/or the appropriate protocol was used to ensure integrity of the timestamp that was transmitted in the NTP packets.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_NTP_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="452">
<li>
<p>The evaluator shall configure NTP server(s) to support periodic time updates to broadcast and multicast addresses. The evaluator shall confirm the TOE is configured to not accept broadcast and multicast NTP packets that would result in the timestamp being updated. The evaluator shall check that the time stamp is not updated after receipt of the broadcast and multicast packets.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_NTP_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="453">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall confirm the TOE supports configuration of at least three (3) NTP time sources. The evaluator shall configure at least three NTP servers to support periodic time updates to the TOE. The evaluator shall confirm the TOE is configured to accept NTP packets that would result in the timestamp being updated from each of the NTP servers. The evaluator shall check that the time stamp is updated after receipt of the NTP packets. The purpose of this test to verify that the TOE can be configured to synchronize with multiple NTP servers. It is up to the evaluator to determine that the multi- source update of the time information is appropriate and consistent with the behaviour prescribed by the RFC 1305 for NTPv3 and RFC 5905 for NTPv4.</p>
</li>
<li>
<p>Test 2: (The intent of this test is to ensure that the TOE would only accept NTP updates from configured NTP Servers). The evaluator shall confirm that the TOE would not synchronize to other, not explicitly configured time sources by sending an otherwise valid but unsolicited NTP Server response indicating different time from the TOE’s current system time. This rogue time source needs to be configured in a way (e.g. degrade or disable valid and configured NTP servers) that could plausibly result in unsolicited updates becoming a preferred time source if they are not discarded by the TOE. The TOE is not mandated to respond in a detectable way or audit the occurrence of such unsolicited updates. It is up to the evaluator to craft and transmit unsolicited updates in a way that would be consistent with the behaviour of a correctly-functioning NTP server.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_tlsc_ext_1_extended_tls_client_protocol">4.2.6. FCS_TLSC_EXT.1 Extended: TLS Client Protocol</h4>
<div class="sect4">
<h5 id="_tss_46">4.2.6.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="454">
<li>
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. The evaluator shall check the TSS to ensure that the ciphersuites specified include those listed for this component.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="455">
<li>
<p>The evaluator shall ensure that the TSS describes the client’s method of establishing all reference identifiers from the administrator/application-configured reference identifier, including which types of reference identifiers are supported (e.g. application-specific Subject Alternative Names) and whether IP addresses and wildcards are supported.</p>
</li>
<li>
<p>Note that where a TLS channel is being used between components of a distributed TOE for FPT_ITT.1, the requirements to have the reference identifier established by the administrator are relaxed and the identifier may also be established through a “Gatekeeper” discovery process. The TSS should describe the discovery process and highlight how the reference identifier is supplied to the “joining” component. Where the secure channel is being used between components of a distributed TOE for FPT_ITT.1 and the ST author selected attributes from RFC 5280, the evaluator shall ensure the TSS describes which attribute type, or combination of attributes types, are used by the client to match the presented identifier with the configured identifier. The evaluator shall ensure the TSS presents an argument how the attribute type, or combination of attribute types, uniquely identify the remote TOE component; and the evaluator shall verify the attribute type, or combination of attribute types, is sufficient to support unique identification of the maximum supported number of TOE components.</p>
</li>
<li>
<p>If IP addresses are supported in the CN as reference identifiers, the evaluator shall ensure that the TSS describes the TOE’s conversion of the text representation of the IP address in the CN to a binary representation of the IP address in network byte order. The evaluator shall also ensure that the TSS describes whether canonical format (RFC 5952 for IPv6, RFC 3986 for IPv4) is enforced.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="458">
<li>
<p>If “present the Supported Groups Extension” is selected, the evaluator shall verify that TSS describes the Supported Groups Extension and whether the required behaviour is performed by default or may be configured.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="459">
<li>
<p>The evaluator shall verify that TSS describes the signature_algorithms extension and whether the required behavior is performed by default or may be configured.</p>
</li>
<li>
<p>If “not present the signature_algorithms extension” is selected, the evaluator shall verify that the TSS describes support for at least one RSA ciphersuite, RSA in FCS_COP.1/SigGen, and SHA-1 for FCS_COP.1/Hash.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="461">
<li>
<p>The evaluator shall verify that TSS describes whether the list of supported ciphersuites can be configured or not.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="462">
<li>
<p>The evaluator shall verify in the TSS that, for TLS 1.3, the TOE shall not permit out-of-band provisioning of pre-shared keys (PSKs) in the evaluated configuration.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_46">4.2.6.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="463">
<li>
<p>The evaluator shall check the guidance documentation to ensure that it contains instructions on configuring the TOE so that TLS conforms to the description in the TSS.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="464">
<li>
<p>The evaluator shall ensure that the operational guidance describes all supported identifiers, explicitly states whether the TOE supports the SAN extension or not and includes detailed instructions on how to configure the reference identifier(s) used to check the identity of peer(s). If the identifier scheme implemented by the TOE includes support for IP addresses, the evaluator shall ensure that the operational guidance provides a set of warnings and/or CA policy recommendations that would result in secure TOE use.</p>
</li>
<li>
<p>Where the secure channel is being used between components of a distributed TOE for FPT_ITT.1, the SFR selects attributes from RFC 5280, and FCO_CPC_EXT.1.2 selects “no channel”; the evaluator shall verify the guidance provides instructions for establishing unique reference identifiers based on RFC5280 attributes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="466">
<li>
<p>If the TSS indicates that the Supported Groups Extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the Supported Groups Extension.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="467">
<li>
<p>If the TSS indicates that the signature_algorithms extension must be configured to meet the requirement, the evaluator shall verify that AGD guidance includes configuration of the signature_algorithms extension.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="468">
<li>
<p>If the TSF provides the ability of configuring the list of supported ciphersuites, the evaluator shall verify that AGD guidance includes configuration of the list of supported ciphersuites.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.8</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="469">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_47">4.2.6.3. Tests</h5>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="470">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall establish a TLS connection using each of the ciphersuites specified by the requirement. This connection may be established as part of the establishment of a higher-level protocol, e.g., as part of an HTTPS session. It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</p>
</li>
<li>
<p>Test 2: The evaluator shall establish the connection with a server presenting a certificate that contains the serverAuth (OID 1.3.6.1.5.5.7.3.1) in the extendedKeyUsage extension and verify that the connection successfully negotiated. The evaluator will then verify that when the same server presents an otherwise valid server certificate that contains the extendedKeyUsage extension without serverAuth the client rejects the connection. Ideally, the two certificates should be identical except for the OID values.</p>
</li>
<li>
<p>Test 3 [conditional]: Perform this test only if support of TLS 1.2 is claimed. The evaluator shall send a server certificate in the TLS connection that does not match the server-selected ciphersuite (for example, send an ECDSA certificate while using the TLS_RSA_WITH_AES_128_CBC_SHA ciphersuite). The evaluator shall verify that the TOE disconnects after receiving the server’s Certificate handshake message.</p>
</li>
<li>
<p>Test 4: The evaluator shall perform the following 'negative tests':</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>[conditional]: Perform this test only if support of TLS 1.2 is claimed. The evaluator shall configure the server to select the TLS_NULL_WITH_NULL_NULL ciphersuite and verify that the TOE TLS client denies the connection.</p>
</li>
<li>
<p>Modify the server’s selected ciphersuite in the Server Hello handshake message to be a ciphersuite (compatible with the server-selected version of TLS) not presented in the Client Hello handshake message. The evaluator shall verify that the TOE TLS client rejects the connection after receiving the Server Hello.</p>
</li>
<li>
<p>The evaluator shall attempt to establish a TLS connection using each of the supported TLS/SSL versions (i.e. TLS 1.3, TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0, SSL 2.0). The evaluator shall verify that the versions specified in FCS_TLSC_EXT.1.1 are successfully established and all other versions are rejected by the TOE TLS client. The evaluator must ensure the ServerHello is valid for the TLS version being negotiated. If the TOE includes the Supported Versions extension in its ClientHello, the evaluator shall also ensure the version(s) specified in the extension match the version(s) in FCS_TLSC_EXT.1.1.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 5: The evaluator shall perform the following modifications to the traffic (i.e. Man-in-the-middle modifications that result in invalid signatures and MACs):</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>[conditional]: Perform this test only if support of TLS 1.2 is claimed. If using DHE or ECDH ciphersuites, modify the signature block in the Server’s Key Exchange handshake message, and verify that the client denies the connection and no application data flows. The handshake shall be valid (e.g. the Finished message is calculated using the modified signature), with the exception of the invalid signature. This test does not apply to cipher suites using RSA key exchange. If a TOE only supports RSA key exchange in conjunction with TLS, then this test shall be omitted.</p>
</li>
<li>
<p>[conditional]: Perform this test only if support of TLS 1.3 is claimed. Modify the signature block in the Server’s Certificate Verify handshake message, and verify that the client denies the connection and no application data flows. The handshake shall be valid (e.g. the Finished message is calculated using the modified signature), with the exception of the invalid signature.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 6: The evaluator shall perform the following 'scrambled message tests':</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Modify a byte in the Server Finished handshake message and verify that the handshake does not finish successfully and no application data flows. (Note: This modification must be performed prior to the contents of the Finished message being encrypted.)</p>
</li>
<li>
<p>[conditional]:  Perform this test only if support of TLS 1.2 is claimed. Send a garbled message from the server after the server has issued the ChangeCipherSpec message and verify that the handshake is not finished successfully and no application data flows. (Note: TLS 1.3 provides for a dummy ChangeCipherSpec message to aid in middlebox compatibility if such an option is enabled in the specific implementation [see section D.4 in RFC 8446].  If TLS 1.3 middlebox compatibility mode is enabled a ChangeCipherSpec message may appear in packet traces, but it does not influence the protocol. To be clear: for TLS 1.3, this test does not need to be performed.)</p>
</li>
<li>
<p>[conditional]: Perform this test only if support of TLS 1.3 is claimed. Send a plaintext EncryptedExtensions message from the server and verify that the handshake is not finished successfully and no application data flows.  (Note: Under TLS 1.3, the EncryptedExtensions message is the first message to be encrypted with the handshake traffic secret.)</p>
</li>
<li>
<p>[conditional]: Perform this test only if support of TLS 1.2 is claimed. Modify at least one byte in the server’s nonce in the Server Hello handshake message and verify that the client rejects the Server Key Exchange handshake message (if using a DHE or ECDHE ciphersuite) or that the server denies the client’s Finished handshake message.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="471">
<li>
<p>Note that the following tests are marked conditional and are applicable under the following conditions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For TLS-based trusted channel communications according to FTP_ITC.1 where RFC 6125 is selected, tests 1-6 are applicable.</p>
<div class="paragraph">
<p>or</p>
</div>
</li>
<li>
<p>For TLS-based trusted path communications according to FTP_TRP where RFC 6125 is selected, tests 1-6 are applicable.</p>
<div class="paragraph">
<p>or</p>
</div>
</li>
<li>
<p>For TLS-based trusted path communications according to FPT_ITT.1 where RFC 6125 is selected, tests 1-6 are applicable. Where RFC 5280 is selected, only test 7 is applicable.</p>
<div class="paragraph">
<p>Note that for some tests additional conditions apply.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p></p>
<div class="paragraph">
<p>IP addresses are binary values that must be converted to a textual representation when presented in the CN of a certificate. When testing IP addresses in the CN, the evaluator shall follow the following formatting rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IPv4: The CN contains a single address that is represented a 32-bit numeric address (IPv4) is written in decimal as four numbers that range from 0-255 separated by periods as specified in RFC 3986.</p>
</li>
<li>
<p>IPv6: The CN contains a single IPv6 address that is represented as eight colon separated groups of four lowercase hexadecimal digits, each group representing 16 bits as specified in RFC 4291. Note: Shortened addresses, suppressed zeros, and embedded IPv4 addresses are not tested.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The evaluator shall configure the reference identifier according to the AGD guidance and perform the following tests during a TLS connection:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1 [conditional]: The evaluator shall present a server certificate that contains a CN that does not match the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each identifier type (e.g. IPv4, IPv6, FQDN) supported in the CN. When testing IPv4 or IPv6 addresses, the evaluator shall modify a single decimal or hexadecimal digit in the CN.</p>
<div class="paragraph">
<p>Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass Test 1.</p>
</div>
</li>
<li>
<p>Test 2 [conditional]: The evaluator shall present a server certificate that contains a CN that matches the reference identifier, contains the SAN extension, but does not contain an identifier in the SAN that matches the reference identifier. The evaluator shall verify that the connection fails. The evaluator shall repeat this test for each supported SAN type (e.g. IPv4, IPv6, FQDN, URI). When testing IPv4 or IPv6 addresses, the evaluator shall modify a single decimal or hexadecimal digit in the SAN.</p>
</li>
<li>
<p>Test 3 [conditional]: If the TOE does not mandate the presence of the SAN extension, the evaluator shall present a server certificate that contains a CN that matches the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection succeeds. The evaluator shall repeat this test for each identifier type (e.g. IPv4, IPv6, FQDN) supported in the CN. If the TOE does mandate the presence of the SAN extension, this Test shall be omitted.</p>
</li>
<li>
<p>Test 4 [conditional]: The evaluator shall present a server certificate that contains a CN that does not match the reference identifier but does contain an identifier in the SAN that matches. The evaluator shall verify that the connection succeeds. The evaluator shall repeat this test for each supported SAN type (e.g. IPv4, IPv6, FQDN, SRV).</p>
</li>
<li>
<p>Test 5 [conditional]: The evaluator shall perform the following wildcard tests with each supported type of reference identifier that includes a DNS name (i.e. CN-ID with DNS, DNS-ID, SRV-ID, URI-ID):</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>[conditional]: The evaluator shall present a server certificate containing a wildcard that is not in the left-most label of the presented identifier (e.g. foo.*.example.com) and verify that the connection fails.</p>
</li>
<li>
<p>[conditional]: The evaluator shall present a server certificate containing a wildcard in the left-most label (e.g. *.example.com). The evaluator shall configure the reference identifier with a single left-most label (e.g. foo.example.com) and verify that the connection succeeds, if wildcards are supported, or fails if wildcards are not supported. The evaluator shall configure the reference identifier without a left-most label as in the certificate (e.g. example.com) and verify that the connection fails. The evaluator shall configure the reference identifier with two left-most labels (e.g. bar.foo.example.com) and verify that the connection fails. (Remark: Support for wildcards was always intended to be optional. It is sufficient to state that the TOE does not support wildcards and observe rejected connection attempts to satisfy corresponding assurance activities.)</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 6: Objective: The objective of this test is to ensure the TOE is able to differentiate between IP address identifiers that are not allowed to contain wildcards and other types of identifiers that may contain wildcards.</p>
<div class="paragraph">
<p>[conditional] If IP address identifiers supported in the SAN or CN, the evaluator shall present a server certificate that contains a CN that matches the reference identifier, except one of the groups has been replaced with a wildcard asterisk (*) (e.g. CN=*.168.0.1 when connecting to 192.168.0.1.</p>
</div>
<div class="paragraph">
<p>Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass Test 6.</p>
</div>
</li>
<li>
<p>Test 7 [conditional]: If the secure channel is used for FPT_ITT, and RFC 5280 is selected, the evaluator shall perform the following tests. Note, when multiple attribute types are selected in the SFR (e.g. when multiple attribute types are combined to form the unique identifier), the evaluator modifies each attribute type in accordance with the matching criteria described in the TSS (e.g. creating a mismatch of one attribute type at a time while other attribute types contain values that will match a portion of the reference identifier):</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall present a server certificate that does not contain an identifier in the Subject (DN) attribute type(s) that matches the reference identifier. The evaluator shall verify that the connection fails.</p>
</li>
<li>
<p>The evaluator shall present a server certificate that contains a valid identifier as an attribute type other than the expected attribute type (e.g. if the TOE is configured to expect id-at-serialNumber=correct_identifier, the certificate could instead include id-at-name=correct_identifier), and does not contain the SAN extension. The evaluator shall verify that the connection fails. Remark: Some systems might require the presence of the SAN extension. In this case the connection would still fail but for the reason of the missing SAN extension instead of the mismatch of CN and reference identifier. Both reasons are acceptable to pass this test.</p>
</li>
<li>
<p>The evaluator shall present a server certificate that contains a Subject attribute type that matches the reference identifier and does not contain the SAN extension. The evaluator shall verify that the connection succeeds.</p>
</li>
<li>
<p>The evaluator shall confirm that all use of wildcards results in connection failure regardless of whether the wildcards are used in the left or right side of the presented identifier. (Remark: Use of wildcards is not addressed within RFC 5280.)</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="474">
<li>
<p>The evaluator shall demonstrate that using an invalid certificate results in the function failing as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: Using the administrative guidance, the evaluator shall load a CA certificate or certificates needed to validate the presented certificate used to authenticate an external entity and demonstrate that the function succeeds, and a trusted channel can be established.</p>
</li>
<li>
<p>Test 2: The evaluator shall then change the presented certificate(s) so that validation fails and show that the certificate is not automatically accepted. The evaluator shall repeat this test to cover the selected types of failure defined in the SFR (i.e. the selected ones from failed matching of the reference identifier, failed validation of the certificate path, failed validation of the expiration date, failed determination of the revocation status). The evaluator shall perform the action indicated in the SFR selection observing the TSF resulting in the expected state for the trusted channel (e.g. trusted channel was established) covering the types of failure for which an override mechanism is defined.</p>
</li>
<li>
<p>Test 3 [conditional]: The purpose of this test to verify that only selected certificate validation failures could be administratively overridden. If any override mechanism is defined for failed certificate validation, the evaluator shall configure a new presented certificate that does not contain a valid entry in one of the mandatory fields or parameters (e.g. inappropriate value in extendedKeyUsage field) but is otherwise valid and signed by a trusted CA. The evaluator shall confirm that the certificate validation fails (i.e. certificate is rejected), and there is no administrative override available to accept such certificate.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="475">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1 [conditional]: If “not present the Supported Groups Extension” is selected, the evaluator shall examine the Client Hello message and verify it does not contain the Supported Groups extension.</p>
</li>
<li>
<p>Test 2 [conditional]: If “present the Supported Groups Extension” is selected, the evaluator shall configure the server to perform ECDHE or DHE (as applicable) key exchange using each of the TOE’s supported groups. The evaluator shall verify that the connection succeeds. This test shall be repeated for each type of key exchange message/extension supported (i.e. Key Share extension for TLS 1.3 and Server Key Exchange Message for TLS 1.2).</p>
</li>
<li>
<p>Test 3 [conditional]: If secp groups are selected, the evaluator shall configure the server to perform an ECDHE key exchange in the TLS connection using a non-supported curve and shall verify that the connection fails and no application data flows. The non-supported curve shall be as similar to the selected curve(s) as possible (i.e. a non-selected curve when not all curves are selected or P-224). This test shall be repeated for each type of key exchange message/extension supported (i.e. Key Share extension for TLS 1.3 and Server Key Exchange Message for TLS 1.2).</p>
</li>
<li>
<p>Test 4 [conditional]: If ffdhe curves are selected, the evaluator shall configure the server to perform an DHE key exchange in the TLS connection using a non-supported group and shall verify that the connection fails and no application data flows. The non-supported group shall be as similar to the selected group(s) as possible (i.e. a non-selected group when not all groups are selected or undefined Codepoint 0x0105 (ffdhe8192 + 1)). This test shall be repeated for each type of key exchange message/extension supported (i.e. Key Share extension for TLS 1.3 and Server Key Exchange Message for TLS 1.2).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="476">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1 [conditional]: If “not present the signature_algorithms extension” is selected, the evaluator shall examine the Client Hello message and verify it does not contain the signature_algorihtms extension or the signature_algorithms_cert extension.</p>
</li>
<li>
<p>Test 2 [conditional]: The evaluator shall perform the following tests if “present the signature_algorithms extension” is selected:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall examine the Client Hello message and verify it contains the signature_algorihtms extension and the SignatureSchemes match the SignatureSchemes specified in the requirement.</p>
</li>
<li>
<p>The evaluator shall establish a TLS connection using each of the SignatureSchemes specified by the requirement and observes the session is successfully completed. The evaluator shall ensure the test server sends a leaf Certificate that has a public key algorithm that is consistent with the SignatureScheme being tested. For TLS 1.2 and if the ciphersuite is DHE or ECDHE, the evaluator shall ensure that the server sends Server Key Exchange messages consistent with the SignatureScheme being tested. For TLS 1.3, the evaluator shall ensure that the server sends Certificate Verify messages consistent with the SignatureScheme being tested.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 3 [conditional]: The evaluator shall perform the following tests if “present the signature_algorithms_cert extension” is selected:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall examine the Client Hello message and verify it contains the signature_algorihtms_cert extension and the SignatureSchemes match the SignatureSchemes specified in the requirement.</p>
</li>
<li>
<p>The evaluator shall establish a TLS connection using a certificate chain using each of the SignatureSchemes specified by the requirement. The evaluator shall ensure the signatures used in the certificate chain are consistent with the SignatureScheme being tested.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="477">
<li>
<p>[conditional]: If the TSF provides the ability of configuring the list of supported ciphersuites, the evaluator shall establish a TLS connection using one of the possible configurations of the list of supported ciphersuites. The evaluator shall then change the configuration and repeat the test. The evaluator shall verify that the behavior of the TOE has changed according to the modification of the list of ciphers. This test shall be repeated for all supported TLS versions. If the TSF does not provide the ability of configuring the list of supported ciphersuites, this test shall be omitted.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSC_EXT.1.7</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="478">
<li>
<p>The evaluator shall establish a TLS connection with a server and observe that the early data extension and the post-handshake client authentication extension according to RFC8446 Section 4.2 are not advertised in the Client Hello Message. This test shall be executed for all TLS versions supported by the TOE.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcs_tlss_ext_1_extended_tls_server_protocol">4.2.7. FCS_TLSS_EXT.1 Extended: TLS Server Protocol</h4>
<div class="sect4">
<h5 id="_tss_47">4.2.7.1. TSS</h5>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="479">
<li>
<p>The evaluator shall check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. The evaluator shall check the TSS to ensure that the ciphersuites specified are identical to those listed for this component.</p>
</li>
<li>
<p>The evaluator shall verify that the TSS contains a description of how the TOE technically prevents the use of unsupported and undefined SSL and TLS versions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="481">
<li>
<p>The evaluator shall verify that the TSS describes the algorithms and key sizes the TSF supports for authenticating itself to TLS clients. The evaluator shall ensure these algorithms are consistent with the selected ciphersuites.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="482">
<li>
<p>The evaluator shall verify that the TSS lists all EC Diffie-Hellman curves and/or Diffie-Hellman groups used in the key establishment by the TOE when acting as a TLS Server.  The evaluator shall ensure these algorithms are consistent with the selected ciphersuites.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="483">
<li>
<p>The evaluator shall verify that the TSS describes if session resumption based on session IDs is supported (RFC 4346 and/or RFC 5246), if session resumption based on session tickets is supported (RFC 5077) and/or if session resumption according to RFC8446 is supported.</p>
</li>
<li>
<p>If session tickets are supported, the evaluator shall verify that the TSS describes that the session tickets are encrypted using symmetric algorithms consistent with FCS_COP.1/DataEncryption. The evaluator shall verify that the TSS identifies the key lengths and algorithms used to protect session tickets.</p>
</li>
<li>
<p>If session tickets are supported, the evaluator shall verify that the TSS describes that session tickets adhere to the structural format provided in section 4 of RFC 5077 and if not, a justification shall be given of the actual session ticket format.</p>
</li>
<li>
<p>If the TOE claims a TLS server capable of session resumption (as a single context, or across multiple contexts), the evaluator verifies that the TSS describes how session resumption operates (i.e. what would trigger a full handshake, e.g. checking session status, checking Session ID, etc.). If multiple contexts are used, the TSS describes how session resumption is coordinated across those contexts. In case session establishment and session resumption are always using a separate context, the TSS shall describe how the contexts interact with respect to session resumption (in particular regarding the session ID). It is acceptable for sessions established in one context to be resumable in another context.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="487">
<li>
<p>The evaluator shall verify that TSS describes whether the list of supported ciphersuites can be configured or not.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.7</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="488">
<li>
<p>The evaluator shall verify in the TSS that, for TLS 1.3, the TOE shall not permit out-of-band provisioning of pre-shared keys (PSKs) in the evaluated configuration.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_47">4.2.7.2. Guidance Documentation</h5>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="489">
<li>
<p>The evaluator shall check the guidance documentation to ensure that it contains instructions on configuring the TOE so that TLS conforms to the description in the TSS (for instance, the set of ciphersuites advertised by the TOE or TLS version supported by the TOE may have to be restricted to meet the requirements).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.2</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="490">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="491">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.4</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="492">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="493">
<li>
<p>If the TSF provides the ability of configuring the list of supported ciphersuites, the evaluator shall verify that AGD guidance includes configuration of the list of supported ciphersuites.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.7</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="494">
<li>
<p>The evaluator shall verify that any configuration necessary to meet the requirement must be contained in the AGD guidance.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_48">4.2.7.3. Tests</h5>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.1</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="495">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall establish a TLS connection using each of the ciphersuites specified by the requirement. This connection may be established as part of the establishment of a higher-level protocol, e.g., as part of an HTTPS session. It is sufficient to observe the successful negotiation of a ciphersuite to satisfy the intent of the test; it is not necessary to examine the characteristics of the encrypted traffic to discern the ciphersuite being used (for example, that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</p>
</li>
<li>
<p>Test 2: The evaluator shall perform the following tests:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall send a Client Hello to the server with a list of ciphersuites that does not contain any of the ciphersuites in the server’s ST and verify that the server denies the connection.</p>
</li>
<li>
<p>[conditional]: Perform this test only if support of TLS 1.2 is claimed. The evaluator shall send a Client Hello to the server containing only the TLS_NULL_WITH_NULL_NULL ciphersuite and verify that the server denies the connection.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 3: The evaluator shall perform the following modifications to the traffic:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>[conditional]: Perform this test only if support of TLS 1.2 is claimed. Modify a byte in the Client Finished handshake message, and verify that the server rejects the connection and does not send any application data.</p>
</li>
<li>
<p>(The intent of this test is to ensure that the server&#8217;s TLS implementation immediately makes use of the key exchange and authentication algorithms to: a) Correctly encrypt TLS Finished message and b) Encrypt every TLS message after session keys are negotiated.)</p>
<div class="paragraph">
<p>[conditional]: Perform this test only if support of TLS 1.2 is claimed. The evaluator shall use one of the claimed ciphersuites to complete a successful handshake and observe transmission of properly encrypted application data. The evaluator shall verify that no Alert with alert level Fatal (2) messages were sent.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify that the Finished message (Content type hexadecimal 16 and handshake message type hexadecimal 14) is sent immediately after the server&#8217;s ChangeCipherSpec (Content type hexadecimal 14) message. The evaluator shall examine the Finished message (encrypted example in hexadecimal of a TLS record containing a Finished message, 16 03 03 00 40 11 22 33 44 55&#8230;&#8203;) and confirm that it does not contain unencrypted data (unencrypted example in hexadecimal of a TLS record containing a Finished message, 16 03 03 00 40 14 00 00 0c&#8230;&#8203;), by verifying that the first byte of the encrypted Finished message does not equal hexadecimal 14 for at least one of three test messages. There is a chance that an encrypted Finished message contains a hexadecimal value of '14' at the position where a plaintext Finished message would contain the message type code '14'. If the observed Finished message contains a hexadecimal value of '14' at the position where the plaintext Finished message would contain the message type code, the test shall be repeated three times in total. In case the value of '14' can be observed in all three tests it can be assumed that the Finished message has indeed been sent in plaintext and the test has to be regarded as 'failed'. Otherwise it has to be assumed that the observation of the value '14' has been due to chance and that the Finished message has indeed been sent encrypted. In that latter case the test shall be regarded as 'passed'.</p>
</div>
</li>
<li>
<p>[conditional]: Perform this test only if support of TLS 1.3 is claimed. The evaluator shall use a client to send a Client Hello message containing a single curve in the Supported Groups extension. The curve that is selected to be presented in this extension should not be supported by the TOE. The evaluator shall verify that the TOE disconnects after receiving the Client Hello message.</p>
</li>
<li>
<p>[conditional]: Perform this test only if support of TLS 1.3 is claimed. The evaluator shall use a client to send a Client Hello message containing multiple curves in the Supported Groups extension. These curves should be chosen such that only one of these curves is supported by the TOE. The evaluator shall verify that the TOE responds with a Hello Retry Request message selecting the supported curve. This shall be reflected in the Key Share extension of the Hello Retry Request message.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 4: The evaluator shall attempt to establish a TLS/SSL connection using each of the supported TLS/SSL versions (i.e., TLS 1.3, TLS 1.2, TLS 1.1, TLS 1.0, SSL 3.0, SSL 2.0). The client shall be configured so it only supports the version being tested. The evaluator shall verify that the versions specified in FCS_TLSS_EXT.1.1 are successfully established and all other versions not successfully established. If the TOE attempts to downgrade the version, it is acceptable for the test client to terminate the connection; however, the version selected by the TOE shall always be a version specified in FCS_TLSS_EXT.1.1.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.2 and FCS_TLSS_EXT.1.3</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="496">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1 [conditional]: If ECDHE ciphersuites/group are supported:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall repeat this test for each supported elliptic curve. The evaluator shall attempt a connection using a supported ECDHE ciphersuite (TLS 1.2) or group (TLS 1.3) and a single supported elliptic curve specified in the supported groups extension. The Evaluator shall verify (through a packet capture or instrumented client) that the TOE selects the same curve in the Server Key Exchange (TLS 1.2) or Server Hello (key_share, for TLS 1.3) message and successfully establishes the connection.</p>
</li>
<li>
<p>The evaluator shall attempt a connection using a supported ECDHE ciphersuite (TLS 1.2) or group (TLS 1.3) and a single unsupported elliptic curve (e.g. secp192r1 (0x13)) specified in RFC4492, chap. 5.1.1. The evaluator shall verify that the TOE does not send a Server Hello message and the connection is not successfully established.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Test 2 [conditional]: If DHE ciphersuites are supported, the evaluator shall repeat the following test for each supported parameter size. If any configuration is necessary, the evaluator shall configure the TOE to use a supported Diffie-Hellman parameter size. The evaluator shall attempt a connection using a supported DHE ciphersuite.</p>
<div class="paragraph">
<p>For TLS 1.2, the evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a Server Key Exchange Message where p Length is consistent with the message are the ones configured Diffie-Hellman parameter size(s).</p>
</div>
<div class="paragraph">
<p>For TLS 1.3, the evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a Server Key Share Extension Message where the KeyShareServerHello structure contains a KeyShareEntry structure with an opaque key_exchange value whose Length is consistent with the configured Diffie-Hellman parameter size(s).</p>
</div>
</li>
<li>
<p>Test 3 [conditional]: If RSA key establishment ciphersuites are supported, the evaluator shall repeat this test for each RSA key establishment key size. If any configuration is necessary, the evaluator shall configure the TOE to perform RSA key establishment using a supported key size (e.g. by loading a certificate with the appropriate key size). The evaluator shall attempt a connection using a supported RSA key establishment ciphersuite. The evaluator shall verify (through a packet capture or instrumented client) that the TOE sends a certificate whose modulus is consistent with the configured RSA key size.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.4</strong></p>
</div>
<div class="paragraph">
<p><em>Test Objective: To demonstrate that the TOE will not resume a session for which the client failed to complete the handshake (independent of TOE support for session resumption).</em></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="497">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1 [conditional]: If the TOE does not support session resumption based on session IDs according to  RFC5246 (TLS 1.2) or session tickets according to RFC5077 (TLS 1.2) or session resumption according to RFC8446 (TLS 1.3), the evaluator shall perform the following test:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>For all supported TLS versions the client shall send a Client Hello with a zero-length session identifier and with a SessionTicket extension containing a zero-length ticket. A non-zero length session identifier for TLS 1.3 would result in testing compatibility mode which is not the objective of this test. For TLS 1.3, the evaluator shall ensure that a 'psk_key_exchange_modes' extension is included in the Client Hello.</p>
</li>
<li>
<p>The client verifies the server does not send a NewSessionTicket handshake message (at any point in the handshake).</p>
</li>
<li>
<p>The client verifies the Server Hello message contains a zero-length session identifier. For TLS 1.2 the client could alternatively pass the following steps (not applicable for TLS 1.3):</p>
<div class="paragraph">
<p>Note: The following steps are only performed if the ServerHello message contains a non-zero length SessionID.</p>
</div>
</li>
<li>
<p>The client completes the TLS handshake and captures the SessionID from the ServerHello.</p>
</li>
<li>
<p>The client sends a ClientHello containing the SessionID captured in step d). This can be done by keeping the TLS session in step d) open or start a new TLS session using the SessionID captured in step d).</p>
</li>
<li>
<p>The client verifies the TOE (1) implicitly rejects the SessionID by sending a ServerHello containing a different SessionID and by performing a full handshake (as shown in Figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</p>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, the session ID or session ticket may be obtained in one context for resumption in another context. It is possible that one or more contexts may only permit the construction of sessions to be reused in other contexts but not actually permit resumption themselves. For contexts which do not permit resumption, the evaluator is required to verify this behaviour subject to the description provided in the TSS. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Test 2 [conditional]: If the TOE supports session resumption using session IDs according to RFC5246 (TLS 1.2), the evaluator shall carry out the following steps (note that for each of these tests, it is not necessary to perform the test case for each supported version of TLS):</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall conduct a successful handshake and capture the TOE-generated session ID in the Server Hello message. The evaluator shall then initiate a new TLS connection and send the previously captured session ID to show that the TOE resumed the previous session by responding with ServerHello containing the same SessionID immediately followed by ChangeCipherSpec and Finished messages (as shown in Figure 2 of RFC 4346 or RFC 5246). When the session is resumed, the evaluator shall verify on the TLS Client used for performing this test, that the TOE (TLS Server) has not advertised support for the early data extension.</p>
</li>
<li>
<p>The evaluator shall initiate a handshake and capture the TOE-generated session ID in the Server Hello message. The evaluator shall then, within the same handshake, generate or force an unencrypted fatal Alert message immediately before the client would otherwise send its ChangeCipherSpec message thereby disrupting the handshake. The evaluator shall then initiate a new Client Hello using the previously captured session ID, and verify that the server (1) implicitly rejects the session ID by sending a ServerHello containing a different SessionID and performing a full handshake (as shown in figure 1 of RFC 4346 or RFC 5246), or (2) terminates the connection in some way that prevents the flow of application data.</p>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, for each of the above test cases, the session ID may be obtained in one context for resumption in another context. There is no requirement that the session ID be obtained and replayed within the same context subject to the description provided in the TSS. All contexts that can reuse a session ID constructed in another context must be tested. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Test 3 [conditional]: If the TOE supports session tickets according to RFC5077 (supported only by TLS 1.2), the evaluator shall carry out the following steps:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall permit a successful TLS handshake to occur in which a session ticket is exchanged with the non-TOE client. The evaluator shall then attempt to correctly reuse the previous session by sending the session ticket in the ClientHello. The evaluator shall confirm that the TOE responds with an abbreviated handshake described in section 3.1 of RFC 5077 and illustrated with an example in figure 2. Of particular note: if the server successfully verifies the client&#8217;s ticket, then it may renew the ticket by including a NewSessionTicket handshake message after the ServerHello in the abbreviated handshake (which is shown in figure 2). This is not required, however as further clarified in section 3.3 of RFC 5077.  When the session is resumed, the evaluator shall verify on the TLS Client used for performing this test, that the TOE (TLS Server) has not advertised support for the early data extension.</p>
</li>
<li>
<p>The evaluator shall permit a successful TLS handshake to occur in which a session ticket is exchanged with the non-TOE client. The evaluator will then modify the session ticket and send it as part of a new Client Hello message. The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake (as shown in figure 3 or 4 of RFC 5077), or (2) terminates the connection in some way that prevents the flow of application data.</p>
<div class="paragraph">
<p>Remark: If multiple contexts are supported for session resumption, for each of the above test cases, the session ticket may be obtained in one context for resumption in another context. There is no requirement that the session ticket be obtained and replayed within the same context subject to the description provided in the TSS. All contexts that can reuse a session ticket constructed in another context must be tested. It is not mandated that the session establishment and session resumption share context. For example, it is acceptable for a control channel to establish and application channel to resume the session.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Test 4 [conditional]: If the TOE supports session resumption according to RFC8446 (supported only by TLS 1.3), the evaluator shall carry out the following steps:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The evaluator shall permit a successful TLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator shall then attempt to correctly reuse the previous session by sending the pre-shared key in the ClientHello. The evaluator shall confirm that the TOE responds similarly to figure 3 of RFC 8446 after successfully reusing the pre-shared-key to resume the session. Specifically, the server must not send back a Certificate message if the session is correctly resumed. When the session is resumed, the evaluator shall verify on the TLS Client used for performing this test, that the TOE (TLS Server) has not advertised support for the early data extension.</p>
</li>
<li>
<p>The evaluator shall permit a successful TLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator will then modify the pre-shared key and send it as part of a new Client Hello message.  The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake, or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
<li>
<p>The evaluator shall permit a successful TLS handshake to occur in which a session ticket is exchanged with the non-TOE client.  The evaluator will then force the non-TOE client to attempt to establish a new connection using the previous session ticket material as a pre-shared key, but set psk_key_exchange_modes with a value of psk_ke in the Client Hello message and omit the psk_ke_dhe.  The evaluator shall confirm that the TOE either (1) implicitly rejects the session ticket by performing a full handshake, or (2) terminates the connection in some way that prevents the flow of application data.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.5</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="498">
<li>
<p>Test 1[conditional]: If the TSF provides the ability of configuring the list of supported ciphersuites, the evaluator shall establish a TLS connection using one of the possible configurations of the list of supported ciphersuites. The evaluator shall then change the configuration and repeat the test. The evaluator shall verify that the behavior of the TOE has changed according to the modification of the list of ciphers. This test shall be repeated for all supported TLS versions. If the TSF does not provide the ability of configuring the list of supported ciphersuites, this test shall be omitted.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FCS_TLSS_EXT.1.6</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="499">
<li>
<p>According to RFC8446 section 4.2.10, a PSK is required to use the early data extension. As NDcPP only allows the use of PSK in conjunction with session resumption, a NDcPP conformant TOE which acts as TLS Server cannot use the early data extension if session resumption is not supported. For TOEs that do not support session resumption, execution of test FCS_TLSS_EXT.1.4 Test 1 is regarded as sufficient that the TOE does not support the early data extension. For TOEs that support session resumption, FCS_TLSS_EXT.1.4 Test 2(i), 3(i) or 4(i) (depending on the supported TLS versions and the way session resumption is implemented) ensure that the TOE does not support the early data extension.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_identification_and_authentication_fia_3">4.3. Identification and Authentication (FIA)</h3>
<div class="sect3">
<h4 id="_fia_x509_ext_1rev_x_509_certificate_validation">4.3.1. FIA_X509_EXT.1/Rev X.509 Certificate Validation</h4>
<div class="sect4">
<h5 id="_tss_48">4.3.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="500">
<li>
<p>The evaluator shall ensure the TSS describes where the check of validity of the certificates takes place, and that the TSS identifies any of the rules for extendedKeyUsage fields (in FIA_X509_EXT.1.1) that are not supported by the TOE (i.e. where the ST is therefore claiming that they are trivially satisfied). It is expected that revocation checking is performed when a certificate is used in an authentication step and when performing trusted updates (if selected).</p>
</li>
<li>
<p>The TSS shall describe when revocation checking is performed and on what certificates. If the revocation checking during authentication is handled differently depending on whether a full certificate chain or only a leaf certificate is being presented, any differences must be summarized in the TSS section and explained in the Guidance.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_48">4.3.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="502">
<li>
<p>The evaluator shall also ensure that the guidance documentation describes where the check of validity of the certificates takes place, describes any of the rules for extendedKeyUsage fields (in FIA_X509_EXT.1.1) that are not supported by the TOE (i.e. where the ST is therefore claiming that they are trivially satisfied) and describes how certificate revocation checking is performed and on which certificate.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_49">4.3.1.3. Tests</h5>
<div class="paragraph">
<p><strong>FIA_X509_EXT1.1/Rev</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="503">
<li>
<p>The evaluator shall demonstrate that checking the validity of a certificate is performed when a certificate is used in an authentication step or when performing trusted updates (if FPT_TUD_EXT.2 is selected). It is expected that either OCSP or CRL revocation checking is performed when a certificate is presented to the TOE (e.g. during authentication). The evaluator shall perform the following tests for FIA_X509_EXT.1/Rev. These tests must be repeated for each distinct security function that utilizes X.509v3 certificates. For example, if the TOE implements certificate-based authentication with IPSEC and TLS, then it shall be tested with each of these protocols:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1a: The evaluator shall present the TOE with a valid chain of certificates (terminating in a trusted CA certificate) as needed to validate the leaf certificate to be used in the function and shall use this chain to demonstrate that the function succeeds. Test 1a shall be designed in a way that the chain can be 'broken' in Test 1b by either being able to remove the trust anchor from the TOEs trust store, or by setting up the trust store in a way that at least one intermediate CA certificate needs to be provided, together with the leaf certificate from outside the TOE, to complete the chain (e.g. by storing only the root CA certificate in the trust store).</p>
<div class="paragraph">
<p>Test 1b: The evaluator shall then 'break' the chain used in Test 1a by either removing the trust anchor in the TOE&#8217;s trust store used to terminate the chain, or by removing one of the intermediate CA certificates (provided together with the leaf certificate in Test 1a) to complete the chain. The evaluator shall show that an attempt to validate this broken chain fails.</p>
</div>
</li>
<li>
<p>Test 2: The evaluator shall demonstrate that validating an expired certificate results in the function failing.</p>
</li>
<li>
<p>Test 3: The evaluator shall test that the TOE can properly handle revoked certificates-–conditional on whether CRL or OCSP is selected; if both are selected, then a test shall be performed for each method. The evaluator shall test revocation of the peer certificate and revocation of the peer intermediate CA certificate i.e. the intermediate CA certificate should be revoked by the root CA. The evaluator shall ensure that a valid certificate is used, and that the validation function succeeds. The evaluator then attempts the test with a certificate that has been revoked (for each method chosen in the selection) to ensure when the certificate is no longer valid that the validation function fails. Revocation checking is only applied to certificates that are not designated as trust anchors. Therefore, the revoked certificate(s) used for testing shall not be a trust anchor.</p>
</li>
<li>
<p>Test 4: If OCSP is selected, the evaluator shall configure the OCSP server or use a man-in-the-middle tool to present a certificate that does not have the OCSP signing purpose and verify that validation of the OCSP response fails. If CRL is selected, the evaluator shall configure the CA to sign a CRL with a certificate that does not have the cRLsign key usage bit set and verify that validation of the CRL fails.</p>
</li>
<li>
<p>Test 5: The evaluator shall modify any byte in the first eight bytes of the certificate and demonstrate that the certificate fails to validate. (The certificate will fail to parse correctly.)</p>
</li>
<li>
<p>Test 6: The evaluator shall modify any byte in the certificate signatureValue field (see RFC5280 Sec. 4.1.1.3), which is normally the last field in the certificate, and demonstrate that the certificate fails to validate. (The signature on the certificate will not validate.)</p>
</li>
<li>
<p>Test 7: The evaluator shall modify any byte in the public key of the certificate and demonstrate that the certificate fails to validate. (The hash of the certificate will not validate.)</p>
</li>
<li>
<p>Test 8 (Conditional on support for EC certificates as indicated in FCS_COP.1/SigGen). The following tests are run when a minimum certificate path length of three certificates is implemented:</p>
<div class="paragraph">
<p>Test 8a: (Conditional on TOE ability to process CA certificates presented in certificate message) The test shall be designed in a way such that only the EC root certificate is designated as a trust anchor, and by setting up the trust store in a way that the EC Intermediate CA certificate needs to be provided, together with the leaf certificate, from outside the TOE to complete the chain (e.g. by storing only the EC root CA certificate in the trust store). The evaluator shall present the TOE with a valid chain of EC certificates (terminating in a trusted CA certificate), where the elliptic curve parameters are specified as a named curve. The evaluator shall confirm that the TOE validates the certificate chain.</p>
</div>
<div class="paragraph">
<p>Test 8b: (Conditional on TOE ability to process CA certificates presented in certificate message) The test shall be designed in a way such that only the EC root certificate is designated as a trust anchor, and by setting up the trust store in a way that the EC Intermediate CA certificate needs to be provided, together with the leaf certificate, from outside the TOE to complete the chain (e.g. by storing only the EC root CA certificate in the trust store). The evaluator shall present the TOE with a chain of EC certificates (terminating in a trusted CA certificate), where the intermediate certificate in the certificate chain uses an explicit format version of the Elliptic Curve parameters in the public key information field, and is signed by the trusted EC root CA, but having no other changes. The evaluator shall confirm the TOE treats the certificate as invalid.</p>
</div>
<div class="paragraph">
<p>Test 8c: The evaluator shall establish a subordinate CA certificate, where the elliptic curve parameters are specified as a named curve, that is signed by a trusted EC root CA. The evaluator shall attempt to load the certificate into the trust store and observe that it is accepted into the TOE&#8217;s trust store. The evaluator shall then establish a subordinate CA certificate that uses an explicit format version of the elliptic curve parameters, and that is signed by a trusted EC root CA. The evaluator shall attempt to load the certificate into the trust store and observe that it is rejected, and not added to the TOE&#8217;s trust store.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>FIA_X509_EXT1.2/Rev</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="504">
<li>
<p>The evaluator shall perform the following tests for FIA_X509_EXT.1.2/Rev. The tests described must be performed in conjunction with the other certificate services assurance activities, including the functions in FIA_X509_EXT.2.1/Rev. The tests for the extendedKeyUsage rules are performed in conjunction with the uses that require those rules. Where the TSS identifies any of the rules for extendedKeyUsage fields (in FIA_X509_EXT.1.1) that are not supported by the TOE (i.e. where the ST is therefore claiming that they are trivially satisfied) then the associated extendedKeyUsage rule testing may be omitted.</p>
</li>
<li>
<p>The goal of the following tests is to verify that the TOE accepts a certificate as a CA certificate only if it has been marked as a CA certificate by using basicConstraints with the CA flag set to True (and implicitly tests that the TOE correctly parses the basicConstraints extension as part of X509v3 certificate chain validation).</p>
</li>
<li>
<p>For each of the following tests the evaluator shall create a chain of at least three certificates: a self-signed root CA certificate, an intermediate CA certificate and a leaf (node) certificate. The properties of the certificates in the chain are adjusted as described in each individual test below (and this modification shall be the only invalid aspect of the relevant certificate chain).</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall ensure that at least one of the CAs in the chain does not contain the basicConstraints extension. The evaluator confirms that the TOE rejects such a certificate at one (or both) of the following points: (i) as part of the validation of the leaf certificate belonging to this chain; (ii) when attempting to add a CA certificate without the basicConstraints extension to the TOE’s trust store (i.e. when attempting to install the CA certificate as one which will be retrieved from the TOE itself when validating future certificate chains).</p>
</li>
<li>
<p>Test 2: The evaluator shall ensure that at least one of the CA certificates in the chain has a basicConstraints extension in which the CA flag is set to FALSE. The evaluator confirms that the TOE rejects such a certificate at one (or both) of the following points: (i) as part of the validation of the leaf certificate belonging to this chain; (ii) when attempting to add a CA certificate with the CA flag set to FALSE to the TOE’s trust store (i.e. when attempting to install the CA certificate as one which will be retrieved from the TOE itself when validating future certificate chains).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="507">
<li>
<p>The evaluator shall repeat these tests for each distinct use of certificates. Thus, for example, use of certificates for TLS connection is distinct from use of certificates for trusted updates so both of these uses would be tested. But there is no need to repeat the tests for each separate TLS channel in FTP_ITC.1 and FTP_TRP.1/Admin (unless the channels use separate implementations of TLS).</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_x509_ext_2_x_509_certificate_authentication">4.3.2. FIA_X509_EXT.2 X.509 Certificate Authentication</h4>
<div class="sect4">
<h5 id="_tss_49">4.3.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="508">
<li>
<p>The evaluator shall check the TSS to ensure that it describes how the TOE chooses which certificates to use, and any necessary instructions in the administrative guidance for configuring the operating environment so that the TOE can use the certificates.</p>
</li>
<li>
<p>The evaluator shall examine the TSS to confirm that it describes the behaviour of the TOE when a connection cannot be established during the validity check of a certificate used in establishing a trusted channel. The evaluator shall verify that any distinctions between trusted channels are described. If the requirement that the administrator is able to specify the default action, then the evaluator shall ensure that the guidance documentation contains instructions on how this configuration action is performed.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_49">4.3.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="510">
<li>
<p>The evaluator shall also ensure that the guidance documentation describes the configuration required in the operating environment so the TOE can use the certificates. The guidance documentation shall also include any required configuration on the TOE to use the certificates. The guidance document shall also describe the steps for the Security Administrator to follow if the connection cannot be established during the validity check of a certificate used in establishing a trusted channel.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_50">4.3.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="511">
<li>
<p>The evaluator shall perform the following test for each trusted channel:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall demonstrate that using a valid certificate that requires certificate validation checking to be performed in at least some part by communicating with a non-TOE IT entity. The evaluator shall then manipulate the environment so that the TOE is unable to verify the validity of the certificate and observe that the action selected in FIA_X509_EXT.2.2 is performed. If the selected action is administrator-configurable, then the evaluator shall follow the guidance documentation to determine that all supported administrator-configurable options behave in their documented manner.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_x509_ext_3_extended_x509_certificate_requests">4.3.3. FIA_X509_EXT.3 Extended: X509 Certificate Requests</h4>
<div class="sect4">
<h5 id="_tss_50">4.3.3.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="512">
<li>
<p>If the ST author selects "device-specific information", the evaluator shall verify that the TSS contains a description of the device-specific fields used in certificate requests.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_50">4.3.3.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="513">
<li>
<p>The evaluator shall check to ensure that the guidance documentation contains instructions on requesting certificates from a CA, including generation of a Certificate Request. If the ST author selects "Common Name", "Organization", "Organizational Unit", or "Country", the evaluator shall ensure that this guidance includes instructions for establishing these fields before creating the Certification Request.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_51">4.3.3.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="514">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall use the guidance documentation to cause the TOE to generate a Certification Request. The evaluator shall capture the generated message and ensure that it conforms to the format specified. The evaluator shall confirm that the Certification Request provides the public key and other required information, including any necessary user-input information.</p>
</li>
<li>
<p>Test 2: The evaluator shall demonstrate that validating a response message to a Certification Request without a valid certification path results in the function failing. The evaluator shall then load a certificate or certificates as trusted CAs needed to validate the certificate response message and demonstrate that the function succeeds.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_afl_1_authentication_failure_management">4.3.4. FIA_AFL.1 Authentication Failure Management</h4>
<div class="sect4">
<h5 id="_tss_51">4.3.4.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="515">
<li>
<p>The evaluator shall examine the TSS to determine that it contains a description, for each supported method for remote administrative actions, of how successive unsuccessful authentication attempts are detected and tracked. The TSS shall also describe the method by which the remote administrator is prevented from successfully logging on to the TOE, and the actions necessary to restore this ability.</p>
</li>
<li>
<p>The evaluator shall examine the TSS to confirm that the TOE ensures that authentication failures by remote administrators cannot lead to a situation where no administrator access is available, either permanently or temporarily (e.g. by providing local logon which is not subject to blocking).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_51">4.3.4.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="517">
<li>
<p>The evaluator shall examine the guidance documentation to ensure that instructions for configuring the number of successive unsuccessful authentication attempts and time period (if implemented) are provided, and that the process of allowing the remote administrator to once again successfully log on is described for each “action” specified (if that option is chosen). If different actions or mechanisms are implemented depending on the secure protocol employed (e.g., TLS vs. SSH), all must be described.</p>
</li>
<li>
<p>The evaluator shall examine the guidance documentation to confirm that it describes, and identifies the importance of, any actions that are required in order to ensure that administrator access will always be maintained, even if remote administration is made permanently or temporarily unavailable due to blocking of accounts as a result of FIA_AFL.1.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_52">4.3.4.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="519">
<li>
<p>The evaluator shall perform the following tests for each method by which remote administrators access the TOE (e.g. any passwords entered as part of establishing the connection protocol or the remote administrator application):</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall use the operational guidance to configure the number of successive unsuccessful authentication attempts allowed by the TOE (and, if the time period selection in FIA_AFL.1.2 is included in the ST, then the evaluator shall also use the operational guidance to configure the time period after which access is re-enabled). The evaluator shall test that once the authentication attempts limit is reached, authentication attempts with valid credentials are no longer successful.</p>
</li>
<li>
<p>Test 2: After reaching the limit for unsuccessful authentication attempts as in Test 1 above, the evaluator shall proceed as follows.</p>
<div class="paragraph">
<p>If the administrator action selection in FIA_AFL.1.2 is included in the ST, then the evaluator shall confirm by testing that following the operational guidance and performing each action specified in the ST to re-enable the remote administrator’s access results in successful access (when using valid credentials for that administrator).</p>
</div>
<div class="paragraph">
<p>If the time period selection in FIA_AFL.1.2 is included in the ST, then the evaluator shall wait for just less than the time period configured in Test 1 and show that an authorisation attempt using valid credentials does not result in successful access. The evaluator shall then wait until just after the time period configured in Test 1 and show that an authorisation attempt using valid credentials results in successful access.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_uau_7_protected_authentication_feedback">4.3.5. FIA_UAU.7 Protected Authentication Feedback</h4>
<div class="sect4">
<h5 id="_tss_52">4.3.5.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="520">
<li>
<p>None.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_52">4.3.5.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="521">
<li>
<p>The evaluator shall examine the guidance documentation to determine that any necessary preparatory steps to ensure authentication data is not revealed while entering for each local login allowed.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_53">4.3.5.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="522">
<li>
<p>The evaluator shall perform the following test for each method of local login allowed:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall locally authenticate to the TOE. While making this attempt, the evaluator shall verify that at most obscured feedback is provided while entering the authentication information.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fia_pmg_ext_1_password_management">4.3.6. FIA_PMG_EXT.1 Password Management</h4>
<div class="sect4">
<h5 id="_tss_53">4.3.6.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="523">
<li>
<p>The evaluator shall examine the TSS to determine that it contains the lists of the supported special character(s) and minimum and maximum number of charters supported for administrator passwords.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_53">4.3.6.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="524">
<li>
<p>The evaluator shall examine the guidance documentation to determine that it:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>identifies the characters that may be used in passwords and provides guidance to security administrators on the composition of strong passwords, and</p>
</li>
<li>
<p>provides instructions on setting the minimum password length and describes the valid minimum password lengths supported.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_54">4.3.6.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="525">
<li>
<p>The evaluator shall perform the following tests.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall compose passwords that meet the requirements in some way. For each password, the evaluator shall verify that the TOE supports the password. While the evaluator is not required (nor is it feasible) to test all possible compositions of passwords, the evaluator shall ensure that all characters, and a minimum length listed in the requirement are supported and justify the subset of those characters chosen for testing.</p>
</li>
<li>
<p>Test 2: The evaluator shall compose passwords that do not meet the requirements in some way. For each password, the evaluator shall verify that the TOE does not support the password. While the evaluator is not required (nor is it feasible) to test all possible compositions of passwords, the evaluator shall ensure that the TOE enforces the allowed characters and the minimum length listed in the requirement and justify the subset of those characters chosen for testing.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_protection_of_the_tsf_fpt_3">4.4. Protection of the TSF (FPT)</h3>
<div class="sect3">
<h4 id="_fpt_apw_ext_1_protection_of_administrator_passwords">4.4.1. FPT_APW_EXT.1 Protection of Administrator Passwords</h4>
<div class="sect4">
<h5 id="_tss_54">4.4.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="526">
<li>
<p>The evaluator shall examine the TSS to determine that it details all authentication data that are subject to this requirement, and the method used to obscure the plaintext password data when stored. The TSS shall also detail passwords are stored in such a way that they are unable to be viewed through an interface designed specifically for that purpose, as outlined in the application note.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fpt_tud_ext_2_trusted_update_based_on_certificates">4.4.2. FPT_TUD_EXT.2 Trusted Update based on certificates</h4>
<div class="sect4">
<h5 id="_tss_55">4.4.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="527">
<li>
<p>The evaluator shall verify that the TSS contains a description of how the certificates are contained on the device. The evaluator also ensures that the TSS (or guidance documentation) describes how the certificates are installed/updated/selected, if necessary.</p>
</li>
<li>
<p>The evaluator shall verify that the TSS describes how the TOE reacts if X.509 certificates are used for trusted updates and the Security Administrator attempts to perform the trusted update using an expired certificate.</p>
</li>
<li>
<p>The TSS shall describe the point at which revocation checking is performed and describe whether the Security Administrator can manually provide revocation information. It is expected that revocation checking is performed when a certificate is used when performing trusted updates. It is not sufficient to verify the status of a X.509 certificate only when it is loaded onto the device.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_54">4.4.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="530">
<li>
<p>The evaluator shall verify that the guidance documentation describes how the TOE reacts if X.509 certificates are used for trusted updates and the administrator attempts to perform the trusted update using an expired certificate. The evaluator shall verify any Security Administrator actions related to revocation checking, both accepting or rejecting certificates and manually providing revocation information. The description shall correspond to the description in the TSS.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_55">4.4.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="531">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall verify that the update mechanism includes a certificate validation according to FIA_X509_EXT.1 and a check for the Code Signing purpose in the extendedKeyUsage.</p>
</li>
<li>
<p>Test 2: The evaluator shall digitally sign the update with an invalid certificate and verify that update installation fails. The evaluator shall digitally sign the application with a certificate that does not have the Code Signing purpose and verify that application installation fails. The evaluator shall repeat the test using a valid certificate and a certificate that contains the Code Signing purpose and verify that the application installation succeeds. The evaluator shall use a previously valid but expired certificate and verifies that the TOE reacts as described in the TSS and the guidance documentation. Testing for this element is performed in conjunction with the assurance activities for FPT_TUD_EXT.1.</p>
</li>
<li>
<p>Test 3: The evaluator shall demonstrate that checking the validity of a certificate is performed at the time a certificate is used when performing trusted updates. It is not sufficient to verify the status of a X.509 certificate only when it is loaded onto the device.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security_management_fmt_2">4.5. Security management (FMT)</h3>
<div class="sect3">
<h4 id="_fmt_mof_1services_management_of_security_functions_behaviour">4.5.1. FMT_MOF.1/Services Management of security functions behaviour</h4>
<div class="sect4">
<h5 id="_tss_56">4.5.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="532">
<li>
<p>For distributed TOEs see chapter 2.4.1.1.</p>
</li>
<li>
<p>For non-distributed TOEs, the evaluator shall ensure the TSS lists the services the Security Administrator is able to start and stop and how that operation is performed.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_55">4.5.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="534">
<li>
<p>For distributed TOEs see chapter 2.4.1.2.</p>
</li>
<li>
<p>For non-distributed TOEs, the evaluator shall also ensure the Guidance Documentation describes how the TSS lists the services the Security Administrator is able to start and stop and how that operation is performed.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_56">4.5.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="536">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall try to enable and disable at least one of the services as defined in the Application Notes for FAU_GEN.1.1 (whichever is supported by the TOE) without prior authentication as Security Administrator (either by authenticating as a user with no administrator privileges, if possible, or without prior authentication at all). The attempt to enable/disable this service/these services should fail. According to the implementation no other users than the Security Administrator might be defined and without any user authentication the user might not be able to get to the point where the attempt to enable/disable this service/these services can be executed. In that case it shall be demonstrated that access control mechanisms prevent execution up to the step that can be reached without authentication as Security Administrator.</p>
</li>
<li>
<p>Test 2: The evaluator shall try to enable and disable at least one of the services as defined in the Application Notes for FAU_GEN.1.1 (whichever is supported by the TOE) with prior authentication as Security Administrator. The attempt to enable/disable this service/these services should be successful.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_mof_1autoupdate_management_of_security_functions_behaviour">4.5.2. FMT_MOF.1/AutoUpdate Management of security functions behaviour</h4>
<div class="sect4">
<h5 id="_tss_57">4.5.2.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="537">
<li>
<p>For distributed TOEs see chapter 2.4.1.1.</p>
</li>
<li>
<p>For non-distributed TOEs, the evaluator shall ensure the TSS describes how checking for automatic updates or automated updates (whichever is supported by the TOE) are performed to include required configuration settings to enable and disable automated checking or automated updates.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_56">4.5.2.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="539">
<li>
<p>For distributed TOEs see chapter 2.4.1.2.</p>
</li>
<li>
<p>For non-distributed TOEs, the evaluator shall also ensure the TSS describes how checking for automatic updates or automated updates (whichever is supported by the TOE) are performed to include required configuration settings to enable and disable automated checking or automated updates (whichever is supported by the TOE).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_57">4.5.2.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="541">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall try to enable and disable automatic checking for updates or automatic updates (whichever is supported by the TOE) without prior authentication as Security Administrator (by authenticating as a user with no administrator privileges or without user authentication). The attempt to enable/disable automatic checking for updates should fail. According to the implementation no other users than the Security Administrator might be defined and without any user authentication the user might not be able to get to the point where the attempt to enable/disable automatic checking for updates can be executed. In that case it shall be demonstrated that access control mechanisms prevent execution up to the step that can be reached without authentication as Security Administrator.</p>
</li>
<li>
<p>Test 2: The evaluator shall try to enable and disable automatic checking for updates or automatic updates (whichever is supported by the TOE) with prior authentication as Security Administrator. The attempt to enable/disable automatic checking for updates should be successful.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_mof_1functions_management_of_security_functions_behaviour">4.5.3. FMT_MOF.1/Functions Management of security functions behaviour</h4>
<div class="sect4">
<h5 id="_tss_58">4.5.3.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="542">
<li>
<p>For distributed TOEs see chapter 2.4.1.1.</p>
</li>
<li>
<p>For non-distributed TOEs, the evaluator shall ensure the TSS for each administrative function identified the TSS details how the Security Administrator determines or modifies the behaviour of (whichever is supported by the TOE) transmitting audit data to an external IT entity, handling of audit data, audit functionality when Local Audit Storage Space is full (whichever is supported by the TOE).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_57">4.5.3.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="544">
<li>
<p>For distributed TOEs see chapter 2.4.1.2.</p>
</li>
<li>
<p>For non-distributed TOEs, the evaluator shall also ensure the Guidance Documentation describes how the Security Administrator determines or modifies the behaviour of (whichever is supported by the TOE) transmitting audit data to an external IT entity, handling of audit data, audit functionality when Local Audit Storage Space is full (whichever is supported by the TOE) are performed to include required configuration settings.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_58">4.5.3.3. Tests</h5>
<div class="paragraph">
<p><strong>If ‘transmission of audit data to external IT entity’ is selected from the second selection together with 'modify the behaviour of' in the first selection</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="546">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall try to modify all security related parameters for configuration of the transmission protocol for transmission of audit data to an external IT entity without prior authentication as Security Administrator (by authentication as a user with no administrator privileges or without user authentication at all). Attempts to modify parameters without prior authentication should fail. According to the implementation no other users than the Security Administrator might be defined and without any user authentication the user might not be able to get to the point where the attempt to modify the security related parameters can be executed. In that case it shall be demonstrated that access control mechanisms prevent execution up to the step that can be reached without authentication as Security Administrator.</p>
</li>
<li>
<p>Test 2: The evaluator shall try to modify all security related parameters for configuration of the transmission protocol for transmission of audit data to an external IT entity with prior authentication as Security Administrator. The effects of the modifications should be confirmed.</p>
<div class="paragraph">
<p>The evaluator does not have to test all possible values of the security related parameters for configuration of the transmission protocol for transmission of audit data to an external IT entity but at least one allowed value per parameter.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>If 'handling of audit data' is selected from the second selection together with 'modify the behaviour of' in the first selection</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="547">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall try to modify all security related parameters for configuration of the handling of audit data without prior authentication as Security Administrator (by authentication as a user with no administrator privileges or without user authentication at all). Attempts to modify parameters without prior authentication should fail. According to the implementation no other users than the Security Administrator might be defined and without any user authentication the user might not be able to get to the point where the attempt can be executed. In that case it shall be demonstrated that access control mechanisms prevent execution up to the step that can be reached without authentication as Security Administrator. The term ‘handling of audit data’ refers to the different options for selection and assignments in SFRs FAU_STG_EXT.1.4, FAU_STG_EXT.1.5 and FAU_STG_EXT.2.</p>
</li>
<li>
<p>Test 2: The evaluator shall try to modify all security related parameters for configuration of the handling of audit data with prior authentication as Security Administrator. The effects of the modifications should be confirmed. The term ‘handling of audit data’ refers to the different options for selection and assignments in SFRs FAU_STG_EXT.1.4, FAU_STG_EXT.1.5 and FAU_STG_EXT.2.</p>
<div class="paragraph">
<p>The evaluator does not necessarily have to test all possible values of the security related parameters for configuration of the handling of audit data but at least one allowed value per parameter.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>If 'audit functionality when Local Audit Storage Space is full' is selected from the second selection together with 'modify the behaviour of' in the first selection</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="548">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall try to modify the behaviour when Local Audit Storage Space is full without prior authentication as Security Administrator (by authentication as a user with no administrator privileges or without user authentication at all). This attempt should fail. According to the implementation no other users than the Security Administrator might be defined and without any user authentication the user might not be able to get to the point where the attempt can be executed. In that case it shall be demonstrated that access control mechanisms prevent execution up to the step that can be reached without authentication as Security Administrator.</p>
</li>
<li>
<p>Test 2: The evaluator shall try to modify the behaviour when Local Audit Storage Space is full with prior authentication as Security Administrator. This attempt should be successful. The effect of the change shall be verified.</p>
<div class="paragraph">
<p>The evaluator does not necessarily have to test all possible values for the behaviour when Local Audit Storage Space is full but at least one change between allowed values for the behaviour.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>If in the first selection 'determine the behaviour of' has been chosen together with for any of the options in the second selection</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="549">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator shall try to determine the behaviour of all options chosen from the second selection without prior authentication as Security Administrator (by authentication as a user with no administrator privileges or without user authentication at all). This can be done in one test or in separate tests. The attempt(s) to determine the behaviour of the selected functions without administrator authentication shall fail. According to the implementation no other users than the Security Administrator might be defined and without any user authentication the user might not be able to get to the point where the attempt can be executed. In that case it shall be demonstrated that access control mechanisms prevent execution up to the step that can be reached without authentication as Security Administrator.</p>
</li>
<li>
<p>Test 2: The evaluator shall try to determine the behaviour of all options chosen from the second selection with prior authentication as Security Administrator. This can be done in one test or in separate tests. The attempt(s) to determine the behaviour of the selected functions with Security Administrator authentication shall be successful.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmt_mtd_1cryptokeys_management_of_tsf_data">4.5.4. FMT_MTD.1/CryptoKeys Management of TSF Data</h4>
<div class="sect4">
<h5 id="_tss_59">4.5.4.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="550">
<li>
<p>For distributed TOEs see chapter 2.4.1.1.</p>
</li>
<li>
<p>For non-distributed TOEs, the evaluator shall ensure the TSS lists the keys the Security Administrator is able to manage to include the options available (e.g. generating keys, importing keys, modifying keys or deleting keys) and names the  operations that are performed.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_58">4.5.4.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="552">
<li>
<p>For distributed TOEs see chapter 2.4.1.2.</p>
</li>
<li>
<p>For non-distributed TOEs, the evaluator shall also ensure the Guidance Documentation describes how the operations are performed on the keys the Security Administrator is able to manage.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_59">4.5.4.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="554">
<li>
<p>The evaluator shall perform the following tests:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a" start="1">
<li>
<p>Test 1: The evaluator shall try to perform at least one of the related actions (modify, delete, generate/import) without prior authentication as Security Administrator (either by authentication as a non-administrative user, if supported, or without authentication at all). Attempts to perform related actions without prior authentication should fail. According to the implementation no other users than the Security Administrator might be defined and without any user authentication the user might not be able to get to the point where the attempt to manage cryptographic keys can be executed. In that case it shall be demonstrated that access control mechanisms prevent execution up to the step that can be reached without authentication as Security Administrator.</p>
</li>
<li>
<p>Test 2: The evaluator shall try to perform at least one of the related actions with prior authentication as Security Administrator. This attempt should be successful.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_toe_access_fta_2">4.6. TOE Access (FTA)</h3>
<div class="sect3">
<h4 id="_fta_ssl_ext_1_tsf_initiated_session_locking">4.6.1. FTA_SSL_EXT.1 TSF-initiated Session Locking</h4>
<div class="sect4">
<h5 id="_tss_60">4.6.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="555">
<li>
<p>The evaluator shall examine the TSS to determine that it details whether local administrative session locking or termination is supported and the related inactivity time period settings.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_guidance_documentation_59">4.6.1.2. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="556">
<li>
<p>The evaluator shall confirm that the guidance documentation states whether local administrative session locking or termination is supported and instructions for configuring the inactivity time period.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tests_60">4.6.1.3. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="557">
<li>
<p>The evaluator shall perform the following test:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Test 1: The evaluator follows the guidance documentation to configure several different values for the inactivity time period referenced in the component. For each period configured, the evaluator establishes a local interactive session with the TOE. The evaluator then observes that the session is either locked or terminated after the configured time period. If locking was selected from the component, the evaluator then ensures that re-authentication is needed when trying to unlock the session.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evaluation_activities_for_sars">5. Evaluation Activities for SARs</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic" start="558">
<li>
<p>The sections below specify EAs for the Security Assurance Requirements (SARs) included in the related cPPs (see section 1.1 above). The EAs in Section 2 (Evaluation Activities for SFRs), Section 3 (<a href="#_Evaluation_Activities_for_1">Evaluation Activities for Optional Requirements</a>), and Section 4 (Evaluation Activities for Selection-Based Requirements) are an interpretation of the more general CEM assurance requirements as they apply to the specific technology area of the TOE.</p>
</li>
<li>
<p>In this section, each SAR that is contained in the cPP is listed, and the EAs that are not associated with an SFR are captured here, or a reference is made to the CEM, and the evaluator is expected to perform the CEM work units.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_ase_security_target_evaluation">5.1. ASE: Security Target Evaluation</h3>
<div class="sect3">
<h4 id="_general_evaluation_activities_for_toe_summary_specification_ase_tss_1_for_all_toes">5.1.1. General evaluation activities for TOE summary specification (ASE_TSS.1) for all TOEs</h4>
<div class="olist arabic">
<ol class="arabic" start="560">
<li>
<p>When evaluating a Security Target, the evaluator performs the work units as presented in the CEM. In addition, the evaluator ensures the content of the TSS in the ST satisfies the EAs specified in Section 2 (Evaluation Activities for SFRs).</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_additional_evaluation_activities_for_toe_summary_specification_ase_tss_1_for_distributed_toes">5.1.2. Additional evaluation activities for TOE summary specification (ASE_TSS.1) for Distributed TOEs</h4>
<div class="olist arabic">
<ol class="arabic" start="561">
<li>
<p>For distributed TOEs only the SFRs classified as ‘all’ have to be fulfilled by all TOE parts. The SFRs classified as ‘One’ or ‘Feature Dependent’ only have to be fulfilled by either one or some TOE parts, respectively. To make sure that the distributed TOE as a whole fulfills all the SFRs the following actions for ASE_TSS.1 have to be performed as part of ASE_TSS.1.1E.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>ASE_TSS.1 element</strong></th>
<th class="tableblock halign-left valign-top"><strong>Evaluator Action</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASE_TSS.1.1C</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The evaluator shall examine the TSS to determine that it is clear which TOE components contribute to each SFR or how the components combine to meet each SFR.</p>
</div>
<div class="paragraph">
<p>The evaluator shall verify the sufficiency to fulfil the related SFRs. This includes checking that the TOE as a whole fully covers all SFRs and that all functionality that is required to be audited is in fact audited regardless of the component that carries it out.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="olist arabic">
<ol class="arabic" start="562">
<li>
<p>Note that additional Evaluation Activities for the TSS in the case of a distributed TOE are defined in section A.9.1.1.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adv_development">5.2. ADV: Development</h3>
<div class="sect3">
<h4 id="_basic_functional_specification_adv_fsp_1">5.2.1. Basic Functional Specification (ADV_FSP.1)</h4>
<div class="olist arabic">
<ol class="arabic" start="563">
<li>
<p>The EAs for this assurance component focus on understanding the interfaces (e.g., application programming interfaces, command line interfaces, graphical user interfaces, network interfaces) described in the AGD documentation, and possibly identified in the TOE Summary Specification (TSS) in response to the SFRs. Specific evaluator actions to be performed against this documentation are identified (where relevant) for each SFR in Section 2, and in EAs for AGD, ATE and AVA SARs in other parts of Section 5.</p>
</li>
<li>
<p>The EAs presented in this section address the CEM work units ADV_FSP.1-1, ADV_FSP.1-2, ADV_FSP.1-3, and ADV_FSP.1-5.</p>
</li>
<li>
<p>The EAs are reworded for clarity and interpret the CEM work units such that they will result in more objective and repeatable actions by the evaluator. The EAs in this SD are intended to ensure the evaluators are consistently performing equivalent actions.</p>
</li>
<li>
<p>The documents to be examined for this assurance component in an evaluation are therefore the Security Target, AGD documentation, and any required supplementary information required by the cPP: no additional “functional specification” documentation is necessary to satisfy the EAs. The interfaces that need to be evaluated are also identified by reference to the EAs listed for each SFR and are expected to be identified in the context of the Security Target, AGD documentation, and any required supplementary information defined in the cPP rather than as a separate list specifically for the purposes of CC evaluation. The direct identification of documentation requirements and their assessment as part of the EAs for each SFR also means that the tracing required in ADV_FSP.1.2D (work units ADV_FSP.1-4, ADV_FSP.1-6 and ADV_FSP.1-7) is treated as implicit and no separate mapping information is required for this element.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>CEM ADV_FSP.1 Work Units</strong></th>
<th class="tableblock halign-left valign-top"><strong>Evaluation Activities</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADV_FSP.1-1 The evaluator <strong><em>shall examine</em></strong> the functional specification to determine that it states the purpose of each SFR-supporting and SFR-enforcing TSFI.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>5.2.1.1 Evaluation Activity: The evaluator shall examine the interface documentation to ensure it describes the purpose and method of use for each TSFI that is identified as being security relevant.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADV_FSP.1-2 The evaluator <strong><em>shall examine</em></strong> the functional specification to determine that the method of use for each SFR-supporting and SFR-enforcing TSFI is given.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>5.2.1.1 Evaluation Activity: The evaluator shall examine the interface documentation to ensure it describes the purpose and method of use for each TSFI that is identified as being security relevant.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>ADV_FSP.1-3 The evaluator <strong><em>shall examine</em></strong> the presentation of the TSFI to determine that it identifies all parameters associated with each SFR-enforcing and SFR supporting</p>
</div>
<div class="paragraph">
<p>TSFI.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.2.1.2 Evaluation Activity: The evaluator shall check the interface documentation to ensure it identifies and describes the parameters for each TSFI that is identified as being security relevant.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADV_FSP.1-4 The evaluator <strong><em>shall examine</em></strong> the rationale provided by the developer for the implicit categorisation of interfaces as SFR-non-interfering to determine that it is accurate.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Paragraph 609 from the CEM: “In the case where the developer has provided adequate documentation to perform the analysis called for by the rest of the work units for this component without explicitly identifying SFR-enforcing and SFR-supporting interfaces, this work unit should be considered satisfied.”</p>
</div>
<div class="paragraph">
<p>Since the rest of the ADV_FSP.1 work units will have been satisfied upon completion of the EAs, it follows that this work unit is satisfied as well.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADV_FSP.1-5 The evaluator <strong><em>shall check</em></strong> that the tracing links the SFRs to the corresponding TSFIs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.2.1.3 Evaluation Activity: The evaluator shall examine the interface documentation and confirm that all security-relevant interfaces are described. The evaluator shall also confirm that all internal (FPT_ITT.1), administrative (FTP_TRP.1/Admin), and trusted channel (FTP_ITC.1) requirements unambiguously trace to documented interfaces.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADV_FSP.1-6 The evaluator <strong><em>shall examine</em></strong> the functional specification to determine that it is a complete instantiation of the SFRs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EAs that are associated with the SFRs in Section 2, and, if applicable, Sections 3 and 4, are performed to ensure that all the SFRs where the security functionality is externally visible (i.e. at the TSFI) are covered. Therefore, the intent of this work unit is covered.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADV_FSP.1-7 The evaluator <strong><em>shall examine</em></strong> the functional specification to determine that it is an accurate instantiation of the SFRs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EAs that are associated with the SFRs in Section 2, and, if applicable, Sections 3 and 4, are performed to ensure that all the SFRs where the security functionality is externally visible (i.e. at the TSFI) are addressed, and that the description of the interfaces is accurate with respect to the specification captured in the SFRs. Therefore, the intent of this work unit is covered.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><span id="_Toc473308377"><strong>Table 1: Mapping of ADV_FSP.1 CEM Work Units to Evaluation Activities</strong></span></p>
</div>
<div class="sect4">
<h5 id="_evaluation_activity">5.2.1.1. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="567">
<li>
<p><em>The evaluator shall examine the interface documentation to ensure it describes the purpose and method of use for each TSFI that is identified as being security relevant.</em></p>
</li>
<li>
<p>In this context, TSFI are deemed security relevant if they are used by the administrator to configure the TOE, or to perform other administrative functions (e.g. audit review or performing updates). Explicitly labeling TSFI as security relevant or non-security relevant is not necessary. A TSFI is implicitly security relevant if is is used to satisfy an evaluation activity, or if it is identified in the ST or guidance documentation as adhering to the security policies (as presented in the SFRs). The intent is that these interfaces will be adequately tested and having an understanding of how these interfaces are used in the TOE is necessary to ensure proper test coverage is applied. According to the description above 'security relevant' corresponds to the combination of 'SFR-enforcing' and 'SFR-supporting' as defined in CC Part 3, paragraph 224 and 225.</p>
</li>
<li>
<p>The set of TSFI that are provided as evaluation evidence are contained in the Security Target and the guidance documentation.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_2">5.2.1.2. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="570">
<li>
<p><em>The evaluator shall check the interface documentation to ensure it identifies and describes the parameters for each TSFI that is identified as being security relevant.</em></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_3">5.2.1.3. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="571">
<li>
<p><em>The evaluator shall examine the interface documentation to develop a mapping of the interfaces to SFRs.</em></p>
</li>
<li>
<p>The evaluator uses the provided documentation and first identifies, and then examines a representative set of interfaces to perform the EAs presented in Section 2, including the EAs associated with testing of the interfaces.</p>
</li>
<li>
<p>It should be noted that there may be some SFRs that do not have a TSFI that is explicitly “mapped” to invoke the desired functionality. For example, generating a random bit string or destroying a cryptographic key that is no longer needed are capabilities that may be specified in SFRs, but are not invoked by an interface.</p>
</li>
<li>
<p>The required EAs define the design and interface information required to meet ADV_FSP.1. If the evaluator is unable to perform some EA, then the evaluator shall conclude that an adequate functional specification has not been provided.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_agd_guidance_documents">5.3. AGD: Guidance Documents</h3>
<div class="olist arabic">
<ol class="arabic" start="575">
<li>
<p>It is not necessary for a TOE to provide separate documentation to meet the individual requirements of AGD_OPE and AGD_PRE. Although the EAs in this section are described under the traditionally separate AGD families, the mapping between the documentation provided by the developer and AGD_OPE and AGD_PRE requirements may be many-to-many, as long as all requirements are met in documentation that is delivered to Security Administrators and users (as appropriate) as part of the TOE.</p>
</li>
<li>
<p>Note that additional Evaluation Activities for the guidance documentation in the case of a distributed TOE are defined in section A.9.1.1.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_operational_user_guidance_agd_ope_1">5.3.1. Operational User Guidance (AGD_OPE.1)</h4>
<div class="olist arabic">
<ol class="arabic" start="577">
<li>
<p>The evaluator performs the CEM work units associated with the AGD_OPE.1 SAR. Specific requirements and EAs on the guidance documentation are identified (where relevant) in the individual EAs for each SFR. For the related evaluation activities, the evaluation evidence documents Security Target, AGD documentation (user guidance) and functional specification documentation (if provided) shall be used as input documents. Each input document is subject to ALC_CMS.1-2 requirements.</p>
</li>
<li>
<p>In addition, the evaluator performs the EAs specified below.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_4">5.3.1.1. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="579">
<li>
<p><em>The evaluator shall ensure the Operational guidance documentation is distributed to Security Administrators and users (as appropriate) as part of the TOE, so that there is a reasonable guarantee that Security Administrators and users are aware of the existence and role of the documentation in establishing and maintaining the evaluated configuration.</em></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_5">5.3.1.2. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="580">
<li>
<p><em>The evaluator shall ensure that the Operational guidance is provided for every Operational Environment that the product supports as claimed in the Security Target and shall adequately address all platforms claimed for the TOE in the Security Target.</em></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_6">5.3.1.3. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="581">
<li>
<p><em>The evaluator shall ensure that the Operational guidance contains instructions for configuring any cryptographic implementation associated with the evaluated configuration of the TOE. It shall provide a warning to the administrator that use of other cryptographic implementations was not evaluated nor tested during the CC evaluation of the TOE.</em></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_7">5.3.1.4. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="582">
<li>
<p><em>The evaluator shall ensure the Operational guidance makes it clear to an administrator which security functionality and interfaces have been assessed and tested by the EAs.</em></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_8">5.3.1.5. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="583">
<li>
<p>In addition, the evaluator shall ensure that the following requirements are also met.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The guidance documentation shall contain instructions for configuring any cryptographic implementation associated with the evaluated configuration of the TOE. It shall provide a warning to the administrator that use of other cryptographic implementations was not evaluated nor tested during the CC evaluation of the TOE.</p>
</li>
<li>
<p>The evaluator shall verify that this process includes instructions for obtaining the update itself. This should include instructions for making the update accessible to the TOE (e.g., placement in a specific directory).</p>
</li>
<li>
<p>The TOE will likely contain security functionality that does not fall in the scope of evaluation under this cPP. The guidance documentation shall make it clear to an administrator which security functionality is covered by the Evaluation Activities.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_preparative_procedures_agd_pre_1">5.3.2. Preparative Procedures (AGD_PRE.1)</h4>
<div class="olist arabic">
<ol class="arabic" start="584">
<li>
<p>The evaluator performs the CEM work units associated with the AGD_PRE.1 SAR. Specific requirements and EAs on the preparative documentation are identified (and where relevant are captured in the Guidance Documentation portions of the EAs) in the individual EAs for each SFR.</p>
</li>
<li>
<p>Preparative procedures are distributed to Security Administrators and users (as appropriate) as part of the TOE, so that there is a reasonable guarantee that Security Administrators and users are aware of the existence and role of the documentation in establishing and maintaining the evaluated configuration.</p>
</li>
<li>
<p>In addition, the evaluator performs the EAs specified below.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_9">5.3.2.1. Evaluation Activity:</h5>
<div class="olist arabic">
<ol class="arabic" start="587">
<li>
<p><em>The evaluator shall examine the Preparative procedures to ensure they include a description of how the Security Administrator verifies that the operational environment can fulfil its role to support the security functionality (including the requirements of the Security Objectives for the Operational Environment specified in the Security Target).</em></p>
</li>
<li>
<p>The documentation should be in an informal style and should be written with sufficient detail and explanation that they can be understood and used by the target audience (which will typically include IT staff who have general IT experience but not necessarily experience with the TOE product itself).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_10">5.3.2.2. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="589">
<li>
<p><em>The evaluator shall examine the preparative procedures to ensure they are provided for every Operational Environment that the product supports as claimed in the Security Target and shall adequately address all platforms claimed for the TOE in the Security Target.</em></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_11">5.3.2.3. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="590">
<li>
<p><em>The evaluator shall examine the preparative procedures to ensure they include instructions to successfully install the TSF in each Operational Environment.</em></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_12">5.3.2.4. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="591">
<li>
<p><em>The evaluator shall examine the preparative procedures to ensure they include instructions on how to manage the TSF as a product and as a component of the larger Operational Environment in a manner that allows to preserve integrity of the TSF.</em></p>
</li>
<li>
<p><em>The intent of this requirement is to ensure there exists adequate preparative procedures (guidance in most cases) to put the TSF in a secure state (i.e., evaluated configuration). AGD_PRE.1 lists general requirements, the specific assurance activities implementing it are performed as part of FMT_SMF.1, FMT_MTD.1 and FMT_MOF.1 series of SFRs.</em></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_13">5.3.2.5. Evaluation Activity</h5>
<div class="olist arabic">
<ol class="arabic" start="593">
<li>
<p>In addition, the evaluator shall ensure that the following requirements are also met.</p>
</li>
<li>
<p>The preparative procedures must</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>include instructions to provide a protected administrative capability; and</p>
</li>
<li>
<p>identify TOE passwords that have default values associated with them and mandate that they shall be changed.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_alc_life_cycle_support">5.4. ALC: Life-cycle Support</h3>
<div class="sect3">
<h4 id="_labelling_of_the_toe_alc_cmc_1">5.4.1. Labelling of the TOE (ALC_CMC.1)</h4>
<div class="olist arabic">
<ol class="arabic" start="595">
<li>
<p>When evaluating that the TOE has been provided and is labelled with a unique reference, the evaluator performs the work units as presented in the CEM.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_toe_cm_coverage_alc_cms_1">5.4.2. TOE CM coverage (ALC_CMS.1)</h4>
<div class="olist arabic">
<ol class="arabic" start="596">
<li>
<p>When evaluating the developer’s coverage of the TOE in their CM system, the evaluator performs the work units as presented in the CEM.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_basic_flaw_remediation_alc_flr_1_optional">5.4.3. Basic flaw remediation (ALC_FLR.1) (optional)</h4>
<div class="olist arabic">
<ol class="arabic" start="597">
<li>
<p>When evaluating the developer’s procedures regarding basic flaw remediation, the evaluator performs the work units as presented in the CEM.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_flaw_reporting_procedures_alc_flr_2_optional">5.4.4. Flaw reporting procedures (ALC_FLR.2) (optional)</h4>
<div class="olist arabic">
<ol class="arabic" start="598">
<li>
<p>When evaluating the developer’s flaw reporting procedures, the evaluator performs the work units as presented in the CEM.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_systematic_flaw_remediation_alc_flr_3_optional">5.4.5. Systematic flaw remediation (ALC_FLR.3) (optional)</h4>
<div class="olist arabic">
<ol class="arabic" start="599">
<li>
<p>When evaluating the developer’s procedures regarding systematic flaw remediation, the evaluator performs the work units as presented in the CEM.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ate_tests">5.5. ATE: Tests</h3>
<div class="sect3">
<h4 id="_independent_testing_conformance_ate_ind_1">5.5.1. Independent Testing – Conformance (ATE_IND.1)</h4>
<div class="olist arabic">
<ol class="arabic" start="600">
<li>
<p>The focus of the testing is to confirm that the requirements specified in the SFRs are being met. Additionally, testing is performed to confirm the functionality described in the TSS, as well as the dependencies on the Operational guidance documentation is accurate.</p>
</li>
<li>
<p>The evaluator performs the CEM work units associated with the ATE_IND.1 SAR. Specific testing requirements and EAs are captured for each SFR in Sections 2, 3 and 4.</p>
</li>
<li>
<p>The evaluator should consult Appendix B when determining the appropriate strategy for testing multiple variations or models of the TOE that may be under evaluation.</p>
</li>
<li>
<p>Note that additional Evaluation Activities relating to evaluator testing in the case of a distributed TOE are defined in section A.9.3.1.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ava_vulnerability_assessment">5.6. AVA: Vulnerability Assessment</h3>
<div class="sect3">
<h4 id="_vulnerability_survey_ava_van_1">5.6.1. Vulnerability Survey (AVA_VAN.1)</h4>
<div class="olist arabic">
<ol class="arabic" start="604">
<li>
<p>While vulnerability analysis is inherently a subjective activity, a minimum level of analysis can be defined and some measure of objectivity and repeatability (or at least comparability) can be imposed on the vulnerability analysis process. In order to achieve such objectivity and repeatability it is important that the evaluator follows a set of well-defined activities and documents their findings so others can follow their arguments and come to the same conclusions as the evaluator. While this does not guarantee that different evaluation facilities will identify exactly the same type of vulnerabilities or come to exactly the same conclusions, the approach defines the minimum level of analysis and the scope of that analysis and provides Certification Bodies a measure of assurance that the minimum level of analysis is being performed by the evaluation facilities.</p>
</li>
<li>
<p>In order to meet these goals some refinement of the AVA_VAN.1 CEM work units is needed. The following table indicates, for each work unit in AVA_VAN.1, whether the CEM work unit is to be performed as written, or if it has been clarified by an Evaluation Activity. If clarification has been provided, a reference to this clarification is provided in the table.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>CEM AVA_VAN.1 Work Units</strong></th>
<th class="tableblock halign-left valign-top"><strong>Evaluation Activities</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-1 The evaluator <strong><em>shall examine</em></strong> the TOE to determine that the test configuration is consistent with the configuration under evaluation as specified in the ST.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The evaluator shall perform the CEM activity as specified.</p>
</div>
<div class="paragraph">
<p>The calibration of test resources specified in paragraph 1418 of the CEM applies to the tools listed in Section A.1.4.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-2 The evaluator <strong><em>shall examine</em></strong> the TOE to determine that it has been installed properly and is in a known state</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The evaluator shall perform the CEM activity as specified.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-3 The evaluator <strong><em>shall examine</em></strong> sources of information publicly available to identify potential vulnerabilities in the TOE.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replace CEM work unit with activities outlined in Section A.1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-4 The evaluator <strong><em>shall record</em></strong> in the ETR the identified potential vulnerabilities that are candidates for testing and applicable to the TOE in its operational environment.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replace the CEM work unit with the analysis activities on the list of potential vulnerabilities in Section A.1, and documentation as specified in Section A.3.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-5 The evaluator <strong><em>shall devise</em></strong> penetration tests, based on the independent search for potential vulnerabilities.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replace the CEM work unit with the activities specified in Section A.2.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>AVA_VAN.1-6 The evaluator <strong><em>shall produce</em></strong> penetration test documentation for the tests based on the list of potential vulnerabilities in sufficient detail to enable the tests to be repeatable. The test documentation shall include:</p>
</div>
<div class="paragraph">
<p>a) identification of the potential vulnerability the TOE is being tested for;</p>
</div>
<div class="paragraph">
<p>b) instructions to connect and setup all required test equipment as required to conduct the penetration test;</p>
</div>
<div class="paragraph">
<p>c) instructions to establish all penetration test prerequisite initial conditions;</p>
</div>
<div class="paragraph">
<p>d) instructions to stimulate the TSF;</p>
</div>
<div class="paragraph">
<p>e) instructions for observing the behaviour of the TSF;</p>
</div>
<div class="paragraph">
<p>f) descriptions of all expected results and the necessary analysis to be performed on the observed behaviour for comparison against expected results;</p>
</div>
<div class="paragraph">
<p>g) instructions to conclude the test and establish the necessary post-test state for the TOE.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CEM work unit is captured in Section A.3; there are no substantive differences.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-7 The evaluator <strong><em>shall conduct</em></strong> penetration testing.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The evaluator shall perform the CEM activity as specified.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-8 The evaluator <strong><em>shall record</em></strong> the actual results of the penetration tests.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The evaluator shall perform the CEM activity as specified.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-9 The evaluator <strong><em>shall report</em></strong> in the ETR the evaluator penetration testing effort, outlining the testing approach, configuration, depth and results.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replace the CEM work unit with the reporting called for in Section A.3.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVA_VAN.1-10 The evaluator <strong><em>shall examine</em></strong> the results of all penetration testing to determine that the TOE, in its operational environment, is resistant to an attacker possessing a Basic attack potential.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This work unit is not applicable for Type 1 and Type 2 flaws (as defined in Section A.1), as inclusion in this Supporting Document by the iTC makes any confirmed vulnerabilities stemming from these flaws subject to an attacker possessing a Basic attack potential.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>AVA_VAN.1-11 The evaluator <strong><em>shall report</em></strong> in the ETR all exploitable vulnerabilities and residual vulnerabilities, detailing for each:</p>
</div>
<div class="paragraph">
<p>a) its source (e.g. CEM activity being undertaken when it was conceived, known to the evaluator, read in a publication);</p>
</div>
<div class="paragraph">
<p>b) the SFR(s) not met;</p>
</div>
<div class="paragraph">
<p>c) a description;</p>
</div>
<div class="paragraph">
<p>d) whether it is exploitable in its operational environment or not (i.e. exploitable or residual).</p>
</div>
<div class="paragraph">
<p>e) the amount of time, level of expertise, level of knowledge of the TOE, level of opportunity and the equipment required to perform the identified vulnerabilities, and the corresponding values using the tables 3 and 4 of Annex B.4.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replace the CEM work unit with the reporting called for in Section A.3.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><span id="_Ref453153408">Table 2: Mapping of AVA_VAN.1 CEM Work Units to Evaluation Activities</span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="606">
<li>
<p>Because of the level of detail required for the evaluation activities, the bulk of the instructions are contained in Appendix A, while an “outline” of the assurance activity is provided below.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_documentation">5.6.1.1. Evaluation Activity (Documentation):</h5>
<div class="olist arabic">
<ol class="arabic" start="607">
<li>
<p>In addition to the activities specified by the CEM in accordance with Table 2, the evaluator shall perform the following activities.</p>
</li>
<li>
<p><em>The evaluator shall examine the documentation outlined below provided by the developer to confirm that it contains all required information. This documentation is in addition to the documentation already required to be supplied in response to the EAs listed previously.</em></p>
</li>
<li>
<p>The developer shall provide documentation identifying the list of software and hardware components<sup class="footnote">[<a id="_footnoteref_7" class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup> that compose the TOE. Hardware components should identify compute-capable hardware components, at a minimum that must include the processor, and where applicable, discrete crypto ASICs, TPMs, etc. used by the TOE. Software components include applications, the operating system and other major components that are independently identifiable and reusable (outside of the TOE), for example a web server, protocol or cryptographic implementations, (independently identifiable and reusable components are not limited to the list provided in the example). This additional documentation is merely a list of the name and version number of the components and will be used by the evaluators in formulating vulnerability hypotheses during their analysis.</p>
</li>
<li>
<p>If the TOE is a distributed TOE then the developer shall provide:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>documentation describing the allocation of requirements between distributed TOE components as in [NDcPP, 3.4]</p>
</li>
<li>
<p>a mapping of the auditable events recorded by each distributed TOE component as in [NDcPP, Table 2]</p>
</li>
<li>
<p>additional information in the Preparative Procedures as identified in the refinement of AGD_PRE.1 in additional information in the Preparative Procedures as identified in 3.4.1.2 and 3.5.1.2.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_evaluation_activity_14">5.6.1.2. Evaluation Activity:</h5>
<div class="olist arabic">
<ol class="arabic" start="611">
<li>
<p>The evaluator formulates hypotheses in accordance with process defined in Appendix A. The evaluator documents the flaw hypotheses generated for the TOE in the report in accordance with the guidelines in Appendix A.3. The evaluator shall perform vulnerability analysis in accordance with Appendix A.2. The results of the analysis shall be documented in the report according to Appendix A.3.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_required_supplementary_information">6. Required Supplementary Information</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic" start="612">
<li>
<p>This Supporting Document refers in various places to the possibility that ‘required supplementary information’ may need to be supplied as part of the deliverables for an evaluation. This term is intended to describe information that is not necessarily included in the Security Target or operational guidance, and that may not necessarily be public. Examples of such information could be entropy analysis, or description of a cryptographic key management architecture used in (or in support of) the TOE. The requirement for any such supplementary information will be identified in the relevant cPP.</p>
</li>
<li>
<p>The cPPs associated with this SD require an entropy analysis as described in [NDcPP, Appendix D].</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">7. References</h2>
<div class="sectionbody">
<div class="paragraph">
<p>[CC1] Common Criteria for Information Technology Security Evaluation, Part 1: Introduction and General Model<br>
CCMB-2017-04-001, Version 3.1 Revision 5, April 2017</p>
</div>
<div class="paragraph">
<p>[CC2] Common Criteria for Information Technology Security Evaluation,<br>
Part 2: Security Functional Components,<br>
CCMB-2017-04-002, Version 3.1 Revision 5, April 2017</p>
</div>
<div class="paragraph">
<p>[CC3] Common Criteria for Information Technology Security Evaluation,<br>
Part 3: Security Assurance Components,<br>
CCMB-2017-04-003, Version 3.1 Revision 5, April 2017</p>
</div>
<div class="paragraph">
<p>[CEM] Common Methodology for Information Technology Security Evaluation,<br>
Evaluation Methodology,<br>
CCMB-2017-04-004, Version 3.1, Revision 5, April 2017</p>
</div>
<div class="paragraph">
<p>[FIPS 140-2] FIPS PUB 140-2, Security Requirements for cryptographic modules, May 25 2001 with change notices (12-03-2002)</p>
</div>
<div class="paragraph">
<p>[FIPS 186-4] FIPS PUB 186-4, Digital Signature Standard (DSS), July 2013</p>
</div>
<div class="paragraph">
<p>[NDcPP] collaborative Protection Profile for Network Devices,<br>
Version 3.0, April 2023</p>
</div>
<div class="paragraph">
<p>[NIST SP800-56A] NIST Special Publication SP800-56A Revision 3: Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography, Apr 2018</p>
</div>
<div class="paragraph">
<p>[NIST SP800-90A] NIST Special Publication SP800-90A Deterministic Random Bit Generator Validation System (DRBGVS), October 29 2015</p>
</div>
<div class="paragraph">
<p>[SHAVS] The Secure Hash Algorithm Validation System (SHAVS), Updated: May 21, 2014</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vulnerability_analysis">Appendix A: Vulnerability Analysis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_sources_of_vulnerability_information">A.1. Sources of vulnerability information</h3>
<div class="olist arabic">
<ol class="arabic" start="614">
<li>
<p>CEM Work Unit AVA_VAN.1-3 has been supplemented in this Supporting Document to provide a better-defined set of flaws to investigate and procedures to follow based on this particular technology. Terminology used is based on the flaw hypothesis methodology, where the evaluation team hypothesizes flaws and then either proves or disproves those flaws (a flaw is equivalent to a “potential vulnerability” as used in the CEM). Flaws are categorized into four “types” depending on how they are formulated:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A list of flaw hypotheses applicable to the technology described by the cPP (in this case, a network device) derived from public sources as documented in Section A.1.1 – this fixed set has been agreed by the iTC. Additionally, this will be supplemented with entries for a set of public sources (as indicated below) that are directly applicable to the TOE or its identified components (as defined by the process in Section A.1.1 below); this is to ensure that the evaluators include in their assessment applicable entries that have been discovered since the cPP was published;</p>
</li>
<li>
<p>A list of flaw hypotheses listed in this document that are derived from lessons learned specific to that technology and other iTC input (that might be derived from other open sources and vulnerability databases, for example) as documented in Section A.1.2;</p>
</li>
<li>
<p>A list of flaw hypotheses derived from information available to the evaluators; this includes the baseline evidence provided by the developer described in this Supporting Document (documentation associated with EAs, documentation described in Section 5.6.1.2, documentation described in Section 6), as well as other information (public and/or based on evaluator experience) as documented in Section A.1.3; and</p>
</li>
<li>
<p>A list of flaw hypotheses that are generated through the use of TC-defined tools (e.g., nmap, fuzz testers) and their application as specified in section A.1.4.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_type_1_hypotheses_public_vulnerability_based">A.1.1. Type 1 Hypotheses – Public-Vulnerability-Based</h4>
<div class="olist arabic">
<ol class="arabic" start="615">
<li>
<p>The list of public sources of vulnerability information selected by the iTC is given in Section A.4.</p>
</li>
<li>
<p>The evaluators shall perform a search on the sources listed in Section A.4 to determine a list of potential flaw hypotheses that are specific to the TOE and its components as specified by the additional documentation mentioned above. Any duplicates – either in a specific entry, or in the flaw hypothesis that is generated from an entry from the same or a different source – can be noted and removed from consideration by the evaluation team.</p>
</li>
<li>
<p>According to section 5.6.1.1, the developer shall provide documentation identifying the list of software and hardware components that compose the TOE. The evaluator shall independently verify this list for completeness by comparing it to the security functionality defined in the TSS of the ST and ensuring that all expected components are accounted for.
Hardware components should identify at a minimum the processors used by the TOE. Software components that are in the scope of this requirement include libraries, frameworks, operating system and other major components that are independently identifiable and reusable (i.e. can be present in other products) components. The evaluator shall use the components list and determine that the TOE and its components are free of unmitigated vulnerabilities. It is expected that all remotely exploitable vulnerabilities present in the network device shall be considered as part of vulnerability assessment ("network device" is used to refer to the entire device and is not limited to the claimed security functionality).
The search criteria to be used when searching the sources shall include:</p>
<div class="ulist">
<ul>
<li>
<p>The list of software and hardware components that compose the TOE</p>
</li>
<li>
<p>The TOE name (including model information as appropriate)</p>
<div class="paragraph">
<p>As the search terms can contain proprietary information and there is a possibility that this information could be used by attackers to identify potential attack surfaces, there is no expectation that search terms containing proprietary information are published in any public-facing document.</p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="618">
<li>
<p>As part of type 1 flaw hypothesis generation for the specific components of the TOE, the evaluator shall also search the component manufacturer’s websites to determine if flaw hypotheses can be generated on this basis (for instance, if security patches have been released for the version of the component being evaluated, the subject of those patches may form the basis for a flaw hypothesis).</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_type_2_hypotheses_itc_sourced">A.1.2. Type 2 Hypotheses – iTC-Sourced</h4>
<div class="olist arabic">
<ol class="arabic" start="619">
<li>
<p>Section A.5 contains the list of flaw hypothesis generated by the iTC for this technology that must be considered by the evaluation team as flaw hypotheses in performing the vulnerability assessment.</p>
</li>
<li>
<p>If the evaluators discover a Type 3 or Type 4 flaw that they believe should be considered as a Type 2 flaw in future versions of this cPP, they should work with their Certification Body to determine the appropriate means of submitting the flaw for consideration by the iTC.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_type_3_hypotheses_evaluation_team_generated">A.1.3. Type 3 Hypotheses – Evaluation-Team-Generated</h4>
<div class="olist arabic">
<ol class="arabic" start="621">
<li>
<p>Type 3 flaws are formulated by the evaluator based on information presented by the product (through on-line help, product documentation and user guides, etc.) and product behaviour during the (functional) testing activities. The evaluator is also free to formulate flaws that are based on material that is not part of the baseline evidence (e.g., information gleaned from an Internet mailing list, or reading interface documentation on interfaces not included in the set provided by the developer), although such activities have the potential to vary significantly based upon the product and evaluation facility performing the analysis.</p>
</li>
<li>
<p>If the evaluators discover a Type 3 flaw that they believe should be considered as a Type 2 flaw in future versions of this cPP, they should work with their Certification Body to determine the appropriate means of submitting the flaw for consideration by the iTC.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_type_4_hypotheses_tool_generated">A.1.4. Type 4 Hypotheses – Tool-Generated</h4>
<div class="olist arabic">
<ol class="arabic" start="623">
<li>
<p>The evaluator is recommended but not mandated to perform Fuzz Testing to generate type 4 flaw hypotheses. Fuzz testing is a method where a set of randomly generated inputs is used to induce an observable fault. If this approach is selected, the evaluator should e.g. identify a protocol implementing one or more SFR-enforcing TSFI(s) and conduct fuzz testing by varying selected fields in that protocol. For example, if the TOE’s remote administrative interface is secured with TLS, fuzz testing of the SSL record header or the TLS handshake message would be appropriate. Any results that are unexpected (e.g., core dumps, inappropriate errors, or unplanned reboots) should be investigated and resolved.
If fuzz testing is performed, the evaluator should focus on security-relevant parts of the TOE that have not been subjected to Fuzz Testing multiple times (like publicly available libraries), but instead focus on custom parts of the TOE (if such information is available to the evaluator).</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="624">
<li>
<p>The iTC has not identified a specific tool to be used in accomplishing the above flaw hypothesis generation activity, so any tool used by the evaluation team is acceptable. The evaluation team shall record in the test report the name, version, parameters, and results of all test tools used for this this activity.</p>
</li>
<li>
<p>If the evaluators discover a Type 4 flaw that they believe should be considered as a Type 2 flaw in future versions of this cPP, they should work with their Certification Body to determine the appropriate means of submitting the flaw for consideration by the iTC.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_for_evaluator_vulnerability_analysis">A.2. Process for Evaluator Vulnerability Analysis</h3>
<div class="olist arabic">
<ol class="arabic" start="626">
<li>
<p>As flaw hypotheses are generated from the activities described above, the evaluation team will disposition them; that is, attempt to prove, disprove, or determine the non-applicability of the hypotheses. This process is as follows.</p>
</li>
<li>
<p>The evaluator will refine each flaw hypothesis for the TOE and attempt to disprove it using the information provided by the developer or through penetration testing. During this process, the evaluator is free to interact with the developer to determine if the flaw exists, including requests to the developer for additional evidence (e.g., detailed design information, consultation with engineering staff). In case of a confirmed flaw, the CB should be informed. Should the developer object to the information being requested as being not compatible with the overall level of the evaluation activity/cPP and cannot provide evidence otherwise that the flaw is disproved, the evaluator prepares an appropriate set of materials as follows:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the source documents used in formulating the hypothesis, and why it represents a potential compromise against a specific TOE function;</p>
</li>
<li>
<p>an argument why the flaw hypothesis could not be proven or disproved by the evidence provided so far;</p>
</li>
<li>
<p>the type of information required to investigate the flaw hypothesis further.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="628">
<li>
<p>The Certification Body (CB) will then either approve or disapprove the request for additional information. If approved, the developer provides the requested evidence to disprove the flaw hypothesis (or, of course, acknowledge the flaw).</p>
</li>
<li>
<p>For each hypothesis, the evaluator will note whether the flaw hypothesis has been successfully disproved, successfully proven to have identified a flaw, or requires further investigation. It is important to have the results documented as outlined in Section A.3 below.</p>
</li>
<li>
<p>If the evaluator finds a flaw, the evaluator will report these flaws to the developer. All reported flaws must be addressed as follows.</p>
</li>
<li>
<p>If the developer confirms that the flaw exists and that it is exploitable at Basic Attack Potential, then a change is made by the developer, and the resulting resolution is agreed by the evaluator and noted as part of the evaluation report.</p>
</li>
<li>
<p>If the developer, the evaluator, and the CB agree that the flaw is exploitable only above Basic Attack Potential and does not require resolution for any other reason, then no change is made, and the flaw is noted as a residual vulnerability in the CB-internal report (ETR).</p>
</li>
<li>
<p>If the developer and evaluator agree that the flaw is exploitable only above Basic Attack Potential, but it is deemed critical to fix because of technology-specific or cPP-specific aspects such as typical use cases or operational environments, then a change is made by the developer, and the resulting resolution is agreed by the evaluator and noted as part of the evaluation report.</p>
</li>
<li>
<p>Disagreements between evaluator and developer regarding questions of the existence of a flaw, its attack potential, or whether it should be deemed critical to fix are resolved by the CB.</p>
</li>
<li>
<p>Any testing performed by the evaluator shall be documented in the test report as outlined in Section A.3 below.</p>
</li>
<li>
<p>As indicated in Section A.3, the public statement with respect to vulnerability analysis that is performed on TOEs conformant to the cPP is constrained to coverage of flaws associated with Types 1 and 2 (defined in Section A.1) flaw hypotheses only. The fact that the iTC generates these candidate hypotheses indicates these must be addressed.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_reporting">A.3. Reporting</h3>
<div class="olist arabic">
<ol class="arabic" start="637">
<li>
<p>The evaluators shall produce two reports on the testing effort; one that is public-facing (that is, included in the non-proprietary evaluation report, which is a subset of the Evaluation Technical Report (ETR)) and the complete ETR that is delivered to the overseeing CB.</p>
</li>
<li>
<p>The public-facing report contains:</p>
<div class="ulist">
<ul>
<li>
<p>The flaw identifiers returned when the procedures for searching public sources were followed according to instructions in the Supporting Document per Section A.1.1;</p>
</li>
<li>
<p>A statement that the evaluators have examined the Type 1 flaw hypotheses specified in this Supporting Document in section A.1.1 (i.e. the flaws listed in the previous bullet) and the Type 2 flaw hypotheses specified in this Supporting Document by the iTC in Section A.1.2;</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="639">
<li>
<p>A statement that the evaluation team developed Types 3 and 4 flaw hypotheses in accordance with Sections A.1.3, A.1.4, and A.2, and that no residual vulnerabilities exist that are exploitable by attackers with Basic Attack Potential as defined by the CB in accordance with the guidance in the CEM. It should be noted that this is just a statement about the “fact of” Types 3 and 4 flaw hypotheses being developed, and that no specifics about the number of flaws, the flaws themselves, or the analysis pertaining to those flaws will be included in the public-facing report.</p>
</li>
<li>
<p>No other information is provided in the public-facing report.</p>
</li>
<li>
<p>The internal CB report contains, in addition to the information in the public-facing report:</p>
<div class="ulist">
<ul>
<li>
<p>a list of all of the flaw hypotheses generated (cf. AVA_VAN.1-4);</p>
</li>
<li>
<p>the evaluator penetration testing effort, outlining the testing approach, configuration, depth and results (cf. AVA_VAN.1-9);</p>
</li>
<li>
<p>all documentation used to generate the flaw hypotheses (in identifying the documentation used in coming up with the flaw hypotheses, the evaluation team must characterize the documentation so that a reader can determine whether it is strictly required by this Supporting Document, and the nature of the documentation (design information, developer engineering notebooks, etc.));</p>
</li>
<li>
<p>the evaluator shall report all exploitable vulnerabilities and residual vulnerabilities, detailing for each:</p>
<div class="ulist">
<ul>
<li>
<p>its source (e.g. CEM activity being undertaken when it was conceived, known to the evaluator, read in a publication);</p>
</li>
<li>
<p>the SFR(s) not met;</p>
</li>
<li>
<p>a description;</p>
</li>
<li>
<p>whether it is exploitable in its operational environment or not (i.e. exploitable or residual).</p>
</li>
<li>
<p>the amount of time, level of expertise, level of knowledge of the TOE, level of opportunity and the equipment required to perform the identified vulnerabilities (cf. AVA_VAN.1-11);</p>
</li>
</ul>
</div>
</li>
<li>
<p>how each flaw hypothesis was resolved (this includes whether the original flaw hypothesis was confirmed or disproved, and any analysis relating to whether a residual vulnerability is exploitable by an attacker with Basic Attack Potential) (cf. AVA_VAN1-10); and</p>
</li>
<li>
<p>in the case that actual testing was performed in the investigation (either as part of flaw hypothesis generation using tools specified by the iTC in Section A.1.4, or in proving/disproving a particular flaw) the steps followed in setting up the TOE (and any required test equipment); executing the test; post-test procedures; and the actual results (to a level of detail that allow repetition of the test, including the following:</p>
<div class="ulist">
<ul>
<li>
<p>identification of the potential vulnerability the TOE is being tested for;</p>
</li>
<li>
<p>instructions to connect and setup all required test equipment as required to conduct the penetration test;</p>
</li>
<li>
<p>instructions to establish all penetration test prerequisite initial conditions;</p>
</li>
<li>
<p>instructions to stimulate the TSF;</p>
</li>
<li>
<p>instructions for observing the behaviour of the TSF;</p>
</li>
<li>
<p>descriptions of all expected results and the necessary analysis to be performed on the observed behaviour for comparison against expected results;</p>
</li>
<li>
<p>instructions to conclude the test and establish the necessary post-test state for the TOE. (cf. AVA_VAN.1-6, AVA_VAN.1-8).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_public_vulnerability_sources">A.4. Public Vulnerability Sources</h3>
<div class="olist arabic">
<ol class="arabic" start="642">
<li>
<p>The following sources of public vulnerabilities are sources for the iTC to consider in both formulating the specific list of flaws to be investigated by the evaluators, as well as to reference in directing the evaluators to perform key-word searches during the evaluation of a specific TOE.</p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>NIST National Vulnerabilities Database (can be used to access CVE and US-CERT databases identified below):<br>
<a href="https://web.nvd.nist.gov/view/vuln/search" class="bare">https://web.nvd.nist.gov/view/vuln/search</a></p>
</li>
<li>
<p>Common Vulnerabilities and Exposures:<br>
<a href="http://cve.mitre.org/cve/" class="bare">http://cve.mitre.org/cve/</a><br>
<a href="https://www.cvedetails.com/vulnerability-search.php" class="bare">https://www.cvedetails.com/vulnerability-search.php</a></p>
</li>
<li>
<p>US-CERT:<br>
<a href="http://www.kb.cert.org/vuls/html/search" class="bare">http://www.kb.cert.org/vuls/html/search</a></p>
</li>
<li>
<p>Tenable Network Security<br>
<a href="http://nessus.org/plugins/index.php?view=search" class="bare">http://nessus.org/plugins/index.php?view=search</a></p>
</li>
<li>
<p>Tipping Point Zero Day Initiative<br>
<a href="http://www.zerodayinitiative.com/advisories" class="bare">http://www.zerodayinitiative.com/advisories</a></p>
</li>
<li>
<p>Offensive Security Exploit Database:<br>
<a href="https://www.exploit-db.com/" class="bare">https://www.exploit-db.com/</a></p>
</li>
<li>
<p>Rapid7 Vulnerability Database:<br>
<a href="https://www.rapid7.com/db/vulnerabilities" class="bare">https://www.rapid7.com/db/vulnerabilities</a></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_additional_flaw_hypotheses">A.5. Additional Flaw Hypotheses</h3>
<div class="olist arabic">
<ol class="arabic" start="650">
<li>
<p>The following additional tests shall be performed:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>[conditional]: If the TOE is a TLS server and supports ciphersuites that use RSA transport (e.g. supporting TLS_RSA_WITH_* ciphers) the following test shall be performed. Where RSA Key Establishment schemes are claimed and especially when PKCS#1 v1.5* padding is used, the evaluators shall test for implementation flaws allowing Bleichenbacher and Klima et al. style attacks, including Bock et al&#8217;s ROBOT attacks of 2017 in the flaw analysis. Even though Bleichenbacher&#8217;s original paper is two decades old, Bock et al. found these attacks to still be effective in weakening the security of RSA key establishment in current products. Bleichenbacher and Klima et al. style attacks are complex and may be difficult to detect, but a number of software testing tools have been created to assist in that process. The iTC strongly recommends that at least one of the tools mentioned in Bock et al&#8217;s ROBOT attacks of 2017 webpage or paper, as effective to detect padding oracle attacks, be used to test TOE communications channels using RSA based Key Establishment (related sources: <a href="http://archiv.infsec.ethz.ch/education/fs08/secsem/bleichenbacher98.pdf" class="bare">http://archiv.infsec.ethz.ch/education/fs08/secsem/bleichenbacher98.pdf</a>, <a href="https://eprint.iacr.org/2003/052" class="bare">https://eprint.iacr.org/2003/052</a>, <a href="https://robotattack.org/" class="bare">https://robotattack.org/</a>).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_network_device_equivalency_considerations">Appendix B: Network Device Equivalency Considerations</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_2">B.1. Introduction</h3>
<div class="olist arabic">
<ol class="arabic" start="651">
<li>
<p>This appendix provides a foundation for evaluators to determine whether a developer’s request for equivalency of products for different models wishing to claim conformance to the Network Device collaborative Protection Profiles is allowed.</p>
</li>
<li>
<p>For the purpose of evaluation, equivalency can be broken into two categories:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Variations in models</strong>: Separate TOE models/variations may include differences that could necessitate separate testing across each model. If there are no variations in any of the categories listed below, the models may be considered equivalent.</p>
</li>
<li>
<p><strong>Variations in TOE dependencies on the environment (e.g., OS/platform the product is tested on):</strong> The method a TOE provides functionality (or the functionality itself) may vary depending upon the environment on which it is installed. If there is no difference in the TOE-provided functionality or in the manner in which the TOE provides the functionality, the models may be considered equivalent.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="653">
<li>
<p>Determination of equivalency between models can result in several different testing outcomes.</p>
</li>
<li>
<p>If a set of TOE are determined to be equivalent, testing may be performed on a single variation of the TOE. However, if the TOE variations have security-relevant functional differences, each of the TOE models that exhibits either functional or structural differences must be separately tested. Generally speaking, only the difference between each variation of TOE must be separately tested. Other equivalent functionality may be tested on a representative model and not across multiple platforms.</p>
</li>
<li>
<p>If it is determined that a TOE operates the same regardless of the environment, testing may be performed on a single instance for all equivalent configurations. However, if the TOE is determined to provide environment-specific functionality, testing must take place in each environment for which a difference in functionality exists. Similar to the above scenario, only the functionality affected by environment differences must be retested.</p>
</li>
<li>
<p>If a developer disagrees with the evaluator’s assessment of equivalency, the Certification Body arbitrates between the two parties as to whether equivalency exists.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_evaluator_guidance_for_determining_equivalence">B.2. Evaluator guidance for determining equivalence</h3>
<div class="sect3">
<h4 id="_strategy">B.2.1. Strategy</h4>
<div class="olist arabic">
<ol class="arabic" start="657">
<li>
<p>When performing the equivalency analysis, the evaluator should consider each factor independently. A factor may be any number of things at various levels of abstraction, ranging from the processor a device uses, to the underlying operating system and hardware platform a software application relies upon. Examples may be the various chip sets employed by the product, the type of network interface (different device drivers), storage media (solid state drive, spinning disk, EEPROM). It is important to consider how the difference in these factors may influence the TOE’s ability to enforce the SFRs. Each analysis of an individual factor will result in one of two outcomes,</p>
<div class="ulist">
<ul>
<li>
<p>For the particular factor, all variations of the TOE on all supported platforms are equivalent. In this case, testing may be performed on a single model in a single test environment and cover all supported models and environments.</p>
</li>
<li>
<p>For the particular factor, a subset of the product has been identified to require separate testing to ensure that it operates identically to all other equivalent TOE. The analysis would identify the specific combinations of models/testing environments that needed to be tested.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="658">
<li>
<p>Complete CC testing of the product would encompass the totality of each individual analysis performed for each of the identified factors.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_guidance_for_network_devices">B.2.2. Guidance for Network Devices</h4>
<div class="olist arabic">
<ol class="arabic" start="659">
<li>
<p>The following table provides a description of how an evaluator should consider each of the factors that affect equivalency between TOE model variations and across operating environments. Additionally, the table also identifies scenarios that will result in additional separate testing across models.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Factor</strong></th>
<th class="tableblock halign-left valign-top"><strong>Same/Not Same</strong></th>
<th class="tableblock halign-left valign-top"><strong>Evaluator guidance</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Platform/Hardware Dependencies</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Independent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If there are no identified platform/hardware dependencies, the evaluator shall consider testing on multiple hardware platforms to be equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>If there are specified differences between platforms/hardware, the evaluator must identify if the differences affect the cPP-specified security functionality or if they apply to non-cPP-specified functionality. If functionality specified in the cPP is dependent upon platform/hardware provided services, the product must be tested on each of the different platforms to be considered validated on that particular hardware combination. In these cases, the evaluator has the option of only re-testing the functionality dependent upon the platform/hardware provided functionality. If the differences only affect non-cPP-specified functionality, the variations may still be considered equivalent. For each difference the evaluator must provide an explanation of why the difference does or does not affect cPP-specified functionality.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Differences in TOE Software Binaries</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the model binaries are identical, the model variations shall be considered equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Different</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If there are differences between model software binaries, a determination must be made if the differences affect cPP-specified security functionality. If cPP-specified functionality is affected, the models are not considered equivalent and must be tested separately. The evaluator has the option of only retesting the functionality that was affected by the software differences. If the differences only affect non-PP specified functionality, the models may still be considered equivalent. For each difference the evaluator must provide an explanation of why the difference does or does not affect cPP specified functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Differences in Libraries Used to Provide TOE Functionality</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Same</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If there are no differences between the libraries used in various TOE models, the model variations shall be considered equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Different</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the separate libraries are used between model variations, a determination of whether the functionality provided by the library affects cPP-specified functionality must be made. If cPP-specified functionality is affected, the models are not considered equivalent and must be tested separately. The evaluator has the option of only retesting the functionality that was affected by the differences in the included libraries. If the different libraries only affect non-PP specified functionality, the models may still be considered equivalent. For each different library, the evaluator must provide an explanation of why the different libraries do or do not affect cPP specified functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TOE Management Interface Differences</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consistent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If there are no differences in the management interfaces between various TOE models, the model variations shall be considered equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differences</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the product provides separate interfaces based on the model variation, a determination must be made of whether cPP-specified functionality can be configured by the different interfaces. If the interface differences affect cPP-specified functionality, the variations are not considered equivalent and must be separately tested. The evaluator has the option of only retesting the functionality that can be configured by the different interfaces (and the configuration of said functionality). If the different management interfaces only affect non-PP specified functionality, the models may still be considered equivalent. For each management interface difference, the evaluator must provide an explanation of why the different management interfaces do or do not affect cPP specified functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TOE Functional Differences</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the functionality provided by different TOE model variation is identical, the models variations shall be considered equivalent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Different</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the functionality provided by different TOE model variations differ, a determination must be made if the functional differences affect cPP-specified functionality. If cPP-specific functionality differs between models, the models are not considered equivalent and must be tested separately. In these cases, the evaluator has the option of only retesting the functionality that differs model-to-model. If the functional differences only affect non-cPP specified functionality, the model variations may still be considered equivalent. For each difference the evaluator must provide an explanation of why the difference does or does not affect cPP specified functionality.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><span id="_Toc412821715">Table 3: Evaluation Equivalency Analysis</span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_presentationtruth_in_advertising">B.3. Test presentation/Truth in advertising</h3>
<div class="olist arabic">
<ol class="arabic" start="660">
<li>
<p>In addition to determining what to test, the evaluation results and resulting Certification Report, must identify the actual module and environment combinations that have been tested. The analysis used to determine the testing subset may be considered proprietary and will only optionally be publicly included.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_evaluating_additional_components_for_a_distributed_toe">B.4. Evaluating additional components for a distributed TOE</h3>
<div class="olist arabic">
<ol class="arabic" start="661">
<li>
<p>In the case of a distributed TOE the Security Target will identify an evaluated configuration that consists of a number of separate components chosen by the ST author, which collectively satisfy the requirements of the cPP. This evaluated configuration need not be the minimum set of components that could <em>possibly</em> meet the cPP (e.g. if the TOE is intended for large enterprise deployments then the evaluated configuration might include some redundancy in components in order to support expected connectivity and loads), but because this is the main configuration referred to in the ST and the evaluation, it is treated in this section as the minimum configuration of interest and is referred to here as the ‘minimum configuration’ as well as the ‘evaluated configuration’.</p>
</li>
<li>
<p>In addition to the minimum configuration above, the ST may also identify (at the author’s discretion, and subject to verification as described in this section) which TOE components can have instances added to an operational configuration without affecting the validity of the CC certification. The ST description may include constraints on how such components are added, including required and/or prohibited configurations of the components.</p>
</li>
<li>
<p>Extra instances of a TOE component must have the same hardware and software as the original component included in the evaluated configuration.</p>
</li>
<li>
<p>It is noted that undesirable configurations may be possible in the operational deployment of a TOE – such as allowing a TOE component to be managed from separate and potentially conflicting administration domains. However, the definition of ‘undesirable’ and of the risks involved in such cases will be specific to each operational environment and is therefore not treated as part of the evaluation. Correct and appropriate configuration of this sort remains a matter for expert network planning and design in the operational environment.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_evaluator_actions_for_assessing_the_st">B.4.1. Evaluator Actions for Assessing the ST</h4>
<div class="sect4">
<h5 id="_tss_61">B.4.1.1. TSS</h5>
<div class="olist arabic">
<ol class="arabic" start="665">
<li>
<p>The evaluator shall examine the TSS to confirm it identifies any extra instances of TOE components allowed in the ST and what effects will occur when extra instances of distributed TOE components are added. The information in the TSS shall allow the evaluator to understand how a system with one component behaves in comparison to a system with multiple components.  The TSS also needs to describe how the additional components maintain the SFRs to determine it is consistent with the role the component plays in the evaluated configuration and cannot be used in a way that the security functionality would be corrupted or bypassed. In general, any additional TOE-component shouldn&#8217;t have a negative impact on other components that are already part of the TOE.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_evaluator_actions_for_assessing_the_guidance_documentation">B.4.2. Evaluator Actions for Assessing the Guidance Documentation</h4>
<div class="sect4">
<h5 id="_guidance_documentation_60">B.4.2.1. Guidance Documentation</h5>
<div class="olist arabic">
<ol class="arabic" start="666">
<li>
<p>The evaluator shall examine the description of the extra instances of TOE components in the guidance documentation to confirm that they are consistent with those identified as allowed in the ST. This includes confirmation that the result of applying the guidance documentation to configure the extra component will leave the TOE in a state such that the claims for SFR support in each component are as described in the ST and therefore that all SFRs continue to be met when the extra components are present.</p>
</li>
<li>
<p>The evaluator shall examine the secure communications described for the extra components to confirm that they are the same as described for the components in the minimum configuration (additional connections between allowed extra components and the components in the minimum configuration are allowed of course).</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_evaluator_actions_for_testing_the_toe">B.4.3. Evaluator Actions for Testing the TOE</h4>
<div class="sect4">
<h5 id="_tests_61">B.4.3.1. Tests</h5>
<div class="olist arabic">
<ol class="arabic" start="668">
<li>
<p>The evaluator tests the TOE in the minimum configuration as defined in the ST (and the guidance documentation).</p>
</li>
<li>
<p>If the description of the use of extra components in the ST and guidance documentation identifies any difference in the SFRs allocated to a component, or the scope of the SFRs involved (e.g. if different selections apply to different instances of the component) then the evaluator tests these additional SFR cases that were not included in the minimum configuration.</p>
</li>
<li>
<p>In addition, the evaluator tests the following aspects for each extra component that is identified as allowed in the distributed TOE:</p>
<div class="ulist">
<ul>
<li>
<p>Communications: the evaluator follows the guidance documentation to confirm, by testing, that any additional connections introduced with the extra component and not present in the minimum configuration are consistent with the requirements stated in the ST (e.g. with regard to protocols and ciphersuites used). An example of such an additional connection would be if a single instance of the component is present in the minimum configuration and adding a duplicate component then introduces an extra communication between the two instances. Another example might be if the use of the additional components necessitated the use of a connection to an external authentication server instead of using locally stored credentials.</p>
</li>
<li>
<p>Audit: the evaluator confirms that the audit records from different instances of a component can be distinguished so that it is clear which instance generated the record.</p>
</li>
<li>
<p>Management: if the extra component manages other components in the distributed TOE then the evaluator shall follow the guidance documentation to confirm that management via the extra component uses the same roles and role holders for administrators as for the component in the minimum configuration.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. In general, a cPP may reference one or more SDs as sources for the Evaluation Activities for different sets of SFRs.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. Where keys are stored encrypted or wrapped under another key then this may need to be explained in order to allow the evaluator to confirm the consistency of the description of keys with the TOE functions.
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. Where TRIM is used then the TSS and/or guidance documentation is also expected to describe how the keys are stored such that they are not inaccessible to TRIM, (e.g. they would need not to be contained in a file less than 982 bytes which would be completely contained in the master file table).
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. The intention here is to cover all different software sections involved. For example, a single software image may be installed on different TOE components, but with different sections of the image executed according to the hardware platform or communications stack. In such as case tests should be carried out for each different software section.
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. The intent of the phrasing “what stops…” as opposed to “what secures…” is for the evaluator to pursue the answer to its lowest level of dependency, i.e. a level at which the security can clearly be seen to depend on things that are under appropriate control. For example, a channel may be protected by a public key that is provided to the relying party in a self-signed certificate. This enables cryptographic mechanisms to be applied to provide authentication (and therefore invites an answer that “the check on the public key certificate secures…”), but does not ultimately stop an attacker from apparently authenticating because the attacker can produce their own self-signed certificate. The question “what stops an unauthorised component from successfully communicating…” focuses attention on what an attacker needs to do, and therefore pushes the answer down to the level of whether a self-signed certificate could be produced by an attacker. Similarly, a well-known key, or a key that is common to a type of device rather than an individual device, may be used in a confidentiality mechanism but does not provide confidentiality because an attacker can find the well-known key or obtain his own instance of a device containing the non-unique key.
</div>
<div class="footnote" id="_footnotedef_6">
<a href="#_footnoteref_6">6</a>. An ‘equivalent TOE component’ is a type of distributed TOE component that exhibits the same security characteristics, behaviour and role in the TSF as some other TOE component. In principle a distributed TOE could operate with only one instance of each equivalent TOE component, although the minimum configuration of the distributed TOE may include more than one instance (see discussion of the minimum configuration of a distributed TOE, in section A.9). In practice a deployment of the TOE may include more than one instance of some equivalent TOE components for practical reasons, such as performance or the need to have separate instances for separate subnets or VLANs.
</div>
<div class="footnote" id="_footnotedef_7">
<a href="#_footnoteref_7">7</a>. In this sub-section the term “components” refers to parts that make up the TOE. It is therefore distinguished from the term “distributed TOE components”, which refers to the parts of a TOE that are present in one physical part of a distributed TOE. Each distributed TOE component will therefore generally include a number of the hardware and software components that are referred to in this sub-section: for example, each distributed TOE component will generally include hardware components such as processors and software components such as an operating system and libraries.
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 3.0<br>
Last updated 2023-04-05 13:33:11 -0400
</div>
</div>
</body>
</html>